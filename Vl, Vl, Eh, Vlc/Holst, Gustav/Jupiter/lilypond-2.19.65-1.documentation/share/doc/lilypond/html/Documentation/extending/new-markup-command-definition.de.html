<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Copyright C 2003-2015 bei den Autoren.

The translation of the following copyright notice is provided
for courtesy to non-English speakers, but only the notice in English
legally counts.

Die Übersetzung der folgenden Lizenzanmerkung ist zur Orientierung
für Leser, die nicht Englisch sprechen. Im rechtlichen Sinne ist aber
nur die englische Version gültig.

Es ist erlaubt, dieses Dokument unter den Bedingungen der
GNU Free Documentation Lizenz (Version 1.1 oder
spätere, von der Free Software Foundation publizierte Versionen, ohne
invariante Abschnitte),
zu kopieren, zu verbreiten und/oder
zu verändern. Eine Kopie der Lizenz ist im Abschnitt "GNU
Free Documentation License" angefügt.


Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.1
or any later version published by the Free Software Foundation;
with no Invariant Sections.
A copy of the license is included in the section entitled "GNU
Free Documentation License".

 -->
<!-- Created on 6. August 2017 by texi2html 1.82
texi2html was written by: 
            Lionel Cons <Lionel.Cons@cern.ch> (original author)
            Karl Berry  <karl@freefriends.org>
            Olaf Bachmann <obachman@mathematik.uni-kl.de>
            and many others.
Maintained by: Many creative people.
Send bugs and suggestions to <texi2html-bug@nongnu.org>
-->
<head>
<title>LilyPond erweitern: 2.5.3 Neue Definitionen von Beschriftungsbefehlen</title>

<meta name="description" content="LilyPond erweitern: 2.5.3 Neue Definitionen von Beschriftungsbefehlen">
<meta name="keywords" content="LilyPond erweitern: 2.5.3 Neue Definitionen von Beschriftungsbefehlen">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="texi2html 1.82">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link href="index.de.html#index" rel="start" title="LilyPond &ndash; Extending">
<link href="lilypond-index.de.html#lilypond-index" rel="index" title="B. LilyPond-Index">
<link href="index_toc.de.html#SEC_Contents" rel="contents" title="Inhaltsverzeichnis">
<link href="index_abt.de.html#SEC_About" rel="help" title="&Uuml;ber dieses Dokument">
<link href="markup-functions.de.html#markup-functions" rel="up" title="2.5 Textbeschriftungsfunktionen">
<link href="lilypond-index.de.html#lilypond-index" rel="next" title="B. LilyPond-Index">
<link href="how-markups-work-internally.de.html#how-markups-work-internally" rel="previous" title="2.5.2 Wie Beschriftungen intern funktionieren">
<link rel="stylesheet" type="text/css" title="Default style" href="../../Documentation/css/lilypond-manuals.css">
<!--[if lte IE 7]>
<link href="../../Documentation/css/lilypond-manuals-ie-fixes.css" rel="stylesheet" type="text/css">
<![endif]-->


</head>

<body lang="de" class="extending devStatus">


<div id="main">
<a name="Neue-Definitionen-von-Beschriftungsbefehlen"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="interfaces-for-programmers.de.html" title="Anfang dieses oder des letzten Kapitels"> &lt;&lt; Schnittstellen für Programmierer&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="index.de.html" title="Titelseite des Dokuments" rel="start">Anfang</a>][<a href="index_toc.de.html#SEC_Contents" title="Inhaltsverzeichnis" rel="contents">Inhalt</a>][<a href="lilypond-index.de.html" title="Index" rel="index">Index</a>][<a href="index_abt.de.html#SEC_About" title="&Uuml;ber (Hilfe)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="lilypond-scheme-interfaces.de.html" title="N&auml;chstes Kapitel">&nbsp;LilyPond Scheme-Schnittstellen &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="how-markups-work-internally.de.html" title="Voriger Abschnitt in Lesereihenfolge" accesskey="p" rel="previous"> &lt; Wie Beschriftungen intern funktionieren&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="markup-functions.de.html" title="Abschnitt nach oben" accesskey="u" rel="up">&nbsp; Nach oben :&nbsp;Textbeschriftungsfunktionen&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#markup-command-definition-syntax" title="N&auml;chster Abschnitt in Lesereihenfolge" accesskey="n" rel="next">&nbsp;Syntax der Definition von Textbeschriftungsbefehlen &gt; </a>]</td></tr></table>
<a name="new-markup-command-definition"></a>
<h3 class="subsection">2.5.3 Neue Definitionen von Beschriftungsbefehlen</h3>

<p>Dieser Abschnitt behandelt die Definition von neuen Textbeschriftungsbefehlen.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#markup-command-definition-syntax" accesskey="1">Syntax der Definition von Textbeschriftungsbefehlen</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#on-properties" accesskey="2">Über Eigenschaften</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#a-complete-example" accesskey="3">Ein vollständiges Bespiel</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#adapting-builtin-commands" accesskey="4">Eingebaute Befehle anpassen</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr size="6">
<a name="Syntax-der-Definition-von-Textbeschriftungsbefehlen"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="interfaces-for-programmers.de.html" title="Anfang dieses oder des letzten Kapitels"> &lt;&lt; Schnittstellen für Programmierer&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="index.de.html" title="Titelseite des Dokuments" rel="start">Anfang</a>][<a href="index_toc.de.html#SEC_Contents" title="Inhaltsverzeichnis" rel="contents">Inhalt</a>][<a href="lilypond-index.de.html" title="Index" rel="index">Index</a>][<a href="index_abt.de.html#SEC_About" title="&Uuml;ber (Hilfe)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="lilypond-scheme-interfaces.de.html" title="N&auml;chstes Kapitel">&nbsp;LilyPond Scheme-Schnittstellen &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#new-markup-command-definition" title="Voriger Abschnitt in Lesereihenfolge" accesskey="p" rel="previous"> &lt; Neue Definitionen von Beschriftungsbefehlen&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#new-markup-command-definition" title="Abschnitt nach oben" accesskey="u" rel="up">&nbsp; Nach oben :&nbsp;Neue Definitionen von Beschriftungsbefehlen&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#on-properties" title="N&auml;chster Abschnitt in Lesereihenfolge" accesskey="n" rel="next">&nbsp;Über Eigenschaften &gt; </a>]</td></tr></table>
<a name="markup-command-definition-syntax"></a>
<h4 class="unnumberedsubsubsec">Syntax der Definition von Textbeschriftungsbefehlen</h4>

<p>Neue Textbeschriftungsbefehle können mit dem
<code>define-markup-command</code>-Scheme-Makro definiert werden.
</p>
<table><tr><td>&nbsp;</td><td><pre class="lisp">(define-markup-command (<var>befehl-bezeichnung</var> <var>layout</var> <var>props</var> <var>Arg1</var> <var>Arg2</var> ...)
            (<var>Arg1-typ?</var> <var>Arg2-typ?</var> ...)
    [ #:properties ((<var>Eigenschaft1</var> <var>Standard-Wert1</var>)
                    ...) ]
  ..Befehlkörper..)
</pre></td></tr></table>

<p>Die Argumente sind:
</p>
<dl compact="compact">
<dt> <var><var>befehl-bezeichnung</var></var></dt>
<dd><p>die Bezeichnung des Befehls
</p>
</dd>
<dt> <var><var>layout</var></var></dt>
<dd><p>die &sbquo;layout&lsquo;-Definition
</p>
</dd>
<dt> <var>props</var></dt>
<dd><p>eine Liste an  assoziativen Listen, in der alle aktiven Eigenschaften enthalten sind
</p>
</dd>
<dt> <var><var>argi</var></var></dt>
<dd><p>das <var>i</var>te Befehlsargument
</p>
</dd>
<dt> <var><var>argi-type?</var></var></dt>
<dd><p>eine Eigenschaft für das <var>i</var>te Argument
</p></dd>
</dl>

<p>Wenn der Befehl Eigenschaften des <code>props</code>-Arguments benutzt,
kann das <code>#:properties</code>-Schlüsselwort benutzt werden um zu
bestimmen, welche Eigenschaften mit welchen Standard-Werten benutzt
werden.
</p>
<p>Argumente werden nach ihrem Typ unterschieden:
</p>
<ul>
<li> eine Textbeschriftung entspricht einem Typenprädikat <code>markup?</code>;
</li><li> eine Textbeschriftungsliste entspricht einem Typenprädikat
<code>markup-list?</code>;
</li><li> jedes andere Scheme-Objekt entspricht Typenprädikaten wie etwa
<code>list?</code>, <code>number?</code>, <code>boolean?</code>, usw.
</li></ul>

<p>Es gibt keine Einschränkung in der Reihenfolge der Argumente (nach
den Standard-Argumenten <code>layout</code> und <code>props</code>).  Textbeschriftungsfunktionen,
die als letztes Argument eine Textbeschriftung haben, haben die
Besonderheit, dass sie auf Textbeschriftungslisten angewendet werden
können, und das Resultat ist eine Textbeschriftungsliste, in der
die Textbeschriftungsfuktion (mit den angegebenen Argumenten am Anfang)
auf jedes Element der originalen Textbeschriftungsliste angewendet
wurde.
</p>
<p>Da das Wiederholen der Argumente am Anfang bei der Anwendung einer
Textbeschriftungsfunktion auf eine Textbeschriftungsliste for allem
für Scheme-Argumente sparsam ist, kann man Leistungseinbußen vermeiden,
indem man nur Scheme-Argumente für die Argumente am Anfang einsetzt,
wenn es sich um Textbeschriftungsfunktionen handelt, die eine Textbeschriftung
als letztes Argument haben.
</p>

<hr size="6">
<a name="g_t_00dcber-Eigenschaften"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="interfaces-for-programmers.de.html" title="Anfang dieses oder des letzten Kapitels"> &lt;&lt; Schnittstellen für Programmierer&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="index.de.html" title="Titelseite des Dokuments" rel="start">Anfang</a>][<a href="index_toc.de.html#SEC_Contents" title="Inhaltsverzeichnis" rel="contents">Inhalt</a>][<a href="lilypond-index.de.html" title="Index" rel="index">Index</a>][<a href="index_abt.de.html#SEC_About" title="&Uuml;ber (Hilfe)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="lilypond-scheme-interfaces.de.html" title="N&auml;chstes Kapitel">&nbsp;LilyPond Scheme-Schnittstellen &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#markup-command-definition-syntax" title="Voriger Abschnitt in Lesereihenfolge" accesskey="p" rel="previous"> &lt; Syntax der Definition von Textbeschriftungsbefehlen&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#new-markup-command-definition" title="Abschnitt nach oben" accesskey="u" rel="up">&nbsp; Nach oben :&nbsp;Neue Definitionen von Beschriftungsbefehlen&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#a-complete-example" title="N&auml;chster Abschnitt in Lesereihenfolge" accesskey="n" rel="next">&nbsp;Ein vollständiges Bespiel &gt; </a>]</td></tr></table>
<a name="on-properties"></a>
<h4 class="unnumberedsubsubsec">Über Eigenschaften</h4>

<p>Die <code>layout</code>- und <code>props</code>-Argumente der Textbeschriftungsbefehle
bringen einen Kontext für die Interpretation der Beschriftung:
Schriftgröße, Zeilenlänge usw.
</p>
<p>Das <code>layout</code>-Argument greift auf Eigenschaften zu, die in der
<code>paper</code>-Umgebung definiert werden, indem man die <code>ly:output-def-lookup</code>-Funktion
benutzt.  Beispielsweise liest man die Zeilenlänge (die gleiche, die auch in
Partituren benutzt wird) aus mit:
</p>
<blockquote><pre class="example">(ly:output-def-lookup layout 'line-width)
</pre></blockquote>

<p>Das <code>props</code>-Argument stellt einige Eigenschaften für die Textbeschriftungsbefehle
zur Verfügung.  Beispielsweise wenn der Überschrifttext einer
<code>book</code>-Umgebung interpretiert wird, werden alle Variablen, die
in der <code>\header</code>-Umgebung definiert werden, automatisch zu <code>props</code>
hinzugefügt, sodass die Beschriftung auf Titel, Komponist usw. der
<code>book</code>-Umgebung zugreifen kann.  Das ist auch eine Möglichkeit, das
Verhalten eines Beschriftungsbefehls zu konfigurieren: Wenn etwa ein
Befehl die Schriftgröße während der Verarbeitung einsetzt, wird die
Schriftgröße aus den <code>props</code> ausgelesen und nicht mit einem eigenen
<code>font-size</code>-Argument definiert.  Beim Aufruf des Beschriftungsbefehls
kann der Wert der Schriftgröße geändert werden, womit sich auch das Verhalten
des Befehls verändert.  Benutzen Sie das <code>#:properties</code>-Schlüsselwort
von <code>define-markup-command</code> um zu definieren, welche Eigenschaften aus den
<code>props</code>-Argumenten ausgelesen werden sollen.
</p>
<p>Das Beispiel im nächsten Abschnitt illustriert, wie man auf Eigenschaften
in einem Beschriftungsbefehl zugreifen und sie verändern kann.
</p>

<hr size="6">
<a name="Ein-vollst_00e4ndiges-Bespiel"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="interfaces-for-programmers.de.html" title="Anfang dieses oder des letzten Kapitels"> &lt;&lt; Schnittstellen für Programmierer&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="index.de.html" title="Titelseite des Dokuments" rel="start">Anfang</a>][<a href="index_toc.de.html#SEC_Contents" title="Inhaltsverzeichnis" rel="contents">Inhalt</a>][<a href="lilypond-index.de.html" title="Index" rel="index">Index</a>][<a href="index_abt.de.html#SEC_About" title="&Uuml;ber (Hilfe)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="lilypond-scheme-interfaces.de.html" title="N&auml;chstes Kapitel">&nbsp;LilyPond Scheme-Schnittstellen &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#on-properties" title="Voriger Abschnitt in Lesereihenfolge" accesskey="p" rel="previous"> &lt; Über Eigenschaften&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#new-markup-command-definition" title="Abschnitt nach oben" accesskey="u" rel="up">&nbsp; Nach oben :&nbsp;Neue Definitionen von Beschriftungsbefehlen&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#adapting-builtin-commands" title="N&auml;chster Abschnitt in Lesereihenfolge" accesskey="n" rel="next">&nbsp;Eingebaute Befehle anpassen &gt; </a>]</td></tr></table>
<a name="a-complete-example"></a>
<h4 class="unnumberedsubsubsec">Ein vollständiges Bespiel</h4>

<p>Das folgende Beispiel definiert einen Beschriftungsbefehl, der einen
doppelten Kasten um einen Text zeichnet.
</p>
<p>Zuerst wollen wir ein annäherndes Ergebnis mit Textbeschriftungen definieren.
Nach Stöbern in <a name="index-Textbeschriftungsbefehle"></a>
<a href="../notation/text-markup-commands.de.html">Textbeschriftungsbefehle</a> finden wir den Befehl
<code>\box</code>:
</p>
<blockquote><pre class="verbatim">\markup \box \box HELLO
</pre><p>
 <a href="../75/lily-43f5cbce.ly">
  <img align="middle"
       border="0"
       src="../75/lily-43f5cbce.png"
       alt="[image of music]">
 </a>
</p>
</blockquote>



<p>Wir wollen aber etwas mehr Abstand (engl. padding) zwischen dem Text und dem Kasten.
Nach der Dokumentation von <code>\box</code> hat der Befehl eine
<code>box-padding</code>-Eigenschaft, die den Standardwert von 0.2 hat.  Die
Dokumentation zeit auch, wir man den Wert verändert:
</p>
<blockquote><pre class="verbatim">\markup \box \override #'(box-padding . 0.6) \box A
</pre><p>
 <a href="../81/lily-7d9eea09.ly">
  <img align="middle"
       border="0"
       src="../81/lily-7d9eea09.png"
       alt="[image of music]">
 </a>
</p>
</blockquote>



<p>Auch der Abstand zwischen den zwei Kästen ist uns zu klein und soll auch
vergrößert werden:
</p>
<blockquote><pre class="verbatim">\markup \override #'(box-padding . 0.4) \box
    \override #'(box-padding . 0.6) \box A
</pre><p>
 <a href="../47/lily-5042b2e0.ly">
  <img align="middle"
       border="0"
       src="../47/lily-5042b2e0.png"
       alt="[image of music]">
 </a>
</p>
</blockquote>



<p>Diese lange Textbeschriftung immer wieder schreiben zu müssen, ist
anstrengend.  Hier kömmt ein Textbeschriftungsbefehl ins Spiel.  Wir
schreiben uns alle einen <code>double-box</code>-Beschriftungsbefehl, der
ein Argument annimmt (den Text).  Er zeichnet zwei Kästen mit genügend Abstand:
</p>
<table><tr><td>&nbsp;</td><td><pre class="lisp">#(define-markup-command (double-box layout props text) (markup?)
  &quot;Draw a double box around text.&quot;
  (interpret-markup layout props
    #{\markup \override #'(box-padding . 0.4) \box
            \override #'(box-padding . 0.6) \box { #text }#}))
</pre></td></tr></table>

<p>oder äquivalent
</p>
<table><tr><td>&nbsp;</td><td><pre class="lisp">#(define-markup-command (double-box layout props text) (markup?)
  &quot;Draw a double box around text.&quot;
  (interpret-markup layout props
    (markup #:override '(box-padding . 0.4) #:box
            #:override '(box-padding . 0.6) #:box text)))
</pre></td></tr></table>

<p><code>text</code> ist die Bezeichnung des Arguments dieses Befehls,
und <code>markup?</code> ist seine Art: hiermit wird der Befehl als
Beschriftungsbefehl identifiziert.  Die <code>interpret-markup</code>-Funktion
wird in den meisten Beschriftungsbefehlen benutzt: sie erstellt einen
Stencil, wobei <code>layout</code>, <code>props</code> und eine Beschriftung benutzt
werden.  Im zweiten Fall wird diese Beschriftung durch das
<code>markup</code>-Scheme-Makro erstellt, siehe auche
<a href="markup-construction-in-scheme.de.html">Beschriftungskonstruktionen in Scheme</a>.
Die Transformation des <code>\markup</code>-Ausdrucks in einen
Scheme-Beschriftungsausdruck geschieht durch Umschreiben des LilyPond-Codes
in Scheme-Code.
</p>
<p>Der neue Befehl kann wie folgt benutzt werden:
</p>
<blockquote><pre class="example">\markup \double-box A
</pre></blockquote>

<p>Es wäre schön, den <code>double-box</code>-Befehl noch konfigurierbar zu gestalten:
in unserem Fall sind die Werte von <code>box-padding</code> direkt definiert und
können nicht mehr vom Benutzer verändert werden.  Es wäre auch besser, wenn
der Abstand zwischen den beiden Kästen vom Abstand zwischen dem inneren Kasten
und dem Text unterschieden werden könnte.  Eine neue Eigenschaft muss also
definiert werden: <code>inter-box-padding</code> für den Abstand zwischen den Kästen.
<code>box-padding</code> wird für den inneren Abstand benutzt.  Der neue Befehl wird
so definiert:
</p>
<table><tr><td>&nbsp;</td><td><pre class="lisp">#(define-markup-command (double-box layout props text) (markup?)
  #:properties ((inter-box-padding 0.4)
                (box-padding 0.6))
  &quot;Draw a double box around text.&quot;
  (interpret-markup layout props
    #{\markup \override #`(box-padding . ,inter-box-padding) \box
               \override #`(box-padding . ,box-padding) \box
               { #text } #}))
</pre></td></tr></table>

<p>Wiederum wäre die entsprechende Version mit dem <code>markup</code>-Makro
so aussehen:
</p>
<table><tr><td>&nbsp;</td><td><pre class="lisp">#(define-markup-command (double-box layout props text) (markup?)
  #:properties ((inter-box-padding 0.4)
                (box-padding 0.6))
  &quot;Draw a double box around text.&quot;
  (interpret-markup layout props
    (markup #:override `(box-padding . ,inter-box-padding) #:box
            #:override `(box-padding . ,box-padding) #:box text)))
</pre></td></tr></table>

<p>In diesem Code wird das <code>#:properties</code>-Schlüsselwort benutzt, sodass
die Eigenschaften <code>inter-box-padding</code> und <code>box-padding</code> aus dem
<code>props</code>-Argument ausgelesen werden, und Standardwerte werden gegeben,
falls die Eigenschaften nicht definiert sein sollten.
</p>
<p>Dann werden diese Werte benutzt, um die <code>box-padding</code>-Eigenschaft
zu verändert, die von beiden <code>\box</code>-Befehlen benutzt wird.  Beachten
Sie Akzent und das Komma des <code>\override</code>-Arguments: hiermit kann man
einen Variablenwert in einen wörtlichen Ausdruck überführen.
</p>
<p>Jetzt kann der Befehl in Beschriftungen benutzt werden und der Abstand
der Kästen kann angepasst werden:
</p>
<blockquote><pre class="verbatim">#(define-markup-command (double-box layout props text) (markup?)
  #:properties ((inter-box-padding 0.4)
                (box-padding 0.6))
  &quot;Draw a double box around text.&quot;
  (interpret-markup layout props
    #{\markup \override #`(box-padding . ,inter-box-padding) \box
              \override #`(box-padding . ,box-padding) \box
              { #text } #}))

\markup \double-box A
\markup \override #'(inter-box-padding . 0.8) \double-box A
\markup \override #'(box-padding . 1.0) \double-box A
</pre><p>
 <a href="../94/lily-b1443df4.ly">
  <img align="middle"
       border="0"
       src="../94/lily-b1443df4.png"
       alt="[image of music]">
 </a>
</p>
</blockquote>



<hr size="6">
<a name="Eingebaute-Befehle-anpassen"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="interfaces-for-programmers.de.html" title="Anfang dieses oder des letzten Kapitels"> &lt;&lt; Schnittstellen für Programmierer&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="index.de.html" title="Titelseite des Dokuments" rel="start">Anfang</a>][<a href="index_toc.de.html#SEC_Contents" title="Inhaltsverzeichnis" rel="contents">Inhalt</a>][<a href="lilypond-index.de.html" title="Index" rel="index">Index</a>][<a href="index_abt.de.html#SEC_About" title="&Uuml;ber (Hilfe)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="lilypond-scheme-interfaces.de.html" title="N&auml;chstes Kapitel">&nbsp;LilyPond Scheme-Schnittstellen &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#a-complete-example" title="Voriger Abschnitt in Lesereihenfolge" accesskey="p" rel="previous"> &lt; Ein vollständiges Bespiel&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#new-markup-command-definition" title="Abschnitt nach oben" accesskey="u" rel="up">&nbsp; Nach oben :&nbsp;Neue Definitionen von Beschriftungsbefehlen&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="new-markup-list-command-definition.de.html" title="N&auml;chster Abschnitt in Lesereihenfolge" accesskey="n" rel="next">&nbsp;Neue Definitionen von Beschriftungslistenbefehlen &gt; </a>]</td></tr></table>
<a name="adapting-builtin-commands"></a>
<h4 class="unnumberedsubsubsec">Eingebaute Befehle anpassen</h4>

<p>Ein guter Weg, einen neuen Beschriftungsbefehl zu schreiben, ist es, als Vorbild
einen existierenden zu nehmen.  Die meisten Beschriftungsbefehle, die
LilyPond mitbringt, finden sich in der Datei
&lsquo;<tt>scm/define-markup-commands.scm</tt>&rsquo;.
</p>
<p>Man könnte beispielsweise den Befehl <code>\draw-line</code>, der eine Linie
zeichnet, anpassen, sodass er eine Doppellinie zeichnet.  Der
Befehl <code>\draw-line</code> ist wie folgend definiert (Dokumentation entfernt):
</p>
<table><tr><td>&nbsp;</td><td><pre class="lisp">(define-markup-command (draw-line layout props dest)
  (number-pair?)
  #:category graphic
  #:properties ((thickness 1))
  &quot;..documentation..&quot;
  (let ((th (* (ly:output-def-lookup layout 'line-thickness)
               thickness))
        (x (car dest))
        (y (cdr dest)))
    (make-line-stencil th 0 0 x y)))
</pre></td></tr></table>

<p>Um einen neuen Befehl, der auf einem existierenden basiert, zu definieren,
wird die Befehlsdefinition kopiert und die Bezeichnung des Befehls
geändert.  Das <code>#:category</code>-Schlagwort kann entfernt werden,
weil es nur zur Erstellung der LilyPond-Dokumentation eingesetzt wird
und keine Bedeutung für selbstdefinierte Befehle hat.
</p>
<table><tr><td>&nbsp;</td><td><pre class="lisp">(define-markup-command (draw-double-line layout props dest)
  (number-pair?)
  #:properties ((thickness 1))
  &quot;..documentation..&quot;
  (let ((th (* (ly:output-def-lookup layout 'line-thickness)
               thickness))
        (x (car dest))
        (y (cdr dest)))
    (make-line-stencil th 0 0 x y)))
</pre></td></tr></table>

<p>Dann braucht man eine Eigenschaft, um den Abstand zwischen den zwei
Linien zu definieren, als <code>line-gap</code> bezeichnet und etwa mit
dem Standardwert 0.6:
</p>
<table><tr><td>&nbsp;</td><td><pre class="lisp">(define-markup-command (draw-double-line layout props dest)
  (number-pair?)
  #:properties ((thickness 1)
                (line-gap 0.6))
  &quot;..documentation..&quot;
  ...
</pre></td></tr></table>

<p>Schließlich wird der Code, der die zwei Linien zeichnet, hinzugefügt.
Zwei Aufrufe an <code>make-line-stencil</code> werden benutzt, um beide Linien
zu zeichnen, und die beiden sich daraus ergebenden Stencils werden mit
<code>ly:stencil-add</code> kombiniert:
</p>
<blockquote><pre class="verbatim">#(define-markup-command (my-draw-line layout props dest)
  (number-pair?)
  #:properties ((thickness 1)
                (line-gap 0.6))
  &quot;..documentation..&quot;
  (let* ((th (* (ly:output-def-lookup layout 'line-thickness)
                thickness))
         (dx (car dest))
         (dy (cdr dest))
         (w (/ line-gap 2.0))
         (x (cond ((= dx 0) w)
                  ((= dy 0) 0)
                  (else (/ w (sqrt (+ 1 (* (/ dx dy) (/ dx dy))))))))
         (y (* (if (&lt; (* dx dy) 0) 1 -1)
               (cond ((= dy 0) w)
                     ((= dx 0) 0)
                     (else (/ w (sqrt (+ 1 (* (/ dy dx) (/ dy dx))))))))))
     (ly:stencil-add (make-line-stencil th x y (+ dx x) (+ dy y))
                     (make-line-stencil th (- x) (- y) (- dx x) (- dy y)))))

\markup \my-draw-line #'(4 . 3)
\markup \override #'(line-gap . 1.2) \my-draw-line #'(4 . 3)
</pre><p>
 <a href="../f2/lily-ee1c28e4.ly">
  <img align="middle"
       border="0"
       src="../f2/lily-ee1c28e4.png"
       alt="[image of music]">
 </a>
</p>
</blockquote>





<hr size="6">
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="interfaces-for-programmers.de.html" title="Anfang dieses oder des letzten Kapitels"> &lt;&lt; Schnittstellen für Programmierer&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="index.de.html" title="Titelseite des Dokuments" rel="start">Anfang</a>][<a href="index_toc.de.html#SEC_Contents" title="Inhaltsverzeichnis" rel="contents">Inhalt</a>][<a href="lilypond-index.de.html" title="Index" rel="index">Index</a>][<a href="index_abt.de.html#SEC_About" title="&Uuml;ber (Hilfe)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="lilypond-scheme-interfaces.de.html" title="N&auml;chstes Kapitel">&nbsp;LilyPond Scheme-Schnittstellen &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#a-complete-example" title="Voriger Abschnitt in Lesereihenfolge" accesskey="p" rel="previous"> &lt; Ein vollständiges Bespiel&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#new-markup-command-definition" title="Abschnitt nach oben" accesskey="u" rel="up">&nbsp; Nach oben :&nbsp;Neue Definitionen von Beschriftungsbefehlen&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="new-markup-list-command-definition.de.html" title="N&auml;chster Abschnitt in Lesereihenfolge" accesskey="n" rel="next">&nbsp;Neue Definitionen von Beschriftungslistenbefehlen &gt; </a>]</td></tr></table>
<!-- footer_tag -->
<div class="footer">
<!-- This footer was autogenerated by /home/gub/NewGub/gub/target/linux-x86/build/lilypond-git.sv.gnu.org--lilypond.git-release-unstable/scripts/build/out/www_post -->
<p class="footer_version">
Diese Seite ist für LilyPond-2.19.65 (Entwicklungszweig).
</p>
<p class="footer_report">
Ihre Hilfe ist willkommen. Bitte <a href="http://lilypond.org/help-us.html">helfen Sie</a> uns, indem Sie Probleme und Fehler an unsere <a·href="http://post.gmane.org/post.php?group=gmane.comp.gnu.lilypond.bugs">Fehler-Liste</a> schicken.
</p>
</div>


<p id="languages">
<!-- These links were autogenerated by /home/gub/NewGub/gub/target/linux-x86/build/lilypond-git.sv.gnu.org--lilypond.git-release-unstable/scripts/build/out/www_post -->
 Andere Sprachen: <a href="new-markup-command-definition.html">English</a>, <a href="new-markup-command-definition.es.html">español</a>, <a href="new-markup-command-definition.fr.html">français</a>.
 <br>
 About <a href="http://www.lilypond.org/website/misc/browser-language">automatic language selection</a>.
</p>

<!-- FOOTER -->

<!-- end div#main here -->
</div>



<div id="tocframe">
<p class="toc_uplink"><a href="../../Documentation/web/manuals.de.html"
         title="Documentation Index">&lt;&lt; Zur Dokumentationsübersicht</a></p>
<h4 class="toc_header"> <a href="index.de.html" title="Start of the manual">LilyPond &ndash; Extending  v2.19.65 (Entwicklungszweig). </a></h4>
<div class="contents">
<ul class="toc">
  <li class=""><a name="toc-Scheme_002dTutorium-1" href="scheme-tutorial.de.html">1. Scheme-Tutorium</a>
  <ul class="toc">
    <li class=""><a name="toc-Einleitung-in-Scheme-1" href="introduction-to-scheme.de.html">1.1 Einleitung in Scheme</a>    </li>
    <li class=""><a name="toc-Scheme-in-LilyPond-1" href="scheme-in-lilypond.de.html">1.2 Scheme in LilyPond</a>    </li>
    <li class=""><a name="toc-Komplizierte-Funktionen-erstellen-1" href="building-complicated-functions.de.html">1.3 Komplizierte Funktionen erstellen</a>    </li>
  </ul>
  </li>
  <li class=" toc_current"><a name="toc-Schnittstellen-fur-Programmierer" href="interfaces-for-programmers.de.html">2. Schnittstellen für Programmierer</a>
  <ul class="toc">
    <li class=""><a name="toc-LilyPond_002dCodeabschnitte-1" href="lilypond-code-blocks.de.html">2.1 LilyPond-Codeabschnitte</a>    </li>
    <li class=""><a name="toc-Scheme_002dFunktionen-1" href="scheme-functions.de.html">2.2 Scheme-Funktionen</a>    </li>
    <li class=""><a name="toc-Musikalische-Funktionen-1" href="music-functions.de.html">2.3 Musikalische Funktionen</a>    </li>
    <li class=""><a name="toc-Ereignisfunktionen-1" href="event-functions.de.html">2.4 Ereignisfunktionen</a>    </li>
    <li class=" toc_current"><a name="toc-Textbeschriftungsfunktionen-1" href="markup-functions.de.html">2.5 Textbeschriftungsfunktionen</a>
    <ul class="toc">
      <li class=""><a name="toc-Beschriftungskonstruktionen-in-Scheme-1" href="markup-construction-in-scheme.de.html">2.5.1 Beschriftungskonstruktionen in Scheme</a>      </li>
      <li class=""><a name="toc-Wie-Beschriftungen-intern-funktionieren-1" href="how-markups-work-internally.de.html">2.5.2 Wie Beschriftungen intern funktionieren</a>      </li>
      <li class=" toc_current"><a name="toc-Neue-Definitionen-von-Beschriftungsbefehlen-1" href="new-markup-command-definition.de.html">2.5.3 Neue Definitionen von Beschriftungsbefehlen</a>
      <ul class="toc">
        <li class=""><a name="toc-Syntax-der-Definition-von-Textbeschriftungsbefehlen-1" href="new-markup-command-definition.de.html#markup-command-definition-syntax">Syntax der Definition von Textbeschriftungsbefehlen</a>        </li>
        <li class=""><a name="toc-Uber-Eigenschaften" href="new-markup-command-definition.de.html#on-properties">Über Eigenschaften</a>        </li>
        <li class=""><a name="toc-Ein-vollstandiges-Bespiel" href="new-markup-command-definition.de.html#a-complete-example">Ein vollständiges Bespiel</a>        </li>
        <li class=""><a name="toc-Eingebaute-Befehle-anpassen-1" href="new-markup-command-definition.de.html#adapting-builtin-commands">Eingebaute Befehle anpassen</a>        </li>
      </ul>
      </li>
      <li class=""><a name="toc-Neue-Definitionen-von-Beschriftungslistenbefehlen-1" href="new-markup-list-command-definition.de.html">2.5.4 Neue Definitionen von Beschriftungslistenbefehlen</a>      </li>
    </ul>
    </li>
    <li class=""><a name="toc-Kontexte-fur-Programmierer" href="contexts-for-programmers.de.html">2.6 Kontexte für Programmierer</a>    </li>
    <li class=""><a name="toc-Callback_002dFunktionen-1" href="callback-functions.de.html">2.7 Callback-Funktionen</a>    </li>
    <li class=""><a name="toc-Scheme_002dCode-innerhalb-LilyPonds-1" href="inline-scheme-code.de.html">2.8 Scheme-Code innerhalb LilyPonds</a>    </li>
    <li class=""><a name="toc-Schwierige-Korrekturen-1" href="difficult-tweaks.de.html">2.9 Schwierige Korrekturen</a>    </li>
  </ul>
  </li>
  <li class=""><a name="toc-LilyPond-Scheme_002dSchnittstellen-1" href="lilypond-scheme-interfaces.de.html">3. LilyPond Scheme-Schnittstellen</a>  </li>
  <li class=""><a name="toc-GNU-Free-Documentation-License-1" href="gnu-free-documentation-license.de.html">A. GNU Free Documentation License</a>  </li>
  <li class=""><a name="toc-LilyPond_002dIndex-1" href="lilypond-index.de.html">B. LilyPond-Index</a>  </li>
<li>
<!--
    Translation of GIT committish: ebe492ca408fb0d9abf80b94c56197eef8dc2f09

    When revising a translation, copy the HEAD committish of the
    version that you are working on.  See TRANSLATION for details.
-->

<!--
we depend on an external entity here, which we cannot control.  Suppose
we go from 2.15.x to 2.17.x and put the documentation under "v2.17".
For some time, Google won't have the new location in its index, so the
search would get nothing.  It would be better to keep "v2.15" in the
search for a while and have a redirection from "v2.15" to "v2.17".
-->

<form action="http://google.com/search"
      method="get"
      name="search"
      onSubmit="search.q.value='site:lilypond.org/doc/v2.19 '
		+ search.brute_query.value"
      onMouseMove="search.q.value='site:lilypond.org/doc/v2.19 '
		   + search.brute_query.value"
      onKeyUp="search.q.value='site:lilypond.org/doc/v2.19 '
	       + search.brute_query.value">
  <input type="hidden" name="btnG" value="Mit Google suchen">
  <input type="text" name="brute_query" onfocus="this.value=''" value="Suche">
  <input type="hidden" name="q" value="">
</form>
</li>
</ul>
</div>
</div>

</body>
</html>
