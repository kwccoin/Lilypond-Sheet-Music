<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Copyright C 2003-2015 por los autores.

La traducción de la siguiente nota de copyright se ofrece como
cortesía para las personas de habla no inglesa, pero únicamente la
nota en inglés tiene validez legal.

The translation of the following copyright notice is provided
for courtesy to non-English speakers, but only the notice in English
legally counts.

Se otorga permiso para copiar, distribuir y/o modificar este documento
bajo los términos de la Licencia de Documentación Libre de GNU, versión 1.1
o cualquier versión posterior publicada por la Free Software Foundation;
sin ninguna de las secciones invariantes.
Se incluye una copia de esta licencia dentro de la sección titulada "Licencia
de Documentación Libre de GNU".


Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.1
or any later version published by the Free Software Foundation;
with no Invariant Sections.
A copy of the license is included in the section entitled "GNU
Free Documentation License".

 -->
<!-- Created on el 6 agosto 2017 by texi2html 1.82
texi2html was written by: 
            Lionel Cons <Lionel.Cons@cern.ch> (original author)
            Karl Berry  <karl@freefriends.org>
            Olaf Bachmann <obachman@mathematik.uni-kl.de>
            and many others.
Maintained by: Many creative people.
Send bugs and suggestions to <texi2html-bug@nongnu.org>
-->
<head>
<title>Extender LilyPond: B.6.1 Evaluación de contextos</title>

<meta name="description" content="Extender LilyPond: B.6.1 Evaluación de contextos">
<meta name="keywords" content="Extender LilyPond: B.6.1 Evaluación de contextos">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="texi2html 1.82">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link href="index.es.html#index" rel="start" title="LilyPond &mdash; Extender">
<link href="lilypond-index.es.html#lilypond-index" rel="index" title="E. Índice de LilyPond">
<link href="index_toc.es.html#SEC_Contents" rel="contents" title="&Iacute;ndice General">
<link href="index_abt.es.html#SEC_About" rel="help" title="Acerca de este documento">
<link href="contexts-for-programmers.es.html#contexts-for-programmers" rel="up" title="B.6 Contextos para programadores">
<link href="lilypond-index.es.html#lilypond-index" rel="next" title="E. Índice de LilyPond">
<link href="contexts-for-programmers.es.html#contexts-for-programmers" rel="previous" title="B.6 Contextos para programadores">
<link rel="stylesheet" type="text/css" title="Default style" href="../../Documentation/css/lilypond-manuals.css">
<!--[if lte IE 7]>
<link href="../../Documentation/css/lilypond-manuals-ie-fixes.css" rel="stylesheet" type="text/css">
<![endif]-->


</head>

<body lang="es" class="extending devStatus">


<div id="main">
<a name="Evaluaci_00f3n-de-contextos"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="interfaces-for-programmers.es.html" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Interfaces para programadores&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="index.es.html" title="Portada del documento" rel="start">Arriba</a>][<a href="index_toc.es.html#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="lilypond-index.es.html" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="index_abt.es.html#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="lilypond-scheme-interfaces.es.html" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces de Scheme de LilyPond &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="contexts-for-programmers.es.html" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Contextos para programadores&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="contexts-for-programmers.es.html" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Contextos para programadores&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="running-a-function-on-all-layout-objects.es.html" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Ejecutar una función sobre todos los objetos de la presentación &gt; </a>]</td></tr></table>
<a name="context-evaluation"></a>
<h3 class="subsection">B.6.1 Evaluación de contextos</h3>

<a name="index-codigo_002c-llamadas-durante-la-interpretacion"></a>
<a name="index-_005capplyContext"></a>
<a name="index-_005capplyContext-1"></a>
<a name="index-make_002dapply_002dcontext"></a>
<a name="index-make_002dapply_002dcontext-1"></a>
<a name="index-ly_003acontext_002dproperty"></a>
<a name="index-ly_003acontext_002dproperty-1"></a>
<a name="index-ly_003acontext_002dset_002dproperty_0021"></a>
<a name="index-ly_003acontext_002dset_002dproperty_0021-1"></a>
<a name="index-ly_003acontext_002dgrob_002ddefinition"></a>
<a name="index-ly_003acontext_002dgrob_002ddefinition-1"></a>
<a name="index-ly_003aassoc_002dget"></a>
<a name="index-ly_003aassoc_002dget-1"></a>
<a name="index-ly_003acontext_002dpushpop_002dproperty"></a>
<a name="index-ly_003acontext_002dpushpop_002dproperty-1"></a>

<p>Se pueden modificar los contextos durante la interpretación con
código de Scheme.  Dentro de un bloque de código de LilyPond, la
sintaxis para esto es:
</p>
<blockquote><pre class="example">\applyContext <var>función</var>
</pre></blockquote>

<p>En código de Scheme, la sintaxis es:
</p>
<blockquote><pre class="example">(make-apply-context <var>function</var>)
</pre></blockquote>

<p><code><var>función</var></code> debe ser una función de Scheme que toma un
único argumento, que es el contexto al que aplicarla.  La función
puede acceder a, así como sobreescribir u establecer propiedades
de grobs s y propiedades de contextos.  Cualquier acción tomada
por la función que dependa del estado del contexto, está limitada
al estado del contexto <em>en el momento de llamar a la
función</em>.  Asimismo, los cambios efectuados por una llamada a
<code>\applyContext</code> permanecen en efecto hasta que se modifican
de nuevo directamente, o se revierten, incluso si han cambiado las
condiciones iniciales sobre las que dependen.
</p>
<p>Las siguientes funciones de Scheme son útiles cuando se utiliza
<code>\applyContext</code>:
</p>
<dl compact="compact">
<dt> <code>ly:context-property</code></dt>
<dd><p>recuperar el valor de una propiedad de contexto
</p>
</dd>
<dt> <code>ly:context-set-property!</code></dt>
<dd><p>establecer el valor de una propiedad de contexto
</p>
</dd>
<dt> <code>ly:context-grob-definition</code></dt>
<dt> <code>ly:assoc-get</code></dt>
<dd><p>recuperar el valor de una propiedad de un grob
</p>
</dd>
<dt> <code>ly:context-pushpop-property</code></dt>
<dd><p>hacer una sobreescritura temporal
(<code>\temporary&nbsp;\override</code>) o una reversión
(<code>\revert</code>) sobre una propiedad de un grob
</p></dd>
</dl>

<p>El ejemplo siguiente recupera el valor actual de <code>fontSize</code>,
y a continuación lo dobla:
</p>
<blockquote><pre class="verbatim">doubleFontSize =
\applyContext
  #(lambda (context)
     (let ((fontSize (ly:context-property context 'fontSize)))
       (ly:context-set-property! context 'fontSize (+ fontSize 6))))

{
  \set fontSize = -3
  b'4
  \doubleFontSize
  b'
}
</pre><p>
 <a href="../d4/lily-b353ab4a.ly">
  <img align="middle"
       border="0"
       src="../d4/lily-b353ab4a.png"
       alt="[image of music]">
 </a>
</p>
</blockquote>




<p>El ejemplo siguiente recupera los colores actuales de los grobs
<code>NoteHead</code>, <code>Stem</code> y <code>Beam</code>, y a continuación los
modifica para que tengan un matiz menos saturado.
</p>
<blockquote><pre class="verbatim">desaturate =
\applyContext
  #(lambda (context)
     (define (desaturate-grob grob)
       (let* ((grob-def (ly:context-grob-definition context grob))
              (color (ly:assoc-get 'color grob-def black))
              (new-color (map (lambda (x) (min 1 (/ (1+ x) 2))) color)))
         (ly:context-pushpop-property context grob 'color new-color)))
     (for-each desaturate-grob '(NoteHead Stem Beam)))

\relative {
  \time 3/4
  g'8[ g] \desaturate g[ g] \desaturate g[ g]
  \override NoteHead.color = #darkred
  \override Stem.color = #darkred
  \override Beam.color = #darkred
  g[ g] \desaturate g[ g] \desaturate g[ g]
}
</pre><p>
 <a href="../ea/lily-0dfa90ac.ly">
  <img align="middle"
       border="0"
       src="../ea/lily-0dfa90ac.png"
       alt="[image of music]">
 </a>
</p>
</blockquote>




<p>Esto puede implementarse también como una función musical, con el
objeto de restringir las modificaciones a un único bloque de
música.  Observe cómo se usa <code>ly:context-pushpop-property</code>
tanto como una sobreescritura temporal
(<code>\temporary&nbsp;\override</code>) como una reversión
(<code>\revert</code>):
</p>
<blockquote><pre class="verbatim">desaturate =
#(define-music-function
   (music) (ly:music?)
   #{
     \applyContext
     #(lambda (context)
        (define (desaturate-grob grob)
          (let* ((grob-def (ly:context-grob-definition context grob))
                 (color (ly:assoc-get 'color grob-def black))
                 (new-color (map (lambda (x) (min 1 (/ (1+ x) 2))) color)))
            (ly:context-pushpop-property context grob 'color new-color)))
        (for-each desaturate-grob '(NoteHead Stem Beam)))
     #music
     \applyContext
     #(lambda (context)
        (define (revert-color grob)
          (ly:context-pushpop-property context grob 'color))
        (for-each revert-color '(NoteHead Stem Beam)))
   #})

\relative {
  \override NoteHead.color = #darkblue
  \override Stem.color = #darkblue
  \override Beam.color = #darkblue
  g'8 a b c
  \desaturate { d c b a }
  g b d b g2
}
</pre><p>
 <a href="../03/lily-454b4424.ly">
  <img align="middle"
       border="0"
       src="../03/lily-454b4424.png"
       alt="[image of music]">
 </a>
</p>
</blockquote>




<hr size="6">
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="interfaces-for-programmers.es.html" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Interfaces para programadores&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="index.es.html" title="Portada del documento" rel="start">Arriba</a>][<a href="index_toc.es.html#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="lilypond-index.es.html" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="index_abt.es.html#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="lilypond-scheme-interfaces.es.html" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces de Scheme de LilyPond &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="contexts-for-programmers.es.html" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Contextos para programadores&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="contexts-for-programmers.es.html" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Contextos para programadores&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="running-a-function-on-all-layout-objects.es.html" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Ejecutar una función sobre todos los objetos de la presentación &gt; </a>]</td></tr></table>
<!-- footer_tag -->
<div class="footer">
<!-- This footer was autogenerated by /home/gub/NewGub/gub/target/linux-x86/build/lilypond-git.sv.gnu.org--lilypond.git-release-unstable/scripts/build/out/www_post -->
<p class="footer_version">
Esta página corresponde a LilyPond-2.19.65 (rama de desarrollo).
</p>
<p class="footer_report">
Se agradecen las <a href="http://lilypond.org/help-us.html">sugerencias para la documentación</a>. Informe de los fallos a través de la lista en español <a href="http://lists.gnu.org/mailman/listinfo/lilypond-es">lilypond-es</a>, o en inglés a través de <a href="http://post.gmane.org/post.php?group=gmane.comp.gnu.lilypond.bugs">la lista oficial de fallos</a>.
</p>
</div>


<p id="languages">
<!-- These links were autogenerated by /home/gub/NewGub/gub/target/linux-x86/build/lilypond-git.sv.gnu.org--lilypond.git-release-unstable/scripts/build/out/www_post -->
 Otros idiomas: <a href="context-evaluation.html">English</a>, <a href="context-evaluation.de.html">deutsch</a>, <a href="context-evaluation.fr.html">français</a>.
 <br>
 Acerca de la <a href="http://www.lilypond.org/website/misc/browser-language">selección automática del idioma</a>.
</p>

<!-- FOOTER -->

<!-- end div#main here -->
</div>



<div id="tocframe">
<p class="toc_uplink"><a href="../../Documentation/web/manuals.es.html"
         title="Documentation Index">&lt;&lt; Volver al índice de la documentación</a></p>
<h4 class="toc_header"> <a href="index.es.html" title="Start of the manual">LilyPond &mdash; Extender  v2.19.65 (rama de desarrollo). </a></h4>
<div class="contents">
<ul class="toc">
  <li class=""><a name="toc-Tutorial-de-Scheme-1" href="scheme-tutorial.es.html">A. Tutorial de Scheme</a>
  <ul class="toc">
    <li class=""><a name="toc-Introduccion-a-Scheme" href="introduction-to-scheme.es.html">A.1 Introducción a Scheme</a>    </li>
    <li class=""><a name="toc-Scheme-dentro-de-LilyPond-1" href="scheme-in-lilypond.es.html">A.2 Scheme dentro de LilyPond</a>    </li>
    <li class=""><a name="toc-Construir-funciones-complicadas-1" href="building-complicated-functions.es.html">A.3 Construir funciones complicadas</a>    </li>
  </ul>
  </li>
  <li class=" toc_current"><a name="toc-Interfaces-para-programadores-1" href="interfaces-for-programmers.es.html">B. Interfaces para programadores</a>
  <ul class="toc">
    <li class=""><a name="toc-Bloques-de-codigo-de-LilyPond" href="lilypond-code-blocks.es.html">B.1 Bloques de código de LilyPond</a>    </li>
    <li class=""><a name="toc-Funciones-de-Scheme-1" href="scheme-functions.es.html">B.2 Funciones de Scheme</a>    </li>
    <li class=""><a name="toc-Funciones-musicales-1" href="music-functions.es.html">B.3 Funciones musicales</a>    </li>
    <li class=""><a name="toc-Funciones-de-eventos-1" href="event-functions.es.html">B.4 Funciones de eventos</a>    </li>
    <li class=""><a name="toc-Funciones-de-marcado-1" href="markup-functions.es.html">B.5 Funciones de marcado</a>    </li>
    <li class=" toc_current"><a name="toc-Contextos-para-programadores-1" href="contexts-for-programmers.es.html">B.6 Contextos para programadores</a>
    <ul class="toc">
      <li class=" toc_current"><a name="toc-Evaluacion-de-contextos" href="context-evaluation.es.html">B.6.1 Evaluación de contextos</a>      </li>
      <li class=""><a name="toc-Ejecutar-una-funcion-sobre-todos-los-objetos-de-la-presentacion" href="running-a-function-on-all-layout-objects.es.html">B.6.2 Ejecutar una función sobre todos los objetos de la presentación</a>      </li>
    </ul>
    </li>
    <li class=""><a name="toc-Funciones-de-callback-1" href="callback-functions.es.html">B.7 Funciones de callback</a>    </li>
    <li class=""><a name="toc-Trucos-dificiles" href="difficult-tweaks.es.html">B.8 Trucos difíciles</a>    </li>
  </ul>
  </li>
  <li class=""><a name="toc-Interfaces-de-Scheme-de-LilyPond-1" href="lilypond-scheme-interfaces.es.html">C. Interfaces de Scheme de LilyPond</a>  </li>
  <li class=""><a name="toc-GNU-Free-Documentation-License-1" href="gnu-free-documentation-license.es.html">D. GNU Free Documentation License</a>  </li>
  <li class=""><a name="toc-Indice-de-LilyPond" href="lilypond-index.es.html">E. Índice de LilyPond</a>  </li>
<li>
<!--
    Translation of GIT committish: 1df9fc42197a6b2931f448cfba717527aead5e5a

    When revising a translation, copy the HEAD committish of the
    version that you are working on.  See TRANSLATION for details.

we depend on an external entity here, which we cannot control.  Suppose
we go from 2.15.x to 2.17.x and put the documentation under "v2.17".
For some time, Google won't have the new location in its index, so the
search would get nothing.  It would be better to keep "v2.15" in the
search for a while and have a redirection from "v2.15" to "v2.17".
-->

<form action="http://google.com/search"
      method="get"
      name="search"
      onSubmit="search.q.value='site:lilypond.org/doc/v2.19 '
		+ search.brute_query.value"
      onMouseMove="search.q.value='site:lilypond.org/doc/v2.19 '
		   + search.brute_query.value"
      onKeyUp="search.q.value='site:lilypond.org/doc/v2.19 '
	       + search.brute_query.value">
  <input type="hidden" name="btnG" value="Búsqueda de Google">
  <input type="text" name="brute_query" onfocus="this.value=''" value="Buscar">
  <input type="hidden" name="q" value="">
</form>
</li>
</ul>
</div>
</div>

</body>
</html>
