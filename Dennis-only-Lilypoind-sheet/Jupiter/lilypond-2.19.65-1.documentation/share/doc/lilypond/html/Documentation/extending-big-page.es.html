<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Copyright C 2003-2015 por los autores.

La traducción de la siguiente nota de copyright se ofrece como
cortesía para las personas de habla no inglesa, pero únicamente la
nota en inglés tiene validez legal.

The translation of the following copyright notice is provided
for courtesy to non-English speakers, but only the notice in English
legally counts.

Se otorga permiso para copiar, distribuir y/o modificar este documento
bajo los términos de la Licencia de Documentación Libre de GNU, versión 1.1
o cualquier versión posterior publicada por la Free Software Foundation;
sin ninguna de las secciones invariantes.
Se incluye una copia de esta licencia dentro de la sección titulada "Licencia
de Documentación Libre de GNU".


Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.1
or any later version published by the Free Software Foundation;
with no Invariant Sections.
A copy of the license is included in the section entitled "GNU
Free Documentation License".

 -->
<!-- Created on el 6 agosto 2017 by texi2html 1.82
texi2html was written by: 
            Lionel Cons <Lionel.Cons@cern.ch> (original author)
            Karl Berry  <karl@freefriends.org>
            Olaf Bachmann <obachman@mathematik.uni-kl.de>
            and many others.
Maintained by: Many creative people.
Send bugs and suggestions to <texi2html-bug@nongnu.org>
-->
<head>
<title>Extender LilyPond</title>

<meta name="description" content="Extender LilyPond">
<meta name="keywords" content="Extender LilyPond">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="texi2html 1.82">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link href="#index" rel="start" title="LilyPond &mdash; Extender">
<link href="#lilypond-index" rel="index" title="E. Índice de LilyPond">
<link href="#SEC_Contents" rel="contents" title="&Iacute;ndice General">
<link href="#SEC_About" rel="help" title="Acerca de este documento">
<link rel="stylesheet" type="text/css" title="Default style" href="../Documentation/css/lilypond-manuals.css">
<!--[if lte IE 7]>
<link href="../Documentation/css/lilypond-manuals-ie-fixes.css" rel="stylesheet" type="text/css">
<![endif]-->


</head>

<body lang="es" class="extending devStatus">


<div id="main">
<a name="Top"></a>
<table class="nav_table">
<tr><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td></tr></table>
<a name="index"></a>
<h1 class="settitle">LilyPond &mdash; Extender</h1>

<table class="cartouche" border="1"><tr><td>
<p>Este archivo explica la forma de extender las funcionalidades de
LilyPond versión 2.19.65.
</p></td></tr></table>







<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#scheme-tutorial" accesskey="1">A. Tutorial de Scheme</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">             Programación desde dentro de LilyPond.
</td></tr>
<tr><td align="left" valign="top"><a href="#interfaces-for-programmers" accesskey="2">B. Interfaces para programadores</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  Cómo interactuar con Scheme.
</td></tr>
<tr><td align="left" valign="top"><a href="#lilypond-scheme-interfaces" accesskey="3">C. Interfaces de Scheme de LilyPond</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top"> Obtener información hacia dentro y fuera de la música.
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">
Apéndices

</pre></th></tr><tr><td align="left" valign="top"><a href="#gnu-free-documentation-license" accesskey="4">D. GNU Free Documentation License</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top"> Licencia de este documento.
</td></tr>
<tr><td align="left" valign="top"><a href="#lilypond-index" accesskey="5">E. Índice de LilyPond</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<table class="cartouche" border="1"><tr><td>
<p>Para mayor información sobre la forma en que este manual se relaciona
con el resto de la documentación, o para leer este manual en otros
formatos, consulte <a name="index-Manuales"></a>
<a href="web-big-page.es.html#manuals">Manuales</a>.
</p>
<p>Si le falta algún manual, encontrará toda la documentación en
<a href="http://lilypond.org">http://lilypond.org/</a>.
</p></td></tr></table>








<hr size="1">
<a name="Tutorial-de-Scheme"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#index" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Top&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#interfaces-for-programmers" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces para programadores &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#index" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Top&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#index" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Top&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#introduction-to-scheme" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Introducción a Scheme &gt; </a>]</td></tr></table>
<a name="scheme-tutorial"></a>
<h1 class="appendix">A. Tutorial de Scheme</h1>

<a name="index-Scheme"></a>
<a name="index-GUILE"></a>
<a name="index-Scheme_002c-codigo-en-linea"></a>
<a name="index-acceder-a-Scheme"></a>
<a name="index-evaluar-Scheme"></a>
<a name="index-LISP"></a>

<p>LilyPond utiliza el lenguaje de programación Scheme, tanto como
parte de la sintaxis del código de entrada, como para servir de
mecanismo interno que une los módulos del programa entre sí.  Esta
sección es una panorámica muy breve sobre cómo introducir datos en
Scheme.  Si quiere saber más sobre Scheme, consulte
<a href="http://www.schemers.org">http://www.schemers.org</a>.
</p>
<p>LilyPond utiliza la implementación GNU Guile de Scheme, que está
basada en el estándar &ldquo;R5RS&rdquo; del lenguaje.  Si está aprendiendo
Scheme para usarlo con LilyPond, no se recomienda trabajar con una
implementación distinta (o que se refiera a un estándar
diferente).  Hay información sobre Guile en
<a href="http://www.gnu.org/software/guile">http://www.gnu.org/software/guile/</a>.  El estándar de Scheme
&ldquo;R5RS&rdquo; se encuentra en
<a href="http://www.schemers.org/Documents/Standards/R5RS">http://www.schemers.org/Documents/Standards/R5RS/</a>.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#introduction-to-scheme" accesskey="1">A.1 Introducción a Scheme</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#scheme-in-lilypond" accesskey="2">A.2 Scheme dentro de LilyPond</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#building-complicated-functions" accesskey="3">A.3 Construir funciones complicadas</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr size="6">
<a name="Introducci_00f3n-a-Scheme"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#scheme-tutorial" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Tutorial de Scheme&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#interfaces-for-programmers" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces para programadores &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#scheme-tutorial" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Tutorial de Scheme&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#scheme-tutorial" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Tutorial de Scheme&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#scheme-sandbox" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Cajón de arena de Scheme &gt; </a>]</td></tr></table>
<a name="introduction-to-scheme"></a>
<h2 class="section">A.1 Introducción a Scheme</h2>

<p>Comenzaremos con una introducción a Scheme.  Para esta breve
introducción utilizaremos el intérprete GUILE para explorar la
manera en que el lenguaje funciona.  Una vez nos hayamos
familiarizado con Scheme, mostraremos cómo se puede integrar el
lenguaje en los archivos de LilyPond.
</p>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#scheme-sandbox" accesskey="1">A.1.1 Cajón de arena de Scheme</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#scheme-variables" accesskey="2">A.1.2 Variables de Scheme</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#scheme-simple-data-types" accesskey="3">A.1.3 Tipos de datos simples de Scheme</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#scheme-compound-data-types" accesskey="4">A.1.4 Tipos de datos compuestos de Scheme</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#calculations-in-scheme" accesskey="5">A.1.5 Cálculos en Scheme</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#scheme-procedures" accesskey="6">A.1.6 Procedimientos de Scheme</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#scheme-conditionals" accesskey="7">A.1.7 Condicionales de Scheme</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr size="6">
<a name="Caj_00f3n-de-arena-de-Scheme"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#scheme-tutorial" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Tutorial de Scheme&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#interfaces-for-programmers" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces para programadores &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#introduction-to-scheme" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Introducción a Scheme&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#introduction-to-scheme" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Introducción a Scheme&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#scheme-variables" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Variables de Scheme &gt; </a>]</td></tr></table>
<a name="scheme-sandbox"></a>
<h3 class="subsection">A.1.1 Cajón de arena de Scheme</h3>

<p>La instalación de LilyPond incluye también la de la implementación
Guile de Scheme.  Sobre casi todos los sistemas puede experimentar
en una &ldquo;caja de arena&rdquo; de Scheme abriendo una ventana del
terminal y tecleando &lsquo;guile&rsquo;.  En algunos sistemas, sobre todo
en Windows, podría necesitar ajustar la variable de entorno
<code>GUILE_LOAD_PATH</code> a la carpeta <code>../usr/share/guile/1.8</code>
dentro de la instalación de LilyPond (para conocer la ruta
completa a esta carpeta, consulte <a name="index-Otras-fuentes-de"></a>
información
<a href="learning-big-page.es.html#other-sources-of-information">Otras fuentes de información</a>).  Como alternativa, los usuarios de Windows pueden
seleccionar simplemente &lsquo;Ejecutar&rsquo; del menú Inicio e introducir
&lsquo;guile&rsquo;.
</p>
<p>Sin embargo, está disponible un cajón de arena de Scheme listo
para funcionar con todo LilyPond cargado, con esta instrucción de
la línea de órdenes:
</p><blockquote><pre class="example">lilypond scheme-sandbox
</pre></blockquote>

<p>Una vez está funcionando el cajón de arena, verá un indicador del
sistema de Guile:
</p>
<table><tr><td>&nbsp;</td><td><pre class="lisp">guile&gt;
</pre></td></tr></table>

<p>Podemos introducir expresiones de Scheme en este indicador para
experimentar con Scheme.  Si quiere usar la biblioteca readline de
GNU para una más cómoda edición de la línea de órdenes de Scheme,
consulte el archivo &lsquo;<tt>ly/scheme-sandbox.ly</tt>&rsquo; para más
información.  Si ya ha activado la biblioteca readline para las
sesiones de Guile interactivas fuera de LilyPond, debería
funcionar también en el cajón de arena.
</p>
<hr size="6">
<a name="Variables-de-Scheme"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#scheme-tutorial" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Tutorial de Scheme&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#interfaces-for-programmers" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces para programadores &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#scheme-sandbox" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Cajón de arena de Scheme&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#introduction-to-scheme" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Introducción a Scheme&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#scheme-simple-data-types" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Tipos de datos simples de Scheme &gt; </a>]</td></tr></table>
<a name="scheme-variables"></a>
<h3 class="subsection">A.1.2 Variables de Scheme</h3>

<p>Las variables de Scheme pueden tener cualquier valor válido de
Scheme, incluso un procedimiento de Scheme.
</p>
<p>Las variables de Scheme se crean con <code>define</code>:
</p>
<table><tr><td>&nbsp;</td><td><pre class="lisp">guile&gt; (define a 2)
guile&gt;
</pre></td></tr></table>

<p>Las variables de Scheme se pueden evaluar en el indicador del
sistema de guile, simplemente tecleando el nombre de la variable:
</p>
<table><tr><td>&nbsp;</td><td><pre class="lisp">guile&gt; a
2
guile&gt;
</pre></td></tr></table>

<p>Las variables de Scheme se pueden imprimir en la pantalla
utilizando la función display:
</p>
<table><tr><td>&nbsp;</td><td><pre class="lisp">guile&gt; (display a)
2guile&gt;
</pre></td></tr></table>

<p>Observe que el valor <code>2</code> y el indicador del sistema
<code>guile</code> se muestran en la misma línea.  Esto se puede evitar
llamando al procedimiento de nueva línea o imprimiendo un carácter
de nueva línea.
</p>
<table><tr><td>&nbsp;</td><td><pre class="lisp">guile&gt; (display a)(newline)
2
guile&gt; (display a)(display &quot;\n&quot;)
2
guile&gt;
</pre></td></tr></table>

<p>Una vez que se ha creado una variable, su valor se puede modificar
con <code>set!</code>:
</p>
<table><tr><td>&nbsp;</td><td><pre class="lisp">guile&gt; (set! a 12345)
guile&gt; a
12345
guile&gt;
</pre></td></tr></table>

<hr size="6">
<a name="Tipos-de-datos-simples-de-Scheme"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#scheme-tutorial" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Tutorial de Scheme&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#interfaces-for-programmers" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces para programadores &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#scheme-variables" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Variables de Scheme&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#introduction-to-scheme" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Introducción a Scheme&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#scheme-compound-data-types" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Tipos de datos compuestos de Scheme &gt; </a>]</td></tr></table>
<a name="scheme-simple-data-types"></a>
<h3 class="subsection">A.1.3 Tipos de datos simples de Scheme</h3>

<p>El concepto más básico de un lenguaje son sus tipos de datos:
números, cadenas de caracteres, listas, etc.  He aquí una lista de
los tipos de datos que son de relevancia respecto de la entrada de
LilyPond.
</p>
<dl compact="compact">
<dt> Booleanos</dt>
<dd><p>Los valores Booleanos son Verdadero y Falso.  Verdadero en Scheme es
<code>#t</code> y Falso es <code>#f</code>.
<a name="index-_0023_0023t"></a>
<a name="index-_0023_0023t-1"></a>
<a name="index-_0023_0023f"></a>
<a name="index-_0023_0023f-1"></a>
</p>
</dd>
<dt> Números</dt>
<dd><p>Los números se escriben de la forma normal, <code>1</code> es el número
(entero) uno, mientras que <code>-1.5</code> es un número en coma
flotante (un número no entero).
</p>
</dd>
<dt> Cadenas</dt>
<dd><p>Las cadenas se encierran entre comillas:
</p>
<blockquote><pre class="example">&quot;esto es una cadena&quot;
</pre></blockquote>

<p>Las cadenas pueden abarcar varias líneas:
</p>
<blockquote><pre class="example">&quot;esto
es
una cadena&quot;
</pre></blockquote>

<p>y los caracteres de nueva línea al final de cada línea se
incluirán dentro de la cadena.
</p>
<p>Los caracteres de nueva línea también se pueden añadir mediante la
inclusión de <code>\n</code> en la cadena.
</p>
<blockquote><pre class="example">&quot;esto\nes una\ncadena de varias líneas&quot;
</pre></blockquote>


<p>Las comillas dobles y barras invertidas se añaden a las cadenas
precediéndolas de una barra invertida.  La cadena <code>\a dijo
&quot;b&quot;</code> se introduce como
</p>
<blockquote><pre class="example">&quot;\\a dijo \&quot;b\&quot;&quot;
</pre></blockquote>

</dd>
</dl>

<p>Existen más tipos de datos de Scheme que no se estudian aquí.
Para ver un listado completo, consulte la guía de referencia de
Guile,
<a href="http://www.gnu.org/software/guile/manual/html_node/Simple-Data-Types.html">http://www.gnu.org/software/guile/manual/html_node/Simple-Data-Types.html</a>.
</p>
<hr size="6">
<a name="Tipos-de-datos-compuestos-de-Scheme"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#scheme-tutorial" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Tutorial de Scheme&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#interfaces-for-programmers" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces para programadores &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#scheme-simple-data-types" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Tipos de datos simples de Scheme&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#introduction-to-scheme" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Introducción a Scheme&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#pairs" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Parejas &gt; </a>]</td></tr></table>
<a name="scheme-compound-data-types"></a>
<h3 class="subsection">A.1.4 Tipos de datos compuestos de Scheme</h3>

<p>También existen tipos de datos compuestos en Scheme.  Entre los
tipos más usados en la programación de LilyPond se encuentran las
parejas, las listas, las listas-A y las tablas de hash.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#pairs" accesskey="1">Parejas</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#lists" accesskey="2">Listas</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#association-lists-_0028alists_0029" accesskey="3">Listas asociativas (listas-A)</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#hash-tables" accesskey="4">Tablas de hash</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr size="6">
<a name="Parejas"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#scheme-tutorial" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Tutorial de Scheme&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#interfaces-for-programmers" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces para programadores &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#scheme-compound-data-types" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Tipos de datos compuestos de Scheme&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#scheme-compound-data-types" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Tipos de datos compuestos de Scheme&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#lists" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Listas &gt; </a>]</td></tr></table>
<a name="pairs"></a>
<h4 class="unnumberedsubsubsec">Parejas</h4>

<p>El tipo fundacional de datos compuestos de Scheme es la
<code>pareja</code>.  Como se espera por su nombre, una pareja son dos
valores unidos en uno solo.  El operador que se usa para formar
una pareja se llama <code>cons</code>.
</p>
<table><tr><td>&nbsp;</td><td><pre class="lisp">guile&gt; (cons 4 5)
(4 . 5)
guile&gt;
</pre></td></tr></table>

<p>Observe que la pareja se imprime como dos elementos rodeados por
paréntesis y separados por un espacio, un punto (<code>.</code>) y otro
espacio.  El punto <em>no es</em> un punto decimal, sino más bien un
indicador de pareja.
</p>
<p>Las parejas también se pueden introducir como valores literales
precediéndolos de un carácter de comilla simple o apóstrofo.
</p>
<table><tr><td>&nbsp;</td><td><pre class="lisp">guile&gt; '(4 . 5)
(4 . 5)
guile&gt;
</pre></td></tr></table>

<p>Los dos elementos de una pareja pueden ser cualquier valor válido
de Scheme:
</p>
<table><tr><td>&nbsp;</td><td><pre class="lisp">guile&gt; (cons #t #f)
(#t . #f)
guile&gt; '(&quot;bla-bla&quot; . 3.1415926535)
(&quot;bla-bla&quot; . 3.1415926535)
guile&gt;
</pre></td></tr></table>

<p>Se puede accede al primero y segundo elementos de la pareja
mediante los procedimientos de Scheme <code>car</code> y <code>cdr</code>,
respectivamente.
</p>
<table><tr><td>&nbsp;</td><td><pre class="lisp">guile&gt; (define mipareja (cons 123 &quot;Hola&quot;)
&hellip; )
guile&gt; (car mipareja)
123
guile&gt; (cdr mipareja)
&quot;Hola&quot;
guile&gt;
</pre></td></tr></table>


<p>Nota: <code>cdr</code> se pronuncia &quot;could-er&quot;, según Sussman y Abelson,
véase
<a href="http://mitpress.mit.edu/sicp/full-text/book/book-Z-H-14.html#footnote_Temp_133">http://mitpress.mit.edu/sicp/full-text/book/book-Z-H-14.html#footnote_Temp_133</a>
</p>
<hr size="6">
<a name="Listas"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#scheme-tutorial" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Tutorial de Scheme&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#interfaces-for-programmers" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces para programadores &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#pairs" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Parejas&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#scheme-compound-data-types" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Tipos de datos compuestos de Scheme&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#association-lists-_0028alists_0029" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Listas asociativas (listas-A) &gt; </a>]</td></tr></table>
<a name="lists"></a>
<h4 class="unnumberedsubsubsec">Listas</h4>

<p>Una estructura de datos muy común en Scheme es la
<em>lista</em>. Formalmente, una lista &lsquo;bien hecha&rsquo; se define como
la lista vacía, representada como <code>'()</code> y con longitud cero,
o bien como una pareja cuyo <code>cdr</code> es a su vez una lista más
corta.
</p>
<p>Existen muchas formas de crear listas.  Quizá la más común es con
el procedimiento <code>list</code>:
</p>
<table><tr><td>&nbsp;</td><td><pre class="lisp">guile&gt; (list 1 2 3 &quot;abc&quot; 17.5)
(1 2 3 &quot;abc&quot; 17.5)
</pre></td></tr></table>

<p>La representación de una lista como elementos individuales
separados por espacios y encerrada entre paréntesis es realmente
una forma compacta de las parejas con punto que constituyen la
lista, donde el punto e inmediatamente un paréntesis de apertura
se suprimen junto al paréntesis de cierre correspondiente.  Sin
esta compactación, la salida habría sido
</p><table><tr><td>&nbsp;</td><td><pre class="lisp">(1 . (2 . (3 . (&quot;abc&quot; . (17.5 . ())))))
</pre></td></tr></table>

<p>De igual forma que con la salida, una lista puede escribirse
(después de haber añadido un apóstrofo para evitar su
interpretación como una llamada de función) como una lista literal
encerrando sus elementos entre paréntesis:
</p>
<table><tr><td>&nbsp;</td><td><pre class="lisp">guile&gt; '(17 23 &quot;fulano&quot; &quot;mengano&quot; &quot;zutano&quot;)
(17 23 &quot;fulano&quot; &quot;mengano&quot; &quot;zutano&quot;)
</pre></td></tr></table>

<p>Las listas son una parte fundamental de Scheme.  De hecho, Scheme
se considera un dialecto de Lisp, donde &lsquo;lisp&rsquo; es una
abreviatura de &lsquo;List Processing&rsquo; (proceso de listas).  Todas las
expresiones de Scheme son listas.
</p>

<hr size="6">
<a name="Listas-asociativas-_0028listas_002dA_0029"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#scheme-tutorial" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Tutorial de Scheme&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#interfaces-for-programmers" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces para programadores &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#lists" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Listas&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#scheme-compound-data-types" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Tipos de datos compuestos de Scheme&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#hash-tables" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Tablas de hash &gt; </a>]</td></tr></table>
<a name="association-lists-_0028alists_0029"></a>
<h4 class="unnumberedsubsubsec">Listas asociativas (listas-A)</h4>

<p>Un tipo especial de listas son las <em>listas asociativas</em> o
<em>listas-A</em>.  Se puede usar una lista-A para almacenar datos
para su fácil recuperación posterior.
</p>
<p>Las listas-A son listas cuyos elementos son parejas.  El
<code>car</code> de cada elemento se llama <em>clave</em>, y el <code>cdr</code>
de cada elemento se llama <em>valor</em>.  El procedimiento de
Scheme <code>assoc</code> se usa para recuperar un elemento de la
lista-A, y <code>cdr</code> se usa para recuperar el valor:
</p>
<table><tr><td>&nbsp;</td><td><pre class="lisp">guile&gt; (define mi-lista-a '((1  . &quot;A&quot;) (2 . &quot;B&quot;) (3 . &quot;C&quot;)))
guile&gt; mi-lista-a
((1 . &quot;A&quot;) (2 . &quot;B&quot;) (3 . &quot;C&quot;))
guile&gt; (assoc 2 mi-lista-a)
(2 . &quot;B&quot;)
guile&gt; (cdr (assoc 2 mi-lista-a))
&quot;B&quot;
guile&gt;
</pre></td></tr></table>

<p>Las listas-A se usan mucho en LilyPond para almacenar propiedades
y otros datos.
</p>

<hr size="6">
<a name="Tablas-de-hash"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#scheme-tutorial" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Tutorial de Scheme&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#interfaces-for-programmers" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces para programadores &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#association-lists-_0028alists_0029" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Listas asociativas (listas-A)&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#scheme-compound-data-types" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Tipos de datos compuestos de Scheme&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#calculations-in-scheme" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Cálculos en Scheme &gt; </a>]</td></tr></table>
<a name="hash-tables"></a>
<h4 class="unnumberedsubsubsec">Tablas de hash</h4>

<p>Estructuras de datos que se utilizan en LilyPond de forma
ocasional.  Una tabla de hash es similar a una matriz, pero los
índices de la matriz pueden ser cualquier tipo de valor de Scheme,
no sólo enteros.
</p>
<p>Las tablas de hash son más eficientes que las listas-A si hay una
gran cantidad de datos que almacenar y los datos cambian con muy
poca frecuencia.
</p>
<p>La sintaxis para crear tablas de hash es un poco compleja, pero
veremos ejemplos de ello en el código fuente de LilyPond.
</p>
<table><tr><td>&nbsp;</td><td><pre class="lisp">guile&gt; (define h (make-hash-table 10))
guile&gt; h
#&lt;hash-table 0/31&gt;
guile&gt; (hashq-set! h 'key1 &quot;val1&quot;)
&quot;val1&quot;
guile&gt; (hashq-set! h 'key2 &quot;val2&quot;)
&quot;val2&quot;
guile&gt; (hashq-set! h 3 &quot;val3&quot;)
&quot;val3&quot;
</pre></td></tr></table>

<p>Los valores se recuperan de las tablas de hash mediante
<code>hashq-ref</code>.
</p>
<table><tr><td>&nbsp;</td><td><pre class="lisp">guile&gt; (hashq-ref h 3)
&quot;val3&quot;
guile&gt; (hashq-ref h 'key2)
&quot;val2&quot;
guile&gt;
</pre></td></tr></table>

<p>Las claves y los valores se recuperan como una pareja con
<code>hashq-get-handle</code>.  Ésta es la forma preferida, porque
devuelve <code>#f</code> si no se encuentra la clave.
</p>
<table><tr><td>&nbsp;</td><td><pre class="lisp">guile&gt; (hashq-get-handle h 'key1)
(key1 . &quot;val1&quot;)
guile&gt; (hashq-get-handle h 'frob)
#f
guile&gt;
</pre></td></tr></table>

<hr size="6">
<a name="C_00e1lculos-en-Scheme"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#scheme-tutorial" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Tutorial de Scheme&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#interfaces-for-programmers" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces para programadores &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#hash-tables" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Tablas de hash&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#introduction-to-scheme" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Introducción a Scheme&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#scheme-procedures" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Procedimientos de Scheme &gt; </a>]</td></tr></table>
<a name="calculations-in-scheme"></a>
<h3 class="subsection">A.1.5 Cálculos en Scheme</h3>


<p>Scheme se puede usar para hacer cálculos.  Utiliza sintaxis
<em>prefija</em>.  Sumar 1 y&nbsp;2 se escribe como <code>(+ 1 2)</code> y
no como el tradicional <em>1+2</em>.
</p>
<table><tr><td>&nbsp;</td><td><pre class="lisp">guile&gt; (+ 1 2)
3
</pre></td></tr></table>

<p>Los cálculos se pueden anidar; el resultado de una función se
puede usar para otro cálculo.
</p>
<table><tr><td>&nbsp;</td><td><pre class="lisp">guile&gt; (+ 1 (* 3 4))
13
</pre></td></tr></table>

<p>Estos cálculos son ejemplos de evaluaciones; una expresión como
<code>(* 3 4)</code> se sustituye por su valor <code>12</code>.
</p>
<p>Los cálculos de Scheme son sensibles a las diferencias entre
enteros y no enteros.  Los cálculos enteros son exactos, mientras
que los no enteros se calculan con los límites de precisión
adecuados:
</p>
<table><tr><td>&nbsp;</td><td><pre class="lisp">guile&gt; (/ 7 3)
7/3
guile&gt; (/ 7.0 3.0)
2.33333333333333
</pre></td></tr></table>

<p>Cuando el intérprete de Scheme encuentra una expresión que es una
lista, el primer elemento de la lista se trata como un
procedimiento a evaluar con los argumentos del resto de la lista.
Por tanto, todos los operadores en Scheme son operadores prefijos.
</p>
<p>Si el primer elemento de una expresión de Scheme que es una lista
que se pasa al intérprete <em>no es</em> un operador o un
procedimiento, se produce un error:
</p>
<table><tr><td>&nbsp;</td><td><pre class="lisp">guile&gt; (1 2 3)

Backtrace:
In current input:
  52: 0* [1 2 3]

&lt;unnamed port&gt;:52:1: In expression (1 2 3):
&lt;unnamed port&gt;:52:1: Wrong type to apply: 1
ABORT: (misc-error)
guile&gt;
</pre></td></tr></table>

<p>Aquí podemos ver que el intérprete estaba intentando tratar el 1
como un operador o procedimiento, y no pudo hacerlo.  De aquí que
el error sea &quot;Wrong type to apply: 1&quot;.
</p>
<p>Así pues, para crear una lista debemos usar el operador de lista,
o podemos precederla de un apóstrofo para que el intérprete no
trate de evaluarla.
</p>
<table><tr><td>&nbsp;</td><td><pre class="lisp">guile&gt; (list 1 2 3)
(1 2 3)
guile&gt; '(1 2 3)
(1 2 3)
guile&gt;
</pre></td></tr></table>

<p>Esto es un error que puede aparecer cuando trabaje con Scheme
dentro de LilyPond.
</p>


<hr size="6">
<a name="Procedimientos-de-Scheme"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#scheme-tutorial" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Tutorial de Scheme&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#interfaces-for-programmers" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces para programadores &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#calculations-in-scheme" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Cálculos en Scheme&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#introduction-to-scheme" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Introducción a Scheme&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#defining-procedures" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Definir procedimientos &gt; </a>]</td></tr></table>
<a name="scheme-procedures"></a>
<h3 class="subsection">A.1.6 Procedimientos de Scheme</h3>

<p>Los procedimientos de Scheme son expresiones de Scheme ejecutables
que devuelven un valor resultante de su ejecución.  También pueden
manipular variables definidas fuera del procedimiento.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#defining-procedures" accesskey="1">Definir procedimientos</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#predicates" accesskey="2">Predicados</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#return-values" accesskey="3">Valores de retorno</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr size="6">
<a name="Definir-procedimientos"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#scheme-tutorial" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Tutorial de Scheme&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#interfaces-for-programmers" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces para programadores &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#scheme-procedures" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Procedimientos de Scheme&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#scheme-procedures" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Procedimientos de Scheme&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#predicates" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Predicados &gt; </a>]</td></tr></table>
<a name="defining-procedures"></a>
<h4 class="unnumberedsubsubsec">Definir procedimientos</h4>

<p>Los procedimientos se definen en Scheme con <code>define</code>:
</p>
<blockquote><pre class="example">(define (nombre-de-la-función arg1 arg2 ... argn)
 expresión-de-scheme-que-devuelve-un-valor)
</pre></blockquote>

<p>Por ejemplo, podemos definir un procedimiento para calcular la
media:
</p>
<table><tr><td>&nbsp;</td><td><pre class="lisp">guile&gt; (define (media x y) (/ (+ x y) 2))
guile&gt; media
#&lt;procedure media (x y)&gt;
</pre></td></tr></table>

<p>Una vez se ha definido un procedimiento, se llama poniendo el
nombre del procedimiento dentro de una lista.  Por ejemplo,
podemos calcular la media de 3 y 12:
</p>
<table><tr><td>&nbsp;</td><td><pre class="lisp">guile&gt; (media 3 12)
15/2
</pre></td></tr></table>


<hr size="6">
<a name="Predicados"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#scheme-tutorial" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Tutorial de Scheme&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#interfaces-for-programmers" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces para programadores &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#defining-procedures" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Definir procedimientos&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#scheme-procedures" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Procedimientos de Scheme&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#return-values" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Valores de retorno &gt; </a>]</td></tr></table>
<a name="predicates"></a>
<h4 class="unnumberedsubsubsec">Predicados</h4>

<p>Los procedimientos de Scheme que devuelven valores booleanos se
suelen llamar <em>predicados</em>.  Por convenio (pero no por
necesidad), los nombres de predicados acaban en un signo de
interrogación:
</p>
<table><tr><td>&nbsp;</td><td><pre class="lisp">guile&gt; (define (menor-que-diez? x) (&lt; x 10))
guile&gt; (menor-que-diez? 9)
#t
guile&gt; (menor-que-diez? 15)
#f
</pre></td></tr></table>


<hr size="6">
<a name="Valores-de-retorno"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#scheme-tutorial" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Tutorial de Scheme&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#interfaces-for-programmers" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces para programadores &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#predicates" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Predicados&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#scheme-procedures" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Procedimientos de Scheme&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#scheme-conditionals" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Condicionales de Scheme &gt; </a>]</td></tr></table>
<a name="return-values"></a>
<h4 class="unnumberedsubsubsec">Valores de retorno</h4>

<p>Los procedimientos de Scheme siempre devuelven un valor de
retorno, que es el valor de la última expresión ejecutada en el
procedimiento.  El valor de retorno puede ser cualquier valor de
Scheme válido, incluso una estructura de datos compleja o un
procedimiento.
</p>
<p>A veces, el usuario quiere tener varias expresiones de Scheme
dentro de un procedimiento.  Existen dos formas en que se pueden
combinar distintas expresiones.  La primera es el procedimiento
<code>begin</code>, que permite evaluar varias expresiones, y devuelve
el valor de la última expresión.
</p>
<table><tr><td>&nbsp;</td><td><pre class="lisp">guile&gt; (begin (+ 1 2) (- 5 8) (* 2 2))
4
</pre></td></tr></table>

<p>La segunda forma de combinar varias expresiones es dentro de un
bloque <code>let</code>.  Dentro de un bloque let, se crean una serie de
ligaduras o asignaciones, y después se evalúa una secuencia de
expresiones que pueden incluir esas ligaduras o asignaciones.  El
valor de retorno del bloque let es el valor de retorno de la
última sentencia del bloque let:
</p>
<table><tr><td>&nbsp;</td><td><pre class="lisp">guile&gt; (let ((x 2) (y 3) (z 4)) (display (+ x y)) (display (- z 4))
&hellip; (+ (* x y) (/ z x)))
508
</pre></td></tr></table>


<hr size="6">
<a name="Condicionales-de-Scheme"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#scheme-tutorial" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Tutorial de Scheme&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#interfaces-for-programmers" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces para programadores &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#return-values" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Valores de retorno&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#introduction-to-scheme" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Introducción a Scheme&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#if" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;if &gt; </a>]</td></tr></table>
<a name="scheme-conditionals"></a>
<h3 class="subsection">A.1.7 Condicionales de Scheme</h3>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#if" accesskey="1">if</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#cond" accesskey="2">cond</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr size="6">
<a name="if"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#scheme-tutorial" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Tutorial de Scheme&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#interfaces-for-programmers" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces para programadores &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#scheme-conditionals" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Condicionales de Scheme&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#scheme-conditionals" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Condicionales de Scheme&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#cond" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;cond &gt; </a>]</td></tr></table>
<a name="if"></a>
<h4 class="unnumberedsubsubsec">if</h4>

<p>Scheme tiene un procedimiento <code>if</code>:
</p>
<blockquote><pre class="example">(if expresión-de-prueba expresión-de-cierto expresión-de-falso)
</pre></blockquote>

<p><var>expresión-de-prueba</var> es una expresión que devuelve un valor
booleano.  Si <var>expresión-de-prueba</var> devuelve <code>#t</code>, el
procedimiento <code>if</code> devuelve el valor de la
<var>expresión-de-cierto</var>, en caso contrario devuelve el valor de
la <var>expresión-de-falso</var>.
</p>
<table><tr><td>&nbsp;</td><td><pre class="lisp">guile&gt; (define a 3)
guile&gt; (define b 5)
guile&gt; (if (&gt; a b) &quot;a es mayor que b&quot; &quot;a no es mayor que b&quot;)
&quot;a no es mayor que b&quot;
</pre></td></tr></table>


<hr size="6">
<a name="cond"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#scheme-tutorial" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Tutorial de Scheme&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#interfaces-for-programmers" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces para programadores &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#if" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; if&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#scheme-conditionals" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Condicionales de Scheme&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#scheme-in-lilypond" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Scheme dentro de LilyPond &gt; </a>]</td></tr></table>
<a name="cond"></a>
<h4 class="unnumberedsubsubsec">cond</h4>

<p>Otro procedimiento condicional en Scheme es <code>cond</code>:
</p>
<blockquote><pre class="example">(cond (expresión-de-prueba-1 secuencia-de-expresiones-resultante-1)
      (expresión-de-prueba-2 secuencia-de-expresiones-resultante-2)
      &hellip;
      (expresión-de-prueba-n secuencia-de-expresiones-resultante-n))
</pre></blockquote>

<p>Por ejemplo:
</p>
<table><tr><td>&nbsp;</td><td><pre class="lisp">guile&gt; (define a 6)
guile&gt; (define b 8)
guile&gt; (cond ((&lt; a b) &quot;a es menor que b&quot;)
...          ((= a b) &quot;a es igual a b&quot;)
...          ((&gt; a b) &quot;a es mayor que b&quot;))
&quot;a es menor que b&quot;
</pre></td></tr></table>

<hr size="6">
<a name="Scheme-dentro-de-LilyPond"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#scheme-tutorial" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Tutorial de Scheme&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#interfaces-for-programmers" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces para programadores &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#cond" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; cond&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#scheme-tutorial" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Tutorial de Scheme&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#lilypond-scheme-syntax" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Sintaxis del Scheme de LilyPond &gt; </a>]</td></tr></table>
<a name="scheme-in-lilypond"></a>
<h2 class="section">A.2 Scheme dentro de LilyPond</h2>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#lilypond-scheme-syntax" accesskey="1">A.2.1 Sintaxis del Scheme de LilyPond</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#lilypond-variables" accesskey="2">A.2.2 Variables de LilyPond</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#input-variables-and-scheme" accesskey="3">A.2.3 Variables de entrada y Scheme</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#importing-scheme-in-lilypond" accesskey="4">A.2.4 Importación de Scheme dentro de LilyPond</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#object-properties" accesskey="5">A.2.5 Propiedades de los objetos</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#lilypond-compound-variables" accesskey="6">A.2.6 Variables de LilyPond compuestas</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#internal-music-representation" accesskey="7">A.2.7 Representación interna de la música</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr size="6">
<a name="Sintaxis-del-Scheme-de-LilyPond"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#scheme-tutorial" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Tutorial de Scheme&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#interfaces-for-programmers" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces para programadores &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#scheme-in-lilypond" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Scheme dentro de LilyPond&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#scheme-in-lilypond" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Scheme dentro de LilyPond&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#lilypond-variables" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Variables de LilyPond &gt; </a>]</td></tr></table>
<a name="lilypond-scheme-syntax"></a>
<h3 class="subsection">A.2.1 Sintaxis del Scheme de LilyPond</h3>
<a name="index-_0024"></a>
<a name="index-_0024-1"></a>
<a name="index-_0023"></a>
<a name="index-_0023-1"></a>

<p>El intérprete Guile forma parte de LilyPond, lo que significa que
se puede incluir Scheme dentro de los archivos de entrada de
LilyPond.  Existen varios métodos para incluir Scheme dentro de
LilyPond.
</p>
<p>La manera más sencilla es utilizar el símbolo de
almohadilla&nbsp;<code>#</code> antes de una expresión de Scheme.
</p>
<p>Ahora bien, el código de entrada de LilyPond se estructura en
elementos y expresiones, de forma parecida a cómo el lenguaje
humano se estructura en palabras y frases.  LilyPond tiene un
analizador léxico que reconoce elementos indivisibles (números
literales, cadenas de texto, elementos de Scheme, nombres de nota,
etc.), y un analizador que entiende la sintaxis, la Gramática de
LilyPond (<a name="index-LilyPond-grammar"></a>
<a href="contributor-big-page.html#lilypond-grammar">LilyPond grammar</a>).  Una vez que sabe que se
aplica una regla sintáctica concreta, ejecuta las acciones
asociadas con ella.
</p>
<p>El método del símbolo de almohadilla&nbsp;<code>#</code> para incrustar
Scheme se adapta de forma natural a este sistema.  Una vez que el
analizador léxico ve un símbolo de almohadilla, llama al lector de
Scheme para que lea una expresión de Scheme completa (que puede
ser un identificador, una expresión encerrada entre paréntesis, o
algunas otras cosas).  Después de que se ha leído la expresión de
Scheme, se almacena como el valor de un elemento <code>SCM_TOKEN</code>
de la gramática.  Después de que el analizador sintáctico ya sabe
cómo hacer uso de este elemento, llama a Guila para que evalúe la
expresión de Scheme.  Dado que el analizador sintáctico suele
requerir un poco de lectura por delante por parte del analizador
léxico para tomar sus decisiones de análisis sintáctico, esta
separación de lectura y evaluación entre los analizadores léxico y
sintáctico es justamente lo que se necesita para mantener
sincronizadas las ejecuciones de expresiones de LilyPond y de
Scheme.  Por este motivo se debe usar el símbolo de
almohadilla&nbsp;<code>#</code> para llamar a Scheme siempre que sea
posible.
</p>
<p>Otra forma de llamar al intérprete de Scheme desde LilyPond es el
uso del símbolo de dólar&nbsp;<code>$</code> en lugar de la almohadilla
para introducir las expresiondes de Scheme.  En este caso,
LilyPond evalúa el código justo después de que el analizador
léxico lo ha leído.  Comprueba el tipo resultante de la expresión
de Scheme y después selecciona un tipo de elemento (uno de los
varios elementos <code>xxx_IDENTIFIER</code> dentro de la sintaxis) para
él.  Crea una <em>copia</em> del valor y la usa como valor del
elemento.  Si el valor de la expresión es vacío (El valor de Guile
de <code>*unspecified*</code>), no se pasa nada en absoluto al
analizador sintáctico.
</p>
<p>Éste es, de hecho, el mismo mecanismo exactamente que LilyPond
emplea cuando llamamos a cualquier variable o función musical por
su nombre, como <code>\nombre</code>, con la única diferencia de que el
nombre viene determinado por el analizador léxico de LilyPond sin
consultar al lector de Scheme, y así solamente se aceptan los
nombres de variable consistentes con el modo actual de LilyPond.
</p>
<p>La acción inmediata de <code>$</code> puede llevar a alguna que otra
sorpresa, véase <a href="#importing-scheme-in-lilypond">Importación de Scheme dentro de LilyPond</a>.
La utilización de <code>#</code> donde el analizador sintáctico lo
contempla es normalmente preferible.  Dentro de las expresiones
musicales, aquellas que se crean utilizando <code>#</code> <em>se
interprentan</em> como música.  Sin embargo, <em>no se copian</em> antes
de ser utilizadas.  Si forman parte de alguna estructura que aún
podría tener algún uso, quizá tenga que utilizar explícitamente
<code>ly:music-deep-copy</code>.
</p>
<a name="index-_0024_0040"></a>
<a name="index-_0024_0040-1"></a>
<a name="index-_0023_0040"></a>
<a name="index-_0023_0040-1"></a>
<p>También existen los operadores de &lsquo;división de listas&rsquo;
<code>$@</code> y <code>#@</code> que insertan todos los elementos de una
lista dentro del contexto circundante.
</p>
<p>Ahora echemos un vistazo a algo de código de Scheme real.  Los
procedimientos de Scheme se pueden definir dentro de los archivos
de entrada de LilyPond:
</p>
<blockquote><pre class="example">#(define (media a b c) (/ (+ a b c) 3))
</pre></blockquote>

<p>Observe que los comentarios de LilyPond (<code>%</code> y <code>%{
%}</code>) no se pueden utilizar dentro del código de Scheme, ni
siquiera dentro de un archivo de entrada de LilyPond, porque es el
intérprete Guile, y no el analizador léxico de LilyPond, el que
está leyendo la expresión de Scheme.  Los comentarios en el Scheme
de Guile se introducen como sigue:
</p>
<blockquote><pre class="example">; esto es un comentario de una línea

#!
  Esto es un comentario de bloque (no anidable) estilo Guile
  Pero se usan rara vez por parte de los Schemers
  y nunca dentro del código fuente de LilyPond
!#
</pre></blockquote>

<p>Durante el resto de esta sección, supondremos que los datos se
introducen en un archivo de música, por lo que añadiremos una
almohadilla&nbsp;<code>#</code> al principio de cada una de las
expresiones de Scheme.
</p>
<p>Todas las expresiones de Scheme del nivel jerárquico superior
dentro de un archivo de entrada de LilyPond se pueden combinar en
una sola expresión de Scheme mediante la utilización del operador
<code>begin</code>:
</p>
<blockquote><pre class="example">#(begin
  (define fulanito 0)
  (define menganito 1))
</pre></blockquote>


<hr size="6">
<a name="Variables-de-LilyPond"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#scheme-tutorial" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Tutorial de Scheme&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#interfaces-for-programmers" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces para programadores &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#lilypond-scheme-syntax" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Sintaxis del Scheme de LilyPond&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#scheme-in-lilypond" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Scheme dentro de LilyPond&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#input-variables-and-scheme" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Variables de entrada y Scheme &gt; </a>]</td></tr></table>
<a name="lilypond-variables"></a>
<h3 class="subsection">A.2.2 Variables de LilyPond</h3>

<p>Las variables de LilyPond se almacenan internamente en la forma de
variables de Scheme.  Así,
</p>
<blockquote><pre class="example">doce = 12
</pre></blockquote>

<p>equivale a
</p>
<blockquote><pre class="example">#(define doce 12)
</pre></blockquote>

<p>Esto significa que las variables de LilyPond están disponibles
para su uso dentro de expresiones de Scheme.  Por ejemplo,
podríamos usar
</p>
<blockquote><pre class="example">veintiCuatro = (* 2 doce)
</pre></blockquote>

<p>lo que daría lugar a que el número <em>24</em> se almacenase dentro
de la variable <code>veintiCuatro</code> de LilyPond (y de Scheme).
</p>
<p>El lenguaje Scheme permite la modificación de expresiones
complejas in situ y LilyPond hace uso de esta &lsquo;modificación in
situ&rsquo; al usar funciones musicales.  Pero cuando las expresiones
musicales se almacenan dentro de variables en lugar de ser
introducidas directamente, lo que habitualmente se espera cuando
se pasan a funciones musicales sería que el valor original quedase
intacto.  Así pues, cuando se referencia una variable musical con
la barra invertida (como <code>\veintiCuatro</code>), LilyPond crea una
copia del valor musical de tal variable para utilizarla dentro de
la expresión musical circundante, en lugar de usar el valor de la
variable directamente.
</p>
<p>Por ello, las expresiones musicales de Scheme escritas con la
sintasis de almohadilla <code>#</code> deberían utilizarse para
cualquier material creado &lsquo;partiendo de cero&rsquo; (o que se ha
copiado explícitamente) en lugar de utilizarse para referenciar
música directamente.
</p>
<a name="Vease-tambien-1"></a>
<h4 class="subsubheading">Véase también</h4>
<p>Manual de extensión:
<a href="#lilypond-scheme-syntax">Sintaxis del Scheme de LilyPond</a>.
</p>
<hr size="6">
<a name="Variables-de-entrada-y-Scheme"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#scheme-tutorial" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Tutorial de Scheme&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#interfaces-for-programmers" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces para programadores &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#lilypond-variables" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Variables de LilyPond&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#scheme-in-lilypond" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Scheme dentro de LilyPond&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#importing-scheme-in-lilypond" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Importación de Scheme dentro de LilyPond &gt; </a>]</td></tr></table>
<a name="input-variables-and-scheme"></a>
<h3 class="subsection">A.2.3 Variables de entrada y Scheme</h3>

<p>El formato de entrada contempla la noción de variables: en el
siguiente ejemplo, se asigna una expresión musical a una variable
con el nombre <code>traLaLa</code>.
</p>
<blockquote><pre class="example">traLaLa = { c'4 d'4 }
</pre></blockquote>


<p>También hay una forma de ámbito: en el ejemplo siguiente, el
bloque <code>\layout</code> también contiene una variable
<code>traLaLa</code>, que es independiente de la <code>\traLaLa</code>
externa.
</p>
<blockquote><pre class="example">traLaLa = { c'4 d'4 }
\layout { traLaLa = 1.0 }
</pre></blockquote>

<p>En efecto, cada archivo de entrada constituye un ámbito, y cada
bloque <code>\header</code>, <code>\midi</code> y <code>\layout</code> son ámbitos
anidados dentro del ámbito de nivel superior.
</p>
<p>Tanto las variables como los ámbitos están implementados en el
sistema de módulos de GUILE.  A cada ámbito se adjunta un módulo
anónimo de Scheme.  Una asignación de la forma:
</p>
<blockquote><pre class="example">traLaLa = { c'4 d'4 }
</pre></blockquote>

<p>se convierte internamente en una definición de Scheme:
</p>
<blockquote><pre class="example">(define traLaLa <var>Valor Scheme de `<code>&hellip;</code>'</var>)
</pre></blockquote>

<p>Esto significa que las variables de LilyPond y las variables de
Scheme se pueden mezclar con libertad.  En el ejemplo siguiente,
se almacena un fragmento de música en la variable <code>traLaLa</code>,
y se duplica usando Scheme.  El resultado se importa dentro de un
bloque <code>\score</code> por medio de una segunda variable
<code>twice</code>:
</p>
<pre class="verbatim">traLaLa = { c'4 d'4 }

#(define newLa (map ly:music-deep-copy
  (list traLaLa traLaLa)))
#(define twice
  (make-sequential-music newLa))

\twice
</pre><p>
 <a href="24/lily-4302bdaa.ly">
  <img align="middle"
       border="0"
       src="24/lily-4302bdaa.png"
       alt="[image of music]">
 </a>
</p>




<p>En realidad, éste es un ejemplo bastante interesante.  La
asignación solo tiene lugar después de que el analizador
sintáctico se ha asegurado de que no sigue nada parecido a
<code>\addlyrics</code>, de manera que necesita comprobar lo que viene a
continuación.  Lee el símbolo <code>#</code> y la expresión de Scheme
siguiente <em>sin</em> evaluarla, de forma que puede proceder a la
asignación, y <em>posteriormente</em> ejecutar el código de Scheme
sin problema.
</p>
<hr size="6">
<a name="Importaci_00f3n-de-Scheme-dentro-de-LilyPond"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#scheme-tutorial" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Tutorial de Scheme&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#interfaces-for-programmers" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces para programadores &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#input-variables-and-scheme" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Variables de entrada y Scheme&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#scheme-in-lilypond" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Scheme dentro de LilyPond&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#object-properties" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Propiedades de los objetos &gt; </a>]</td></tr></table>
<a name="importing-scheme-in-lilypond"></a>
<h3 class="subsection">A.2.4 Importación de Scheme dentro de LilyPond</h3>
<a name="index-_0024-2"></a>
<a name="index-_0024-3"></a>
<a name="index-_0023-2"></a>
<a name="index-_0023-3"></a>

<p>El ejemplo anterior muestra cómo &lsquo;exportar&rsquo; expresiones
musicales desde la entrada al intérprete de Scheme.  Lo contrario
también es posible.  Colocándolo después de <code>$</code>, un valor de
Scheme se interpreta como si hubiera sido introducido en la
sintaxis de LilyPond.  En lugar de definir <code>\twice</code>, el
ejemplo anterior podría también haberse escrito como
</p>
<blockquote><pre class="example">&hellip;
$(make-sequential-music newLa)
</pre></blockquote>

<p>Podemos utilizar <code>$</code> con una expresión de Scheme en cualquier
lugar en el que usaríamos <code>\<var>nombre</var></code> después de haber
asignado la expresión de Scheme a una variable <var>nombre</var>.  Esta
sustitución se produce dentro del &lsquo;analizador léxico&rsquo;, de manera
que LilyPond no llega a darse cuenta de la diferencia.
</p>
<p>Sin embargo, existe un inconveniente, el de la medida del tiempo.
Si hubiésemos estado usando <code>$</code> en vez de <code>#</code> para
definir <code>newLa</code> en el ejemplo anterior, la siguiente
definición de Scheme habría fracasado porque <code>traLaLa</code> no
habría sido definida aún.  Para ver una explicación de este
problema de momento temporal, véase <a href="#lilypond-scheme-syntax">Sintaxis del Scheme de LilyPond</a>.
</p>
<a name="index-_0024_0040-2"></a>
<a name="index-_0024_0040-3"></a>
<a name="index-_0023_0040-2"></a>
<a name="index-_0023_0040-3"></a>
<p>Un conveniente aspecto posterior pueden ser los operadores de
&lsquo;división de listas&rsquo; <code>$@</code> y <code>#@</code> para la inserción
de los elementos de una lista dentro del contexto circundante.
Utilizándolos, la última parte del ejemplo se podría haber escrito
como
</p>
<blockquote><pre class="example">&hellip;
{ #@newLa }
</pre></blockquote>

<p>Aquí, cada elemento de la lista que está almacenado en
<code>newLa</code> se toma en secuencia y se inserta en la lista, como
si hubiésemos escrito
</p>
<blockquote><pre class="example">{ #(first newLa) #(second newLa) }
</pre></blockquote>

<p>Ahora bien, en todas esas formas, el código de Scheme se evalúa en
el momento en que el código de entrada aún se está procesando, ya
sea en el analizador léxico o en el analizador sintáctico.  Si
necesitamos que se ejecute en un momento posterior, debemos
consultar <a href="#void-scheme-functions">Funciones de Scheme vacías</a>, o almacenarlo dentro
de un procedimiento:
</p>
<blockquote><pre class="example">#(define (nopc)
  (ly:set-option 'point-and-click #f))

&hellip;
#(nopc)
{ c'4 }
</pre></blockquote>

<a name="Advertencias-y-problemas-conocidos-1"></a>
<h4 class="subsubheading">Advertencias y problemas conocidos</h4>

<p>No es posible mezclar variables de Scheme y de LilyPond con la
opción &lsquo;<samp>--safe</samp>&rsquo;.
</p>

<hr size="6">
<a name="Propiedades-de-los-objetos"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#scheme-tutorial" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Tutorial de Scheme&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#interfaces-for-programmers" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces para programadores &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#importing-scheme-in-lilypond" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Importación de Scheme dentro de LilyPond&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#scheme-in-lilypond" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Scheme dentro de LilyPond&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#lilypond-compound-variables" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Variables de LilyPond compuestas &gt; </a>]</td></tr></table>
<a name="object-properties"></a>
<h3 class="subsection">A.2.5 Propiedades de los objetos</h3>

<p>Las propiedades de los objetos se almacenan en LilyPond en forma
de cadenas de listas-A, que son listas de listas-A.  Las
propiedades se establecen añadiendo valores al principio de la
lista de propiedades.  Las propiedades se leen extrayendo valores
de las listas-A.
</p>
<p>El establecimiento de un valor nuevo para una propiedad requiere
la asignación de un valor a la lista-A con una clave y un valor.
La sintaxis de LilyPond para hacer esto es la siguiente:
</p>
<blockquote><pre class="example">\override Stem.thickness = #2.6
</pre></blockquote>

<p>Esta instrucción ajusta el aspecto de las plicas.  Se añade una
entrada de lista-A <code>'(thickness . 2.6)</code> a la lista de
propiedades de un objeto <code>Stem</code>.  <code>thickness</code> se mide a
partir del grosor de las líneas del pentagrama, y así estas plicas
serán <code>2.6</code> veces el grosor de las líneas del pentagrama.
Esto hace que las plicas sean casi el doble de gruesas de lo
normal.  Para distinguir entre las variables que se definen en los
archivos de entrada (como <code>veintiCuatro</code> en el ejemplo
anterior) y las variables de los objetos internos, llamaremos a
las últimas &lsquo;propiedades&rsquo; y a las primeras &lsquo;variables.&rsquo;  Así,
el objeto plica tiene una propiedad <code>thickness</code> (grosor),
mientras que <code>veintiCuatro</code> es una variable.
</p>
<a name="index-propiedades-frente-a-variables"></a>
<a name="index-variables-frente-a-propiedades"></a>


<hr size="6">
<a name="Variables-de-LilyPond-compuestas"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#scheme-tutorial" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Tutorial de Scheme&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#interfaces-for-programmers" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces para programadores &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#object-properties" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Propiedades de los objetos&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#scheme-in-lilypond" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Scheme dentro de LilyPond&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#offsets" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Desplazamientos &gt; </a>]</td></tr></table>
<a name="lilypond-compound-variables"></a>
<h3 class="subsection">A.2.6 Variables de LilyPond compuestas</h3>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#offsets" accesskey="1">Desplazamientos</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#fracciones" accesskey="2">Fracciones</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#extents" accesskey="3">Dimensiones</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#property-alists" accesskey="4">Listas-A de propiedades</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#alist-chains" accesskey="5">Cadenas de listas-A</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>


<hr size="6">
<a name="Desplazamientos"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#scheme-tutorial" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Tutorial de Scheme&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#interfaces-for-programmers" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces para programadores &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#lilypond-compound-variables" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Variables de LilyPond compuestas&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#lilypond-compound-variables" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Variables de LilyPond compuestas&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#fracciones" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Fracciones &gt; </a>]</td></tr></table>
<a name="offsets"></a>
<h4 class="unnumberedsubsubsec">Desplazamientos</h4>

<p>Los desplazamientos bidimensionales (coordenadas X e Y) se
almacenan como <em>parejas</em>.  El <code>car</code> del desplazamiento
es la coordenada X, y el <code>cdr</code> es la coordenada Y.
</p>
<blockquote><pre class="example">\override TextScript.extra-offset = #'(1 . 2)
</pre></blockquote>

<p>Esto asigna la pareja <code>(1 . 2)</code> a la propiedad
<code>extra-offset</code> del objeto TextScript.  Estos números se miden
en espacios de pentagrama, y así esta instrucción mueve el objeto
un espacio de pentagrama a la derecha, y dos espacios hacia
arriba.
</p>
<p>Los procedimientos para trabajar con desplazamientos están en
&lsquo;<tt>scm/lily-library.scm</tt>&rsquo;.
</p>
<hr size="6">
<a name="Fracciones"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#scheme-tutorial" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Tutorial de Scheme&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#interfaces-for-programmers" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces para programadores &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#offsets" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Desplazamientos&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#lilypond-compound-variables" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Variables de LilyPond compuestas&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#extents" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Dimensiones &gt; </a>]</td></tr></table>
<a name="fracciones"></a>
<h4 class="unnumberedsubsubsec">Fracciones</h4>
<a name="Fractions"></a>
<h3 class="subheading">Fractions</h3>

<p>Las fracciones tal y como se utilizan por parte de LilyPond se
almacenan, de nuevo, como <em>parejas</em>, esta vez de enteros sin
signo.  Mientras que Scheme es capaz de representar números
racionaes como un tipo nativo, musicalmente &lsquo;<samp>2/4</samp>&rsquo; y
&lsquo;<samp>1/2</samp>&rsquo; no son lo mismo, y necesitamos poder distinguir entre
ellos.  De igual forma, no existe el concepto de &lsquo;fracciones&rsquo;
negativas en LilyPond.  Así pues, <code>2/4</code> en LilyPond significa
<code>(2 . 4)</code> en Scheme, y <code>#2/4</code> en LilyPond significa
<code>1/2</code> en Scheme.
</p>

<hr size="6">
<a name="Dimensiones"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#scheme-tutorial" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Tutorial de Scheme&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#interfaces-for-programmers" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces para programadores &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#fracciones" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Fracciones&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#lilypond-compound-variables" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Variables de LilyPond compuestas&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#property-alists" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Listas-A de propiedades &gt; </a>]</td></tr></table>
<a name="extents"></a>
<h4 class="unnumberedsubsubsec">Dimensiones</h4>

<p>Las parejas se usan también para almacenar intervalos, que
representan un rango de números desde el mínimo (el <code>car</code>)
hasta el máximo (el <code>cdr</code>).  Los intervalos se usan para
almacenar las dimensiones en X y en Y de los objetos imprimibles.
Para dimensiones en X, el <code>car</code> es la coordenada X de la
parte izquierda, y el <code>cdr</code> es la coordenada X de la parte
derecha.  Para las dimensiones en Y, el <code>car</code> es la
coordenada inferior, y el <code>cdr</code> es la coordenada superior.
</p>
<p>Los procedimientos para trabajar con intervalos están en
&lsquo;<tt>scm/lily-library.scm</tt>&rsquo;.  Se deben usar estos procedimientos
siempre que sea posible, para asegurar la consistencia del código.
</p>

<hr size="6">
<a name="Listas_002dA-de-propiedades"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#scheme-tutorial" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Tutorial de Scheme&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#interfaces-for-programmers" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces para programadores &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#extents" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Dimensiones&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#lilypond-compound-variables" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Variables de LilyPond compuestas&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#alist-chains" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Cadenas de listas-A &gt; </a>]</td></tr></table>
<a name="property-alists"></a>
<h4 class="unnumberedsubsubsec">Listas-A de propiedades</h4>

<p>Una lista-A de propiedades es una estructura de datos de LilyPond
que es una lista-A cuyas claves son propiedades y cuyos valores
son expresiones de Scheme que dan el valor deseado de la
propiedad.
</p>
<p>Las propiedades de LilyPond son símbolos de Scheme, como por
ejemplo <code>'thickness</code>.
</p>

<hr size="6">
<a name="Cadenas-de-listas_002dA"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#scheme-tutorial" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Tutorial de Scheme&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#interfaces-for-programmers" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces para programadores &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#property-alists" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Listas-A de propiedades&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#lilypond-compound-variables" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Variables de LilyPond compuestas&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#internal-music-representation" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Representación interna de la música &gt; </a>]</td></tr></table>
<a name="alist-chains"></a>
<h4 class="unnumberedsubsubsec">Cadenas de listas-A</h4>

<p>Una cadena de listas-A es una lista que contiene listas-A de
propiedades.
</p>
<p>El conjunto de todas las propiedades que se aplican a un grob se
almacena por lo general como una cadena de listas-A.  Para poder
encontrar el valor de una propiedad determinada que debería tener
un grob, se busca por todas las listas-A de la cadena, una a una,
tratando de encontrar una entrada que contenga la clave de la
propiedad.  Se devuelve la primera entrada de lista-A que se
encuentre, y el valor es el valor de la propiedad.
</p>
<p>El procedimiento de Scheme <code>chain-assoc-get</code> se usa
normalmente para obtener los valores de propiedades.
</p>
<hr size="6">
<a name="Representaci_00f3n-interna-de-la-m_00fasica"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#scheme-tutorial" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Tutorial de Scheme&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#interfaces-for-programmers" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces para programadores &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#alist-chains" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Cadenas de listas-A&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#scheme-in-lilypond" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Scheme dentro de LilyPond&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#building-complicated-functions" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Construir funciones complicadas &gt; </a>]</td></tr></table>
<a name="internal-music-representation"></a>
<h3 class="subsection">A.2.7 Representación interna de la música</h3>

<p>Internamente, la música se representa como una lista de Scheme.
La lista contiene varios elementos que afectan a la salida
impresa.  El análisis sintáctico es el proceso de convertir la
música de la representación de entrada de LilyPond a la
representación interna de Scheme.
</p>
<p>Cuando se analiza una expresión musical, se convierte en un
conjunto de objetos musicales de Scheme.  La propiedad definitoria
de un objeto musical es que ocupa un tiempo.  El tiempo que ocupa
se llama <em>duración</em>.  Las duraciones se expresan como un
número racional que mide la longitud del objeto musical en
redondas.
</p>
<p>Un objeto musical tiene tres clases de tipos:
</p><ul>
<li>
nombre musical: Cada expresión musical tiene un nombre.  Por
ejemplo, una nota lleva a un <a name="index-NoteEvent"></a>
<a href="internals-big-page.html#noteevent">NoteEvent</a>, y
<code>\simultaneous</code> lleva a una <a name="index-SimultaneousMusic"></a>
<a href="internals-big-page.html#simultaneousmusic">SimultaneousMusic</a>.
Hay una lista de todas las expresiones disponibles en el manual de
Referencia de funcionamiento interno, bajo el epígrafe
<a name="index-Music-expressions"></a>
<a href="internals-big-page.html#music-expressions">Music expressions</a>.

</li><li>
&lsquo;type&rsquo; (tipo) o interface: Cada nombre musical tiene varios
&lsquo;tipos&rsquo; o interfaces, por ejemplo, una nota es un <code>event</code>,
pero también es un <code>note-event</code>, un <code>rhythmic-event</code>, y
un <code>melodic-event</code>.  Todas las clases de música están
listadas en el manual de Referencia de funcionamiento interno,
bajo el epígrafe <a name="index-Music-classes"></a>
<a href="internals-big-page.html#music-classes">Music classes</a>.

</li><li>
objeto de C++: Cada objeto musical está representado por un objeto
de la clase <code>Music</code> de C++.
</li></ul>

<p>La información real de una expresión musical se almacena en
propiedades.  Por ejemplo, un <a name="index-NoteEvent-1"></a>
<a href="internals-big-page.html#noteevent">NoteEvent</a> tiene
propiedades <code>pitch</code> y <code>duration</code> que almacenan la altura
y la duración de esa nota.  Hay una lista de todas la propiedades
disponibles en el manual de Referencia de funcionamiento interno,
bajo el epígrafe <a name="index-Music-properties"></a>
<a href="internals-big-page.html#propiedades-musicales">Music properties</a>.
</p>
<p>Una expresión musical compuesta es un objeto musical que contiene
otros objetos musicales dentro de sus propiedades.  Se puede
almacenar una lista de objetos dentro de la propiedad
<code>elements</code> de un objeto musical, o un único objeto musical
&lsquo;hijo&rsquo; dentro de la propiedad <code>element</code>.  Por ejemplo,
<a name="index-SequentialMusic"></a>
<a href="internals-big-page.html#sequentialmusic">SequentialMusic</a> tiene su hijo dentro de
<code>elements</code>, y <a name="index-GraceMusic"></a>
<a href="internals-big-page.html#gracemusic">GraceMusic</a> tiene su argumento
único dentro de <code>element</code>.  El cuerpo de una repetición se
almacena dentro de la propiedad <code>element</code> de
<a name="index-RepeatedMusic"></a>
<a href="internals-big-page.html#repeatedmusic">RepeatedMusic</a>, y las alternativas dentro de
<code>elements</code>.
</p>
<hr size="6">
<a name="Construir-funciones-complicadas"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#scheme-tutorial" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Tutorial de Scheme&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#interfaces-for-programmers" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces para programadores &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#internal-music-representation" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Representación interna de la música&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#scheme-tutorial" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Tutorial de Scheme&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#displaying-music-expressions" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Presentación de las expresiones musicales &gt; </a>]</td></tr></table>
<a name="building-complicated-functions"></a>
<h2 class="section">A.3 Construir funciones complicadas</h2>

<p>Esta sección explica cómo reunir la información necesaria para
crear funciones musicales complicadas.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#displaying-music-expressions" accesskey="1">A.3.1 Presentación de las expresiones musicales</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#music-properties" accesskey="2">A.3.2 Propiedades musicales</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#doubling-a-note-with-slurs-_0028example_0029" accesskey="3">A.3.3 Duplicar una nota con ligaduras (ejemplo)</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#adding-articulation-to-notes-_0028example_0029" accesskey="4">A.3.4 Añadir articulaciones a las notas (ejemplo)</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>


<hr size="6">
<a name="Presentaci_00f3n-de-las-expresiones-musicales"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#scheme-tutorial" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Tutorial de Scheme&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#interfaces-for-programmers" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces para programadores &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#building-complicated-functions" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Construir funciones complicadas&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#building-complicated-functions" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Construir funciones complicadas&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#music-properties" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Propiedades musicales &gt; </a>]</td></tr></table>
<a name="displaying-music-expressions"></a>
<h3 class="subsection">A.3.1 Presentación de las expresiones musicales</h3>

<a name="index-almacenamiento-interno"></a>
<a name="index-imprimir-expresiones-musicales"></a>
<a name="index-representacion-interna_002c-impresion-de"></a>
<a name="index-displayMusic"></a>
<a name="index-_005cdisplayMusic"></a>
<a name="index-_005cdisplayMusic-1"></a>

<p>Si se está escribiendo una función musical, puede ser muy
instructivo examinar cómo se almacena internamente una expresión
musical.  Esto se puede hacer con la función musical
<code>\displayMusic</code>.
</p>
<blockquote><pre class="example">{
  \displayMusic { c'4\f }
}
</pre></blockquote>

<p>imprime lo siguiente:
</p>
<blockquote><pre class="example">(make-music
  'SequentialMusic
  'elements
  (list (make-music
          'NoteEvent
          'articulations
          (list (make-music
                  'AbsoluteDynamicEvent
                  'text
                  &quot;f&quot;))
          'duration
          (ly:make-duration 2 0 1/1)
          'pitch
          (ly:make-pitch 0 0 0))))
</pre></blockquote>

<p>De forma predeterminada, LilyPond imprime estos mensajes sobre la
consola junto al resto de los mensajes.  Para separar estos
mensajes y guardar el resultado de <code>\display{LOQUESEA}</code>,
puede especificar que se use un puerto de salida opcional:
</p>
<blockquote><pre class="example">{
  \displayMusic #(open-output-file &quot;display.txt&quot;) { c'4\f }
}
</pre></blockquote>

<p>Esto sobreescribe el archivo de salida anterior cada vez ques e
llama; si necesitamos escribir más de una expresión, debemos usar
una variable para el puerto y reutilizarla:
</p><blockquote><pre class="example">{
  port = #(open-output-file &quot;display.txt&quot;)
  \displayMusic \port { c'4\f }
  \displayMusic \port { d'4 }
  #(close-output-port port)
}
</pre></blockquote>

<p>El manual de Guile describe los puertos detalladamente.  Solo es
realmente necesario cerrar el puerto si necesitamos leer el
archivo antes de que LilyPond termine; en el primer ejemplo, no
nos hemos molestado en hacerlo.
</p>
<p>Un poco de reformateo hace a la información anterior más fácil de
leer:
</p>
<blockquote><pre class="example">(make-music 'SequentialMusic
  'elements (list
	     (make-music 'NoteEvent
               'articulations (list
			       (make-music 'AbsoluteDynamicEvent
				 'text
				 &quot;f&quot;))
	       'duration (ly:make-duration 2 0 1/1)
	       'pitch    (ly:make-pitch 0 0 0))))
</pre></blockquote>

<p>Una secuencia musical <code>{ &hellip; }</code> tiene el nombre
<code>SequentialMusic</code>, y sus expresiones internas se almacenan
coma una lista dentro de su propiedad <code>'elements</code>.  Una nota
se representa como un objeto <code>NoteEvent</code> (que almacena las
propiedades de duración y altura) con información adjunta (en este
caso, un evento <code>AbsoluteDynamicEvent</code> con una propiedad
<code>&quot;f&quot;</code> de texto) almacenada en su propiedad
<code>articulations</code>.
</p>
<a name="index-void"></a>
<a name="index-void-1"></a>

<p><code>\displayMusic</code> devuelve la música que imprime en la consola,
y por ello se interpretará al tiempo que se imprime en la consola.
Para evitar la interpretación, escriba <code>\void</code> antes de
<code>\displayMusic</code>.
</p>
<hr size="6">
<a name="Propiedades-musicales"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#scheme-tutorial" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Tutorial de Scheme&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#interfaces-for-programmers" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces para programadores &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#displaying-music-expressions" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Presentación de las expresiones musicales&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#building-complicated-functions" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Construir funciones complicadas&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#doubling-a-note-with-slurs-_0028example_0029" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Duplicar una nota con ligaduras (ejemplo) &gt; </a>]</td></tr></table>
<a name="music-properties"></a>
<h3 class="subsection">A.3.2 Propiedades musicales</h3>


<p>Veamos un ejemplo:
</p>
<blockquote><pre class="example">someNote = c'
\displayMusic \someNote
===&gt;
(make-music
  'NoteEvent
  'duration
  (ly:make-duration 2 0 1/1)
  'pitch
  (ly:make-pitch 0 0 0))
</pre></blockquote>

<p>El objeto <code>NoteEvent</code> es la representación de
<code>someNote</code>.  Sencillo.  ¿Y si ponemos el c&rsquo; dentro de un
acorde?
</p>
<blockquote><pre class="example">someNote = &lt;c'&gt;
\displayMusic \someNote
===&gt;
(make-music
  'EventChord
  'elements
  (list (make-music
          'NoteEvent
          'duration
          (ly:make-duration 2 0 1/1)
          'pitch
          (ly:make-pitch 0 0 0))))
</pre></blockquote>

<p>Ahora el objeto <code>NoteEvent</code> es el primer objeto de la
propiedad <code>'elements</code> de <code>someNote</code>.
</p>
<p>La función <code>display-scheme-music</code> es la función que se usa
por parte de <code>\displayMusic</code> para imprimir la representación
de Scheme de una expresión musical.
</p>
<blockquote><pre class="example">#(display-scheme-music (first (ly:music-property someNote 'elements)))
===&gt;
(make-music
  'NoteEvent
  'duration
  (ly:make-duration 2 0 1/1)
  'pitch
  (ly:make-pitch 0 0 0))
</pre></blockquote>

<p>Después se accede a la altura de la nota a través de la propiedad
<code>'pitch</code> del objeto <code>NoteEvent</code>:
</p>
<blockquote><pre class="example">#(display-scheme-music
   (ly:music-property (first (ly:music-property someNote 'elements))
                      'pitch))
===&gt;
(ly:make-pitch 0 0 0)
</pre></blockquote>

<p>La altura de la nota se puede cambiar estableciendo el valor de
esta propiedad <code>'pitch</code>.
</p>
<a name="index-_005cdisplayLilyMusic"></a>
<a name="index-_005cdisplayLilyMusic-1"></a>

<blockquote><pre class="example">#(set! (ly:music-property (first (ly:music-property someNote 'elements))
                          'pitch)
       (ly:make-pitch 0 1 0)) ;; establecer la altura a d'.
\displayLilyMusic \someNote
===&gt;
d'4
</pre></blockquote>


<hr size="6">
<a name="Duplicar-una-nota-con-ligaduras-_0028ejemplo_0029"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#scheme-tutorial" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Tutorial de Scheme&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#interfaces-for-programmers" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces para programadores &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#music-properties" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Propiedades musicales&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#building-complicated-functions" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Construir funciones complicadas&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#adding-articulation-to-notes-_0028example_0029" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Añadir articulaciones a las notas (ejemplo) &gt; </a>]</td></tr></table>
<a name="doubling-a-note-with-slurs-_0028example_0029"></a>
<h3 class="subsection">A.3.3 Duplicar una nota con ligaduras (ejemplo)</h3>

<p>Supongamos que queremos crear una función que convierte una
entrada como <code>a</code> en <code>{ a( a) }</code>.  Comenzamos
examinando la representación interna de la música con la que
queremos terminar.
</p>
<blockquote><pre class="example">\displayMusic{ a'( a') }
===&gt;
(make-music
  'SequentialMusic
  'elements
  (list (make-music
          'NoteEvent
          'articulations
          (list (make-music
                  'SlurEvent
                  'span-direction
                  -1))
          'duration
          (ly:make-duration 2 0 1/1)
          'pitch
          (ly:make-pitch 0 5 0))
        (make-music
          'NoteEvent
          'articulations
          (list (make-music
                  'SlurEvent
                  'span-direction
                  1))
          'duration
          (ly:make-duration 2 0 1/1)
          'pitch
          (ly:make-pitch 0 5 0))))
</pre></blockquote>

<p>La mala noticia es que las expresiones <code>SlurEvent</code> se deben
añadir &lsquo;dentro&rsquo; de la nota (dentro de la propiedad
<code>articulations</code>).
</p>
<p>Ahora examinamos la entrada.
</p>
<blockquote><pre class="example">\displayMusic a'
===&gt;
(make-music
  'NoteEvent
  'duration
  (ly:make-duration 2 0 1/1)
  'pitch
  (ly:make-pitch 0 5 0))))
</pre></blockquote>

<p>Así pues, en nuestra función, tenemos que clonar esta expresión
(de forma que tengamos dos notas para construir la secuencia),
añadir <code>SlurEvent</code> a la propiedad <code>'articulations</code> de
cada una de ellas, y por último hacer una secuencia
<code>SequentialMusic</code> con los dos elementos <code>NoteEvent</code>.
Para añadir a una propiedad, es útil saber que una propiedad no
establecida se lee como <code>'()</code>, la lista vacía, así que no se
requiere ninguna comprobación especial antes de que pongamos otro
elemento delante de la propiedad <code>articulations</code>.
</p>

<blockquote><pre class="example">doubleSlur = #(define-music-function (note) (ly:music?)
         &quot;Return: { note ( note ) }.
         `note' is supposed to be a single note.&quot;
         (let ((note2 (ly:music-deep-copy note)))
           (set! (ly:music-property note 'articulations)
                 (cons (make-music 'SlurEvent 'span-direction -1)
                       (ly:music-property note 'articulations)))
           (set! (ly:music-property note2 'articulations)
                 (cons (make-music 'SlurEvent 'span-direction 1)
                       (ly:music-property note2 'articulations)))
           (make-music 'SequentialMusic 'elements (list note note2))))
</pre></blockquote>


<hr size="6">
<a name="A_00f1adir-articulaciones-a-las-notas-_0028ejemplo_0029"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#scheme-tutorial" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Tutorial de Scheme&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#interfaces-for-programmers" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces para programadores &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#doubling-a-note-with-slurs-_0028example_0029" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Duplicar una nota con ligaduras (ejemplo)&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#building-complicated-functions" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Construir funciones complicadas&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#interfaces-for-programmers" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Interfaces para programadores &gt; </a>]</td></tr></table>
<a name="adding-articulation-to-notes-_0028example_0029"></a>
<h3 class="subsection">A.3.4 Añadir articulaciones a las notas (ejemplo)</h3>

<p>La manera fácil de añadir articulación a las notas es mezclar dos
expresiones musicales en un solo contexto.  Sin embargo,
supongamos que queremos escribir una función musical que lo haga.
Esto tiene la ventaja adicional de que podemos usar esa función
musical para añadir una articulación (como una instrucción de
digitación) a una nota única dentro de un acorde, lo cual no es
posible si nos limitamos a mezclar fragmentos de música
independientes.
</p>
<p>Una <code>$variable</code> dentro de la notación <code>#{&hellip;#}</code> es
como una <code>\variable</code> normal en la notación clásica de
LilyPond.  Sabemos que
</p>
<blockquote><pre class="example">{ \music -. -&gt; }
</pre></blockquote>

<p>no funciona en LilyPond.  Podríamos evitar este problema
adjuntando la articulación a un acorde vacío,
</p>
<blockquote><pre class="example">{ &lt;&lt; \music &lt;&gt; -. -&gt; &gt;&gt; }
</pre></blockquote>

<p>pero a los efectos de este ejemplo, aprenderemos ahora cómo
hacerlo en Scheme.  Empezamos examinando nuestra entrada y la
salida deseada.
</p>
<blockquote><pre class="example">%  input
\displayMusic c4
===&gt;
(make-music
  'NoteEvent
  'duration
  (ly:make-duration 2 0 1/1)
  'pitch
  (ly:make-pitch -1 0 0))))
=====
%  desired output
\displayMusic c4-&gt;
===&gt;
(make-music
  'NoteEvent
  'articulations
  (list (make-music
          'ArticulationEvent
          'articulation-type
          &quot;accent&quot;))
  'duration
  (ly:make-duration 2 0 1/1)
  'pitch
  (ly:make-pitch -1 0 0))
</pre></blockquote>

<p>Vemos que una nota (<code>c4</code>) se representa como una expresión
<code>NoteEvent</code>.  Para añadir una articulación de acento, se debe
añadir una expresión <code>ArticulationEvent</code> a la propiedad
<code>articulations</code> de la expresión <code>NoteEvent</code>.
</p>
<p>Para construir esta función, empezamos con
</p>
<blockquote><pre class="example">(define (add-accent note-event)
  &quot;Add an accent ArticulationEvent to the articulations of `note-event',
  which is supposed to be a NoteEvent expression.&quot;
  (set! (ly:music-property note-event 'articulations)
        (cons (make-music 'ArticulationEvent
                'articulation-type &quot;accent&quot;)
              (ly:music-property note-event 'articulations)))
  note-event)
</pre></blockquote>

<p>La primera línea es la forma de definir una función en Scheme: el
nombre de la función es <code>add-accent</code>, y tiene una variable
llamada <code>note-event</code>.  En Scheme, el tipo de variable suele
quedar claro a partir de su nombre (¡esto también es una buena
práctica en otros lenguajes de programación!)
</p>
<blockquote><pre class="example">&quot;Add an accent&hellip;&quot;
</pre></blockquote>

<p>es una descripción de lo que hace la función.  No es estrictamente
necesaria, pero de igual forma que los nombres claros de variable,
es una buena práctica.
</p>
<p>Se preguntará por qué modificamos el evento de nota directamente
en lugar de trabajar sobre una copia (se puede usar
<code>ly:music-deep-copy</code> para ello).  La razón es un contrato
silencioso: se permite que las funciones musicales modifiquen sus
argumentos; o bien se generan partiendo de cero (como la entrada
del usuario) o están ya copiadas (referenciar una variable de
música con &lsquo;<samp>\name</samp>&rsquo; o la música procedente de expresiones de
Scheme inmediatas &lsquo;<samp>$(&hellip;)</samp>&rsquo; proporcionan una copia).  Dado
que sería ineficiente crear copias innecesarias, el valor devuelto
de una función musical <em>no</em> se copia.  Así pues, para cumplir
dicho contrato, no debemos usar ningún argumento más de una vez, y
devolverlo cuenta como una vez.
</p>
<p>En un ejemplo anterior, hemos construido música mediante la
repetición de un argumento musical dado.  En tal caso, al menos
una repetidión tuvo que ser una copia de sí misma.  Si no lo
fuese, podrían ocurrir cosas muy extrañas.  Por ejemplo, si usamos
<code>\relative</code> o <code>\transpose</code> sobre la música resultante
que contiene los mismos elementos varias veces, estarían sujetos
varias veces a la relativización o al transporte.  Si los
asignamos a una variable de música, se rompe el curso porque hacer
referencia a &lsquo;<samp>\name</samp>&rsquo; creará de nuevo una copia que no retiene
la identidad de los elementos repetidos.
</p>
<p>Ahora bien, aun cuando la función anterior no es una función
musical, se usará normalmente dentro de funciones musicales.  Así
pues, tiene sentido obedecer el mismo convenio que usamos para las
funciones musicales: la entrada puede modificarse para producir la
salida, y el código que llama es responsable de crear las copias
si aún necesita el propio argumento sin modificar.  Si observamos
las propias funciones de LilyPond como <code>music-map</code>, veremos
que se atienen a los mismos principios.
</p>
<p>¿En qué punto nos encontramos?  Ahora tenemos un <code>note-event</code>
que podemos modificar, no a causa de la utilización de
<code>ly:music-deep-copy</code> sino por una explicación muy
desarrollada.  Añadimos el acento a su propiedad de lista
<code>'articulations</code>.
</p>
<blockquote><pre class="example">(set! place new-value)
</pre></blockquote>

<p>Aquí, lo que queremos establecer (el &lsquo;place&rsquo;) es la propiedad
<code>'articulations</code> de la expresión <code>note-event</code>.
</p>
<blockquote><pre class="example">(ly:music-property note-event 'articulations)
</pre></blockquote>

<p><code>ly:music-property</code> es la función ustilizada para acceder a las
propiedades musicales (las <code>'articulations</code>, <code>'duration</code>,
<code>'pitch</code>, etc, que vemos arriba en la salida de
<code>\displayMusic</code>).  El nuevo valor es la antigua propiedad
<code>'articulations</code>, con un elemento adicional: la expresión
<code>ArticulationEvent</code>, que copiamos a partir de la salida de
<code>\displayMusic</code>,
</p>
<blockquote><pre class="example">(cons (make-music 'ArticulationEvent
        'articulation-type &quot;accent&quot;)
      (ly:music-property result-event-chord 'articulations))
</pre></blockquote>

<p>Se usa <code>cons</code> para añadir un elemento a la parte delantera de
una lista sin modificar la lista original.  Esto es lo que
queremos: la misma lista de antes, más la nueva expresión
<code>ArticulationEvent</code>.  El orden dentro de la propiedad
<code>'articulations</code> no tiene importancia aquí.
</p>
<p>Finalmente, una vez hemos añadido la articulación de acento a su
propiedad <code>articulations</code>, podemos devolver
<code>note-event</code>, de aquí la última línea de la función.
</p>
<p>Ahora transformamos la función <code>add-accent</code> en una función
musical (es cuestión de un poco de aderezo sintáctico y una
declaración del tipo de su argumento).
</p>
<blockquote><pre class="example">addAccent = #(define-music-function (note-event)
                                     (ly:music?)
  &quot;Add an accent ArticulationEvent to the articulations of `note-event',
  which is supposed to be a NoteEvent expression.&quot;
  (set! (ly:music-property note-event 'articulations)
        (cons (make-music 'ArticulationEvent
                'articulation-type &quot;accent&quot;)
              (ly:music-property note-event 'articulations)))
  note-event)
</pre></blockquote>

<p>A continuación verificamos que esta función musical funciona
correctamente:
</p>
<blockquote><pre class="example">\displayMusic \addAccent c4
</pre></blockquote>






<hr size="6">
<a name="Interfaces-para-programadores"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#scheme-tutorial" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Tutorial de Scheme&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#lilypond-scheme-interfaces" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces de Scheme de LilyPond &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#adding-articulation-to-notes-_0028example_0029" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Añadir articulaciones a las notas (ejemplo)&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#index" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Top&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#lilypond-code-blocks" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Bloques de código de LilyPond &gt; </a>]</td></tr></table>
<a name="interfaces-for-programmers"></a>
<h1 class="chapter">B. Interfaces para programadores</h1>

<p>Se pueden realizar trucos avanzados mediante el uso de Scheme.
Si no está familiarizado con Scheme, le conviene leer nuestro
tutorial de Scheme, <a href="#scheme-tutorial">Tutorial de Scheme</a>.
</p>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#lilypond-code-blocks" accesskey="1">B.1 Bloques de código de LilyPond</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#scheme-functions" accesskey="2">B.2 Funciones de Scheme</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#music-functions" accesskey="3">B.3 Funciones musicales</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#event-functions" accesskey="4">B.4 Funciones de eventos</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#markup-functions" accesskey="5">B.5 Funciones de marcado</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#contexts-for-programmers" accesskey="6">B.6 Contextos para programadores</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#callback-functions" accesskey="7">B.7 Funciones de callback</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#difficult-tweaks" accesskey="8">B.8 Trucos difíciles</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr size="6">
<a name="Bloques-de-c_00f3digo-de-LilyPond"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#interfaces-for-programmers" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Interfaces para programadores&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#lilypond-scheme-interfaces" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces de Scheme de LilyPond &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#interfaces-for-programmers" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Interfaces para programadores&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#interfaces-for-programmers" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Interfaces para programadores&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#scheme-functions" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Funciones de Scheme &gt; </a>]</td></tr></table>
<a name="lilypond-code-blocks"></a>
<h2 class="section">B.1 Bloques de código de LilyPond</h2>

<a name="index-Bloques-de-codigo-de-LilyPond"></a>
<a name="index-LilyPond_002c-bloques-de-codigo-de"></a>
<a name="index-_0023_007b-_2026-_0023_007d"></a>
<a name="index-_0023_007b-_2026-_0023_007d-1"></a>
<a name="index-_0024-4"></a>
<a name="index-_0024-5"></a>
<a name="index-_0023-4"></a>
<a name="index-_0023-5"></a>

<p>La creación de expresiones musicales en Scheme puede ser una
tarea tediosa porque a veces presentan muchos niveles de
profundidad de anidamiento y el código resultante es grande.
Para algunas tareas sencillas, esto puede evitarse utilizando
bloques de código de LilyPond, que permiten usar la sintaxis
ordinaria de LilyPond dentro de Scheme.
</p>
<p>Los bloques de código de LilyPond tienen el siguiente aspecto:
</p><blockquote><pre class="example">  #{ <var>código de LilyPond</var> #}
</pre></blockquote>

<p>He aquí un ejemplo trivial:
</p>
<blockquote><pre class="verbatim">ritpp = #(define-event-function () ()
  #{ ^&quot;rit.&quot; \pp #}
)

{ c'4 e'4\ritpp g'2 }
</pre><p>
 <a href="f3/lily-a1c2820d.ly">
  <img align="middle"
       border="0"
       src="f3/lily-a1c2820d.png"
       alt="[image of music]">
 </a>
</p>
</blockquote>



<p>Los bloques de código de LilyPond se pueden usar en cualquier
lugar en el que se pueda escribir código de Scheme.  El lector de
Scheme en efecto se modifica para que pueda incorporar bloques de
código de LilyPond y pueda ocuparse de las expresiones de Scheme
incrustadas que comienzan por <code>$</code> y <code>#</code>.
</p>
<p>El lector extrae el bloque de código de LilyPond y genera una
llamada en tiempo de ejecución al analizador sintáctico para que
interprete el código de LilyPond.  Las expresiones de Scheme
incrustadas en el código de LilyPond se evalúan dentro del
entorno lóexico del bloque de código de LilyPond, de manera que
puede accederse a todas las variables locales y los parámetros de
función que están disponibles en el punto en que se escribe el
bloque de código de LilyPond.  Las variables definidas en otros
módulos de Scheme, como los módulos que contienen bloques
<code>\header</code> y <code>\layout</code>, no están accesibles como
variables de Scheme, es decir, precedidas de&nbsp;<code>#</code>, pero
se puede acceder a ellas como variables de LilyPond, es decir,
precedidas de&nbsp;<code>\</code>.
</p>
<p>Toda la música generada dentro del bloque de código tiene su
&lsquo;<samp>origin</samp>&rsquo; establecido a la localización actual del puntero de
entrada.
</p>
<p>Un bloque de código de LilyPond puede contener cualquier cosa que
podríamos utilizar en la parte derecha de una asignación.
Además, un bloque de LilyPond vacío corresponde a una expresión
musical vacía, y un bloque de LilyPond que contiene varios
eventos musicales se convierte en una expresión de música
secuencial.
</p>
<hr size="6">
<a name="Funciones-de-Scheme"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#interfaces-for-programmers" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Interfaces para programadores&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#lilypond-scheme-interfaces" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces de Scheme de LilyPond &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#lilypond-code-blocks" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Bloques de código de LilyPond&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#interfaces-for-programmers" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Interfaces para programadores&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#scheme-function-definitions" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Definición de funciones de Scheme &gt; </a>]</td></tr></table>
<a name="scheme-functions"></a>
<h2 class="section">B.2 Funciones de Scheme</h2>
<a name="index-Scheme_002c-funciones-de-_0028sintaxis-de-LilyPond_0029"></a>

<p>Las <em>funciones de Scheme</em> son procedimientos de Scheme que
pueden crear expresiones de Scheme a partir de código de entrada
escrito en la sintaxis de LilyPond.  Se pueden llamar desde
prácticamente cualquier lugar en el que se permita el uso de
<code>#</code> para la especificación de un valor en sintaxis de
Scheme.  Mientras que Scheme tiene funciones propias, este
capítulo se ocupa de las funciones <em>sintácticas</em>, funciones
que reciben argumentos especificados en la sintaxis de LilyPond.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#scheme-function-definitions" accesskey="1">B.2.1 Definición de funciones de Scheme</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#scheme-function-usage" accesskey="2">B.2.2 Uso de las funciones de Scheme</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#void-scheme-functions" accesskey="3">B.2.3 Funciones de Scheme vacías</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr size="6">
<a name="Definici_00f3n-de-funciones-de-Scheme"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#interfaces-for-programmers" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Interfaces para programadores&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#lilypond-scheme-interfaces" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces de Scheme de LilyPond &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#scheme-functions" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Funciones de Scheme&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#scheme-functions" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Funciones de Scheme&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#scheme-function-usage" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Uso de las funciones de Scheme &gt; </a>]</td></tr></table>
<a name="scheme-function-definitions"></a>
<h3 class="subsection">B.2.1 Definición de funciones de Scheme</h3>
<a name="index-define_002dscheme_002dfunction"></a>
<a name="index-define_002dscheme_002dfunction-1"></a>

<p>La forma general de la definición de una función de Scheme es:
</p>
<blockquote><pre class="example">funcion =
#(define-scheme-function
     (<var>arg1</var> <var>arg2</var> &hellip;)
     (<var>tipo1?</var> <var>tipo2?</var> &hellip;)
   <var>cuerpo</var>)
</pre></blockquote>

<p>donde
</p>
<table>
<tr><td width="33%"><code><var>argN</var></code></td><td width="66%"><var>n</var>-ésimo argumento.</td></tr>
<tr><td width="33%"><code><var>typeN?</var></code></td><td width="66%">Un <em>predicado de tipo</em> de Scheme para el que <code><var>argN</var></code>
debe devolver <code>#t</code>.  También existe una forma especial
<code>(<em>predicate?</em>  <em>default</em>)</code> para especificar
argumentos opcionales.  Si el argumento actual no está presente
cuando se ll ama a la función, el valor predeterminado se emplea
en sustitución.  Los valores predeterminados se evalúan en tiempo
de definición (¡incluyendo los bloques de código de LilyPond!),
de manera que se necesitamos un valor por omisión calculado en
tiempo de ejecución, debemos escribir en su lugar un valor
especial que podamos reconocer fácilmente.  Si escribimos el
predicado entre paréntesis pero no lo seguimos por el valor
predeterminado, se usa <code>#f</code> como valor por omisión.  Los
valores por omisión no se verifican con <em>predicate?</em> en
tiempo de definición ni en tiempo de ejecución: es nuestra
responsabilidad tratar con los valores que especifiquemos.  Los
valores por omisión que son expresiones musicales se copian
mientras se establece <code>origin</code> a la ubicación actual del
cursor de entrada.</td></tr>
<tr><td width="33%"><code><var>cuerpo</var></code></td><td width="66%">una secuencia de formas de Scheme que se evalúan ordenadamente; la
última forma de la secuencia se usa como el valor de retorno de
la función de Scheme. Puede contener bloques de código de
LilyPond encerrados entre llaves con almohadillas
(&nbsp;<code>#{&hellip;#}</code>&nbsp;), como se describe en
<a href="#lilypond-code-blocks">Bloques de código de LilyPond</a>.  Dentro de los bloques de
código de LilyPond, use el símbolo <code>#</code> para hacer referencia
a argumentos de función (p.ej. &lsquo;<samp>#arg1</samp>&rsquo;) o para iniciar una
expresión en línea de Scheme que contenga argumentos de función
(p.ej. &lsquo;<samp>#(cons arg1 arg2)</samp>&rsquo;).  Donde las expresiones de
Scheme normales que usan <code>#</code> no funcionan, podríamos
necesitar volver a expresiones de Scheme inmediatas que usan
<code>$</code>, como por ejemplo &lsquo;<samp>$music</samp>&rsquo;.

Si nuestra función devuelve una expresión musical, recibe un
valor <code>origin</code> útil.</td></tr>
</table>

<p>La idoneidad de los argumentos para los predicados viene
determinada mediante llamadas reales al predicado después de que
LilyPond ya las ha convertido en una expresión de Scheme.  Como
consecuencia, el argumento se puede especificar en la sintaxis de
Scheme si se desea (precedido de <code>#</code> o como resultado de
haber llamado a una función de Scheme), pero LilyPond también
convierte algunas construcciones de LilyPond en Scheme antes de
hacer efectivamente la comprobación del predicado sobre ellas.
Actualmente se encuentran entre ellas la música, los
post-eventos, las cadenas simples (entrecomilladas o no), los
números, los elementos de marcado y de listas de marcado, score
(partitura), book (libro), bookpart (parte de libro), las
definiciones de contexto y los bloques de definición de salida.
</p>
<p>LilyPond resuelve algunas ambigüedades mediante la comprobación
con funciones de predicado: ¿es &lsquo;<samp>-3</samp>&rsquo; un post-evento de
digitación o un número negativo?  ¿Es <code>&quot;a&quot; 4</code> en el modo de
letra una cadena seguida por un número, o un evento de letra con
la duración <code>4</code>?  LilyPond prueba el predicado del argumento
sobre diversas interpretaciones sucesivas hasta que lo consigue,
con un orden diseñado para minimizar las interpretaciones poco
consistentes y la lectura por adelantado.
</p>
<p>Por ejemplo, un predicado que acepta tanto expresiones musicales
como alturas consideraría que <code>c''</code> es una altura en lugar
de una expresión musical.  Las duraciones o post-eventos que
siguen inmediatamente, cambian dicha interpretación.  Es mejor
evitar los predicados excesivamente permisivos como
<code>scheme?</code> cuando la aplicación requeriría tipos de argumento
más específicos.
</p>
<p>Para ver una lista de los predicados de tipo disponibles,
consulte <a name="index-Predicados-de-tipo-predefinidos"></a>
<a href="notation-big-page.es.html#predefined-type-predicates">Predicados de tipo predefinidos</a>.
</p>
<a name="Vease-tambien"></a>
<h4 class="subsubheading">Véase también</h4>

<p>Referencia de la notación:
<a name="index-Predicados-de-tipo-predefinidos-1"></a>
<a href="notation-big-page.es.html#predefined-type-predicates">Predicados de tipo predefinidos</a>.
</p>
<p>Archivos instalados:
&lsquo;<tt>lily/music-scheme.cc</tt>&rsquo;,
&lsquo;<tt>scm/c++.scm</tt>&rsquo;,
&lsquo;<tt>scm/lily.scm</tt>&rsquo;.
</p>

<hr size="6">
<a name="Uso-de-las-funciones-de-Scheme"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#interfaces-for-programmers" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Interfaces para programadores&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#lilypond-scheme-interfaces" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces de Scheme de LilyPond &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#scheme-function-definitions" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Definición de funciones de Scheme&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#scheme-functions" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Funciones de Scheme&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#void-scheme-functions" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Funciones de Scheme vacías &gt; </a>]</td></tr></table>
<a name="scheme-function-usage"></a>
<h3 class="subsection">B.2.2 Uso de las funciones de Scheme</h3>

<p>Las funciones de Scheme se pueden llamar casi desde cualquier
lugar en que puede escribirse una expresión de Scheme que
comience con la almohadilla&nbsp;<code>#</code>.  Llamamos a una
función de Scheme escribiendo su nombre precedido de la barra
invertida&nbsp;<code>\</code>, y seguido por sus argumentos.  Una vez
que un argumento opcional no corresponde a ningún argumento,
LilyPond se salta este argumento y todos los que le siguen,
sustituyéndolos por su valor por omisión especificado, y
&lsquo;recupera&rsquo; el argumento que no correspondía al lugar del
siguiente argumento obligatorio.  Dado que el argumento
recuperado necesita ir a algún lugar, los argumentos opcionales
no se consideran realmente opcionales a no ser que vayan seguidos
de un argumento obligatorio.
</p>
<p>Existe una excepción: si escribimos <code>\default</code> en el lugar
de un argumento opcional, este argumento y todos los argumentos
opcionales que le siguen se saltan y se sustituyen por sus
valores predeterminados.  Esto funciona incluso si no sigue
ningún argumento obligatorio porque <code>\default</code> no necesita
recuperarse.  Las instrucciones <code>mark</code> y <code>key</code> hacen
uso de este truco para ofrecer su comportamiento predeterminado
cuando van seguidas solamente por <code>\default</code>.
</p>
<p>Aparte de los lugares en que se requiere un valor de Scheme hay
ciertos sitios en que se aceptan expresiones de almohadilla
<code>#</code> y se evalúan por sus efectos secundarios, pero por lo
demás se ignoran.  Son, mayormente, los lugares en que también
sería aceptable colocar una asignación.
</p>
<p>Dado que no es buena idea devolver valores que puedan
malinterpretarse en algún contexto, debería usar funciones de
Scheme normales solo para los casos en que siempre se devuelve un
valor útil, y usar funciones de Scheme vacías (v&eacute;ase la secci&oacute;n <a href="#void-scheme-functions">Funciones de Scheme vacías</a>) en caso contrario.
</p>
<p>Por conveniencia, las funciones de Scheme también se pueden
llamar directamente desde Scheme, puenteando al analizador
sintáctico de LilyPond.  Su nombre puede utilizarse como el
nombre de una función corriente.  La comprobación de tipo de los
argumentos y el salto de los argumentos opcionales tiene lugar de
la misma forma que cuando se llama desde dentro de LilyPond,
tomando el valor de Scheme <code>*unspecified*</code> el papel de la
palabra reservada <code>\default</code> para saltar explícitamente
argumentos opcionales.
</p>
<hr size="6">
<a name="Funciones-de-Scheme-vac_00edas"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#interfaces-for-programmers" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Interfaces para programadores&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#lilypond-scheme-interfaces" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces de Scheme de LilyPond &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#scheme-function-usage" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Uso de las funciones de Scheme&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#scheme-functions" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Funciones de Scheme&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#music-functions" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Funciones musicales &gt; </a>]</td></tr></table>
<a name="void-scheme-functions"></a>
<h3 class="subsection">B.2.3 Funciones de Scheme vacías</h3>
<a name="index-define_002dvoid_002dfunction"></a>
<a name="index-define_002dvoid_002dfunction-1"></a>
<a name="index-_005cvoid"></a>
<a name="index-_005cvoid-1"></a>

<p>En ocasiones, un procedimiento se ejecuta con el objeto de llevar
a cabo alguna acción más que para devolver un valor.  Algunos
lenguajes de programación (como C y Scheme) usan las funciones
para los dos conceptos y se limitan a descartar el valor devuelto
(usualmente haciendo que cualquier expresión pueda actuar como
instrucción, ignorando el resultado devuelto).  Esto puede
parecer inteligente pero es propenso a errores: casi todos los
compiladores de C de hoy en día emiten advertencias cuando se
descarta una expresión no vacía.  Para muchas funciones que
ejecutan una acción, los estándares de Scheme declaran que el
valor de retorno sea no especificado.  Guile, el intérprete de
Scheme de LilyPond, tiene un valor único <code>*unspecified*</code> que
en tales casos devuelve de forma usual (como cuando se usa
directamente <code>set!</code> sobre una variable), pero
desgraciadamente no de forma consistente.
</p>
<p>Definir una función de LilyPond con <code>define-void-function</code>
asegura que se devuelve este valor especial, el único valor que
satisface el predicado <code>void?</code>.
</p>
<blockquote><pre class="example">noApuntarYPulsar =
#(define-void-function
     ()
     ()
   (ly:set-option 'point-and-click #f))
&hellip;
\noApuntarYPulsar   % desactivar la función de apuntar y pulsar
</pre></blockquote>

<p>Si queremos evaluar una expresión sólo por su efecto colateral y
no queremos que se interprete ningún valor que pueda devolver,
podemos hacerlo anteponiendo el prefijo <code>\void</code>:
</p>
<blockquote><pre class="example">\void #(hashq-set! some-table some-key some-value)
</pre></blockquote>

<p>De esta forma podemos asegurar que LilyPond no asignará ningún
significado al valor devuelto, independientemente de dónde lo
encuentre.  También funciona para funciones musicales como
<code>\displayMusic</code>.
</p>
<hr size="6">
<a name="Funciones-musicales"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#interfaces-for-programmers" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Interfaces para programadores&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#lilypond-scheme-interfaces" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces de Scheme de LilyPond &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#void-scheme-functions" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Funciones de Scheme vacías&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#interfaces-for-programmers" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Interfaces para programadores&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#music-function-definitions" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Definiciones de funciones musicales &gt; </a>]</td></tr></table>
<a name="music-functions"></a>
<h2 class="section">B.3 Funciones musicales</h2>

<a name="index-funciones-musicales"></a>

<p>Las <em>funciones musicales</em> son procedimientos de Scheme que
pueden crear automáticamente expresiones musicales, y se pueden
usar para simplificar enormemente el archivo de entrada.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#music-function-definitions" accesskey="1">B.3.1 Definiciones de funciones musicales</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#music-function-usage" accesskey="2">B.3.2 Uso de las funciones musicales</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#simple-substitution-functions" accesskey="3">B.3.3 Funciones de sustitución sencillas</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#intermediate-substitution-functions" accesskey="4">B.3.4 Funciones de sustitución intermedias</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#mathematics-in-functions" accesskey="5">B.3.5 Matemáticas dentro de las funciones</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#functions-without-arguments" accesskey="6">B.3.6 Funciones sin argumentos</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#void-music-functions" accesskey="7">B.3.7 Funciones musicales vacías</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>


<hr size="6">
<a name="Definiciones-de-funciones-musicales"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#interfaces-for-programmers" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Interfaces para programadores&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#lilypond-scheme-interfaces" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces de Scheme de LilyPond &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#music-functions" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Funciones musicales&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#music-functions" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Funciones musicales&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#music-function-usage" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Uso de las funciones musicales &gt; </a>]</td></tr></table>
<a name="music-function-definitions"></a>
<h3 class="subsection">B.3.1 Definiciones de funciones musicales</h3>
<a name="index-definicion-de-funciones-musicales"></a>
<a name="index-define_002dmusic_002dfunction"></a>
<a name="index-define_002dmusic_002dfunction-1"></a>

<p>La forma general para definir funciones musicales es:
</p>
<blockquote><pre class="example">funcion =
#(define-music-function
     (<var>arg1</var> <var>arg2</var> &hellip;)
     (<var>tipo1?</var> <var>tipo2?</var> &hellip;)
   <var>cuerpo</var>)
</pre></blockquote>

<p>de forma bastante análoga a
<a href="#scheme-function-definitions">Definición de funciones de Scheme</a>.  Lo más probable es que
el <var>cuerpo</var> sea un
<a href="#lilypond-code-blocks">bloque de código de LilyPond</a>.
</p>
<p>Para ver una lista de los predicados de tipo disponibles,
consulte <a name="index-Predicados-de-tipo-predefinidos-2"></a>
<a href="notation-big-page.es.html#predefined-type-predicates">Predicados de tipo predefinidos</a>.
</p>
<a name="Vease-tambien-2"></a>
<h4 class="subsubheading">Véase también</h4>

<p>Referencia de la notación:
<a name="index-Predicados-de-tipo-predefinidos-3"></a>
<a href="notation-big-page.es.html#predefined-type-predicates">Predicados de tipo predefinidos</a>.
</p>
<p>Archivos de inicio:
&lsquo;<tt>lily/music-scheme.cc</tt>&rsquo;,
&lsquo;<tt>scm/c++.scm</tt>&rsquo;,
&lsquo;<tt>scm/lily.scm</tt>&rsquo;.
</p>

<hr size="6">
<a name="Uso-de-las-funciones-musicales"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#interfaces-for-programmers" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Interfaces para programadores&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#lilypond-scheme-interfaces" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces de Scheme de LilyPond &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#music-function-definitions" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Definiciones de funciones musicales&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#music-functions" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Funciones musicales&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#simple-substitution-functions" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Funciones de sustitución sencillas &gt; </a>]</td></tr></table>
<a name="music-function-usage"></a>
<h3 class="subsection">B.3.2 Uso de las funciones musicales</h3>

<p>Una &lsquo;función musical&rsquo; debe devolver una expresión que se
corresponda con el predicado <code>ly:music?</code>.  Esto hace que las
llamadas a funciones musicales sean aproopiadas como argumentos
del tipo <code>ly:music?</code> para otra llamada a una función
musical.
</p>
<p>Si se usa una llamada a función musical dentro de otros
contextos, el contexto puede aplicar restricciones semánticas
adicionales.
</p>
<ul>
<li>
En el nivel superior dentro de una expresión musical no se acepta
ningún post-evento.

</li><li>
Cuando una función musical (a diferencia de una función de
evento) devuelve una expresión del tipo post-event, LilyPond
requiere uno de los indicadores de dirección con nombre
(<code>-</code>, <code>^</code>, y <code>_</code>) para poder integrar
adecuadamente el post-evento producido por la llamada a la
función musical dentro de la expresión circundante.

</li><li>
Como componente de un acorde.  La expresión devuelta debe ser del
tipo <code>rhythmic-event</code>, probablemente un <code>NoteEvent</code>.
</li></ul>

<p>Se pueden aplicar funciones &lsquo;polimórficas&rsquo;, como <code>\tweak</code>,
a los post-eventos, componentes de acordes y expresiones
musicales del nivel superior.
</p>
<hr size="6">
<a name="Funciones-de-sustituci_00f3n-sencillas"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#interfaces-for-programmers" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Interfaces para programadores&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#lilypond-scheme-interfaces" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces de Scheme de LilyPond &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#music-function-usage" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Uso de las funciones musicales&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#music-functions" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Funciones musicales&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#intermediate-substitution-functions" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Funciones de sustitución intermedias &gt; </a>]</td></tr></table>
<a name="simple-substitution-functions"></a>
<h3 class="subsection">B.3.3 Funciones de sustitución sencillas</h3>

<p>Una función de sustitución sencilla es una función musical cuya
expresión musical de salida está escrita en código de LilyPond y
contiene argumentos de la función en la expresión de salida.
Están descritas en <a name="index-Ejemplos-de-funciones-de-sustitucion"></a>
<a href="notation-big-page.es.html#substitution-function-examples">Ejemplos de funciones de sustitución</a>.
</p>

<hr size="6">
<a name="Funciones-de-sustituci_00f3n-intermedias"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#interfaces-for-programmers" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Interfaces para programadores&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#lilypond-scheme-interfaces" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces de Scheme de LilyPond &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#simple-substitution-functions" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Funciones de sustitución sencillas&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#music-functions" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Funciones musicales&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#mathematics-in-functions" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Matemáticas dentro de las funciones &gt; </a>]</td></tr></table>
<a name="intermediate-substitution-functions"></a>
<h3 class="subsection">B.3.4 Funciones de sustitución intermedias</h3>

<p>Las funciones de sustitución intermedias contienen una mezcla de
código de Scheme y de LilyPond dentro de la expresión musical que
se devuelve.
</p>
<p>Algunas instrucciones <code>\override</code> requieren un argumento que
consiste en una pareja de números (llamada una <em>célula cons</em>
en Scheme).
</p>
<p>La pareja se puede pasar directamente dentro de la función
musical, usando una variable <code>pair?</code>:
</p>
<blockquote><pre class="example">barraManual =
#(define-music-function
     (principio-final)
     (pair?)
   #{
     \once \override Beam.positions = #principio-final
   #})

\relative c' {
  \barraManual #'(3 . 6) c8 d e f
}
</pre></blockquote>

<p>De forma alternativa, los números que componen la pareja se
pueden pasar como argumentos separados, y el código de Scheme que
se ha usado para crear la pareja se puede incluir dentro de la
expresión musical:
</p>
<blockquote><pre class="verbatim">manualBeam =
#(define-music-function
     (beg end)
     (number? number?)
   #{
     \once \override Beam.positions = #(cons beg end)
   #})

\relative c' {
  \manualBeam #3 #6 c8 d e f
}
</pre><p>
 <a href="1a/lily-1c7ee3ea.ly">
  <img align="middle"
       border="0"
       src="1a/lily-1c7ee3ea.png"
       alt="[image of music]">
 </a>
</p>
</blockquote>



<a name="index-_005ctemporary"></a>
<a name="index-_005ctemporary-1"></a>
<a name="index-sobreescrituras-temporales"></a>
<a name="index-temporales_002c-sobreescrituras"></a>
<a name="index-propiedades_002c-recuperar-valor-anterior"></a>

<p>Las propiedades se mantienen conceptualmente utilizando una pila
por cada propiedad, por cada grob y por cada contexto.  Las
funciones musicales pueden requerir la sobreescritura de una o
varias propiedades durante el tiempo de duración de la función,
restaurándolas a sus valores previos antes de salir.  Sin
embargo, las sobreescrituras normales extraen y descartan la cima
de la pila de propiedades actual antes de introducir un valor en
ella, de manera que el valor anterior de la propiedad se pierde
cuando se sobreescribe.  Si se quiere preservar el valor
anterior, hay que preceder la instrucción <code>\override</code> con la
palabra clave <code>\temporary</code>, así:
</p>
<blockquote><pre class="example">\temporary \override &hellip;
</pre></blockquote>

<p>El uso de <code>\temporary</code> hace que se borre la propiedad
(normalmente fijada a un cierto valor) <code>pop-first</code> de la
sobreescritura, de forma que el valor anterior no se extrae de la
pila de propiedades antes de poner en ella el valor nuevo.
Cuando una instrucción <code>\revert</code> posterior extrae el valor
sobreescrito temporalmente, volverá a emerger el valor anterior.
</p>
<p>En otras palabras, una llamada a <code>\temporary \override</code> y a
continuación otra a <code>\revert</code> sobre la misma propiedad,
tiene un valor neto que es nulo.  De forma similar, la
combinación en secuencia de <code>\temporary</code> y <code>\undo</code>
sobre la misma música que contiene las sobreescrituras, tiene un
efecto neto nulo.
</p>
<p>He aquí un ejemplo de una función musical que utiliza lo expuesto
anteriormente.  El uso de <code>\temporary</code> asegura que los
valores de las propiedades <code>cross-staff</code> y <code>style</code> se
restauran a la salida a los valores que tenían cuando se llamó a
la función <code>crossStaff</code>.  Sin <code>\temporary</code>, a la salida
se habrían fijado los valores predeterminados.
</p>
<blockquote><pre class="example">crossStaff =
#(define-music-function (notes) (ly:music?)
  (_i &quot;Create cross-staff stems&quot;)
  #{
  \temporary \override Stem.cross-staff = #cross-staff-connect
  \temporary \override Flag.style = #'no-flag
  #notes
  \revert Stem.cross-staff
  \revert Flag.style
#})
</pre></blockquote>


<hr size="6">
<a name="Matem_00e1ticas-dentro-de-las-funciones"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#interfaces-for-programmers" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Interfaces para programadores&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#lilypond-scheme-interfaces" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces de Scheme de LilyPond &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#intermediate-substitution-functions" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Funciones de sustitución intermedias&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#music-functions" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Funciones musicales&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#functions-without-arguments" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Funciones sin argumentos &gt; </a>]</td></tr></table>
<a name="mathematics-in-functions"></a>
<h3 class="subsection">B.3.5 Matemáticas dentro de las funciones</h3>

<p>Las funciones musicales pueden contar con programación de Scheme
además de la simple sustitución:
</p>
<blockquote><pre class="verbatim">AltOn =
#(define-music-function
     (mag)
     (number?)
   #{
     \override Stem.length = #(* 7.0 mag)
     \override NoteHead.font-size =
       #(inexact-&gt;exact (* (/ 6.0 (log 2.0)) (log mag)))
   #})

AltOff = {
  \revert Stem.length
  \revert NoteHead.font-size
}

\relative {
  c'2 \AltOn #0.5 c4 c
  \AltOn #1.5 c c \AltOff c2
}
</pre><p>
 <a href="71/lily-f3e0971d.ly">
  <img align="middle"
       border="0"
       src="71/lily-f3e0971d.png"
       alt="[image of music]">
 </a>
</p>
</blockquote>



<p>Este ejemplo se puede reescribir de forma que pase expresiones
musicales:
</p>
<blockquote><pre class="verbatim">withAlt =
#(define-music-function
     (mag music)
     (number? ly:music?)
   #{
     \override Stem.length = #(* 7.0 mag)
     \override NoteHead.font-size =
       #(inexact-&gt;exact (* (/ 6.0 (log 2.0)) (log mag)))
     #music
     \revert Stem.length
     \revert NoteHead.font-size
   #})

\relative {
  c'2 \withAlt #0.5 { c4 c }
  \withAlt #1.5 { c c } c2
}
</pre><p>
 <a href="b1/lily-5c08a228.ly">
  <img align="middle"
       border="0"
       src="b1/lily-5c08a228.png"
       alt="[image of music]">
 </a>
</p>
</blockquote>




<hr size="6">
<a name="Funciones-sin-argumentos"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#interfaces-for-programmers" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Interfaces para programadores&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#lilypond-scheme-interfaces" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces de Scheme de LilyPond &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#mathematics-in-functions" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Matemáticas dentro de las funciones&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#music-functions" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Funciones musicales&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#void-music-functions" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Funciones musicales vacías &gt; </a>]</td></tr></table>
<a name="functions-without-arguments"></a>
<h3 class="subsection">B.3.6 Funciones sin argumentos</h3>

<p>En casi todos los casos, una función sin argumentos se debe
escribir con una variable:
</p>
<blockquote><pre class="example">dolce = \markup{ \italic \bold dolce }
</pre></blockquote>

<p>Sin embargo, en raras ocasiones puede ser de utilidad crear una
función musical sin argumentos:
</p>
<blockquote><pre class="example">mostrarNumeroDeCompas =
#(define-music-function
     ()
     ()
   (if (eq? #t (ly:get-option 'display-bar-numbers))
       #{ \once \override Score.BarNumber.break-visibility = ##f #}
       #{#}))
</pre></blockquote>

<p>Para la impresión real de los números de compás donde se llama a
esta función, invoque a <code>lilypond</code> con
</p>
<blockquote><pre class="example">lilypond -d display-bar-numbers ARCHIVO.ly
</pre></blockquote>


<hr size="6">
<a name="Funciones-musicales-vac_00edas"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#interfaces-for-programmers" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Interfaces para programadores&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#lilypond-scheme-interfaces" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces de Scheme de LilyPond &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#functions-without-arguments" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Funciones sin argumentos&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#music-functions" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Funciones musicales&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#event-functions" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Funciones de eventos &gt; </a>]</td></tr></table>
<a name="void-music-functions"></a>
<h3 class="subsection">B.3.7 Funciones musicales vacías</h3>

<p>Una función musical debe devolver una expresión musical.  Si
quiere ejecutar una función exclusivamente por sus efectos
secundarios, debería usar <code>define-void-function</code>.  Pero
puede haber casos en los que a veces queremos producir una
expresión musical, y a veces no (como en el ejemplo anterior).
Devolver una expresión musical <code>void</code> (vacía) por medio de
<code>#{ #}</code> lo hace posible.
</p>

<hr size="6">
<a name="Funciones-de-eventos"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#interfaces-for-programmers" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Interfaces para programadores&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#lilypond-scheme-interfaces" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces de Scheme de LilyPond &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#void-music-functions" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Funciones musicales vacías&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#interfaces-for-programmers" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Interfaces para programadores&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#markup-functions" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Funciones de marcado &gt; </a>]</td></tr></table>
<a name="event-functions"></a>
<h2 class="section">B.4 Funciones de eventos</h2>
<a name="index-define_002devent_002dfunction"></a>
<a name="index-define_002devent_002dfunction-1"></a>
<a name="index-event-functions"></a>

<p>Para usar una función musical en el lugar de un evento, tenemos
que escribir un indicador de dirección antes de ella.  Pero a
veces, ello hace que se pierda la correspondencia con la sintaxis
de las construcciones que queremos sustituir.  Por ejemplo, si
queremos escribir instrucciones de matiz dinámico, éstos se
adjuntan habitualmente sin indicador de dirección, como
<code>c'\pp</code>.  He aquí una forma de escribir indicaciones
dinámicas arbitrarias:
</p>
<blockquote><pre class="verbatim">dyn=#(define-event-function (arg) (markup?)
         (make-dynamic-script arg))
\relative { c'\dyn pfsss }
</pre><p>
 <a href="4d/lily-e8657a1e.ly">
  <img align="middle"
       border="0"
       src="4d/lily-e8657a1e.png"
       alt="[image of music]">
 </a>
</p>
</blockquote>



<p>Podríamos hacer lo mismo usando una función musical, pero
entonces tendríamos que escribir siempre un indicador de
dirección antes de llamarla, como <code>c-\dyn pfsss</code>.
</p>

<hr size="6">
<a name="Funciones-de-marcado"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#interfaces-for-programmers" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Interfaces para programadores&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#lilypond-scheme-interfaces" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces de Scheme de LilyPond &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#event-functions" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Funciones de eventos&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#interfaces-for-programmers" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Interfaces para programadores&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#markup-construction-in-scheme" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Construcción de elementos de marcado en Scheme &gt; </a>]</td></tr></table>
<a name="markup-functions"></a>
<h2 class="section">B.5 Funciones de marcado</h2>

<p>Los elementos de marcado están implementados como funciones de
Scheme especiales que producen un objeto <code>Stencil</code> dada una
serie de argumentos.
</p>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#markup-construction-in-scheme" accesskey="1">B.5.1 Construcción de elementos de marcado en Scheme</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#how-markups-work-internally" accesskey="2">B.5.2 Cómo funcionan internamente los elementos de marcado</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#new-markup-command-definition" accesskey="3">B.5.3 Definición de una instrucción de marcado nueva</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#new-markup-list-command-definition" accesskey="4">B.5.4 Definición de nuevas instrucciones de lista de marcado</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr size="6">
<a name="Construcci_00f3n-de-elementos-de-marcado-en-Scheme"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#interfaces-for-programmers" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Interfaces para programadores&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#lilypond-scheme-interfaces" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces de Scheme de LilyPond &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#markup-functions" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Funciones de marcado&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#markup-functions" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Funciones de marcado&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#how-markups-work-internally" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Cómo funcionan internamente los elementos de marcado &gt; </a>]</td></tr></table>
<a name="markup-construction-in-scheme"></a>
<h3 class="subsection">B.5.1 Construcción de elementos de marcado en Scheme</h3>

<a name="index-marcado_002c-definir-instrucciones-de"></a>
<a name="index-_005cdisplayScheme"></a>
<a name="index-_005cdisplayScheme-1"></a>

<p>Las expresiones de marcado se representan internamente en Scheme
usando el macro <code>markup</code>:
</p>
<blockquote><pre class="example">(markup <var>expr</var>)
</pre></blockquote>

<p>Para ver una expresión de marcado en su forma de Scheme, utilice
la instrucción <code>\displayScheme</code>:
</p>
<blockquote><pre class="example">\displayScheme
\markup {
  \column {
    \line { \bold \italic &quot;hola&quot; \raise #0.4 &quot;mundo&quot; }
    \larger \line { fulano fulanito menganito }
  }
}
</pre></blockquote>

<p>La compilación del código anterior envía a la consola lo
siguiente:
</p>
<blockquote><pre class="example">(markup
  #:line
  (#:column
   (#:line
    (#:bold (#:italic &quot;hola&quot;) #:raise 0.4 &quot;mundo&quot;)
    #:larger
    (#:line
     (#:simple &quot;fulano&quot; #:simple &quot;fulanito&quot; #:simple &quot;menganito&quot;)))))
</pre></blockquote>

<p>Para evitar que el marcado se imprima en la página, use
&lsquo;<samp>\void \displayScheme <var>marcado</var></samp>&rsquo;.  Asimismo, como
ocurre con la instrucción <code>\displayMusic</code>, la salida de
<code>\displayScheme</code> se puede guardar en un archivo externo.
Véase <a href="#displaying-music-expressions">Presentación de las expresiones musicales</a>.
</p>
<p>Este ejemplo muestra las principales reglas de traducción entre
la sintaxis del marcado normal de LilyPond y la sintaxis del
marcado de Scheme.  La utilización de <code>#{ &hellip; #}</code> para
escribir en la sintaxis de LilyPond será con frecuencia lo más
conveniente, pero explicamos cómo usar la macro <code>markup</code>
para obtener una solución sólo con Scheme.
</p>
<blockquote><table>
<tr><td width="30%"><p> <b>LilyPond</b> </p></td><td width="30%"><p> <b>Scheme</b>
</p></td></tr>
<tr><td width="30%"><p> <code>\markup marcado1</code> </p></td><td width="30%"><p> <code>(markup marcado1)</code>
</p></td></tr>
<tr><td width="30%"><p> <code>\markup { marcado1 marcado2 &hellip; }</code> </p></td><td width="30%"><p>        <code>(markup marcado1 marcado2 &hellip; )</code>
</p></td></tr>
<tr><td width="30%"><p> <code>\instruccion</code> </p></td><td width="30%"><p> <code>#:instruccion</code>
</p></td></tr>
<tr><td width="30%"><p> <code>\variable</code> </p></td><td width="30%"><p> <code>variable</code>
</p></td></tr>
<tr><td width="30%"><p> <code>\center-column { &hellip; }</code> </p></td><td width="30%"><p>        <code>#:center-column ( &hellip; )</code>
</p></td></tr>
<tr><td width="30%"><p> <code>cadena</code> </p></td><td width="30%"><p> <code>&quot;cadena&quot;</code>
</p></td></tr>
<tr><td width="30%"><p> <code>#argumento-de-scheme</code> </p></td><td width="30%"><p> <code>argumento-de-scheme</code>
</p></td></tr>
</table>
</blockquote>

<p>Todo el lenguaje Scheme está accesible dentro del macro
<code>markup</code>.  Por ejemplo, podemos usar llamadas a funciones
dentro de <code>markup</code> para así manipular cadenas de caracteres.
Esto es útil si se están definiendo instrucciones de marcado
nuevas (véase <a href="#new-markup-command-definition">Definición de una instrucción de marcado nueva</a>).
</p>

<a name="Advertencias-y-problemas-conocidos"></a>
<h4 class="subsubheading">Advertencias y problemas conocidos</h4>

<p>El argumento markup-list de instrucciones como <code>#:line</code>,
<code>#:center</code> y <code>#:column</code> no puede ser una variable ni el
resultado de la llamada a una función.
</p>
<table><tr><td>&nbsp;</td><td><pre class="lisp">(markup #:line (funcion-que-devuelve-marcados))
</pre></td></tr></table>

<p>no es válido.  Hay que usar las funciones
<code>make-line-markup</code>, <code>make-center-markup</code> o
<code>make-column-markup</code> en su lugar:
</p>
<table><tr><td>&nbsp;</td><td><pre class="lisp">(markup (make-line-markup (funcion-que-devuelve-marcados)))
</pre></td></tr></table>


<hr size="6">
<a name="C_00f3mo-funcionan-internamente-los-elementos-de-marcado"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#interfaces-for-programmers" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Interfaces para programadores&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#lilypond-scheme-interfaces" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces de Scheme de LilyPond &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#markup-construction-in-scheme" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Construcción de elementos de marcado en Scheme&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#markup-functions" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Funciones de marcado&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#new-markup-command-definition" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Definición de una instrucción de marcado nueva &gt; </a>]</td></tr></table>
<a name="how-markups-work-internally"></a>
<h3 class="subsection">B.5.2 Cómo funcionan internamente los elementos de marcado</h3>

<p>En un elemento de marcado como
</p>
<blockquote><pre class="example">\raise #0.5 &quot;ejemplo de texto&quot;
</pre></blockquote>

<p><code>\raise</code> se representa en realidad por medio de la función
<code>raise-markup</code>.  La expresión de marcado se almacena como
</p>
<blockquote><pre class="example">(list raise-markup 0.5 (list simple-markup &quot;ejemplo de texto&quot;))
</pre></blockquote>

<p>Cuando el marcado se convierte en objetos imprimibles (Stencils o
sellos), se llama la función <code>raise-markup</code> como
</p>
<blockquote><pre class="example">(apply raise-markup
       <var>\objeto de marcado</var>
       <var>lista de listas asociativas de propiedades</var>
       0.5
       <var>el marcado &quot;ejemplo de texto&quot;</var>)
</pre></blockquote>

<p>Primero la función <code>raise-markup</code> crea el sello para la
cadena <code>ejemplo de texto</code>, y después eleva el sello Stencil
en 0.5 espacios de pentagrama.  Este es un ejemplo bastante
simple; en el resto de la sección podrán verse ejemplos más
complejos, así como en &lsquo;<tt>scm/define-markup-commands.scm</tt>&rsquo;.
</p>

<hr size="6">
<a name="Definici_00f3n-de-una-instrucci_00f3n-de-marcado-nueva"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#interfaces-for-programmers" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Interfaces para programadores&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#lilypond-scheme-interfaces" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces de Scheme de LilyPond &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#how-markups-work-internally" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Cómo funcionan internamente los elementos de marcado&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#markup-functions" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Funciones de marcado&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#markup-command-definition-syntax" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Sintaxis de la definición de instrucciones de marcado &gt; </a>]</td></tr></table>
<a name="new-markup-command-definition"></a>
<h3 class="subsection">B.5.3 Definición de una instrucción de marcado nueva</h3>

<p>Esta sección trata sobre la definición de nuevas instrucciones de
marcado.
</p>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#markup-command-definition-syntax" accesskey="1">Sintaxis de la definición de instrucciones de marcado</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#on-properties" accesskey="2">Acerca de las propiedades</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#a-complete-example" accesskey="3">Un ejemplo completo</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#adapting-builtin-commands" accesskey="4">Adaptación de instrucciones incorporadas</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr size="6">
<a name="Sintaxis-de-la-definici_00f3n-de-instrucciones-de-marcado"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#interfaces-for-programmers" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Interfaces para programadores&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#lilypond-scheme-interfaces" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces de Scheme de LilyPond &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#new-markup-command-definition" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Definición de una instrucción de marcado nueva&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#new-markup-command-definition" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Definición de una instrucción de marcado nueva&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#on-properties" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Acerca de las propiedades &gt; </a>]</td></tr></table>
<a name="markup-command-definition-syntax"></a>
<h4 class="unnumberedsubsubsec">Sintaxis de la definición de instrucciones de marcado</h4>

<p>Se pueden definir instrucciones de marcado nuevas usando el macro
de Scheme <code>define-markup-command</code>, en el nivel sintáctico
superior.
</p>
<table><tr><td>&nbsp;</td><td><pre class="lisp">(define-markup-command (<var>nombre-de-la-instruccion</var> <var>layout</var> <var>props</var> <var>arg1</var> <var>arg2</var> &hellip;)
    (<var>tipo-de-arg1?</var> <var>tipo-de-arg2?</var> &hellip;)
    [ #:properties ((<var>propiedad1</var> <var>valor-predeterminado1</var>)
                    &hellip;) ]
  &hellip;command body&hellip;)
</pre></td></tr></table>

<p>Los argumentos son
</p>
<dl compact="compact">
<dt> <code><var>nombre-de-la-instruccion</var></code></dt>
<dd><p>nombre de la instrucción de marcado
</p></dd>
<dt> <code>layout</code></dt>
<dd><p>la definición de &lsquo;layout&rsquo; (disposición).
</p></dd>
<dt> <code>props</code></dt>
<dd><p>una lista de listas asociativas, que contienen todas las propiedades
activas.
</p></dd>
<dt> <code><var>argi</var></code></dt>
<dd><p>argumento <var>i</var>-ésimo de la instrucción
</p></dd>
<dt> <code><var>tipo-de-argi?</var></code></dt>
<dd><p>predicado de tipo para el argumento <var>i</var>-ésimo
</p></dd>
</dl>

<p>Si la instrucción utiliza propiedades de los argumentos
<code>props</code>, se puede usar la palabra clave <code>#:properties</code>
para especificar qué propiedades se usan, así como sus valores
predeterminados.
</p>
<p>Los argumentos se distinguen según su tipo:
</p><ul>
<li> un marcado, que corresponde al predicado de tipo <code>markup?</code>;
</li><li> una lista de marcados, que corresponde al predicado de tipo
<code>markup-list?</code>;
</li><li> cualquier otro objeto de Scheme, que corresponde a predicados de tipo como
<code>list?</code>, <code>number?</code>, <code>boolean?</code>, etc.
</li></ul>

<p>No existe ninguna limitación en el orden de los argumentos
(después de los argumentos estándar <code>layout</code> y
<code>props</code>).  Sin embargo, las funciones de marcado que toman
un elemento de marcado como su último argumento son un poco
especiales porque podemos aplicarlas a una lista de marcados y el
resultado es una lista de marcados donde la función de marcado
(con los argumentos antecedentes especificados) se ha aplicado a
todos los elementos de la lista de marcados original.
</p>
<p>Dado que la replicación de los argumentos precedentes para
aplicar una función de marcado a una lista de marcados es poco
costosa principalmente por los argumentos de Scheme, se evitan
las caídas de rendimiento simplemente mediante la utilización de
argumentos de Scheme para los argumentos antecedentes de las
funciones de marcado que toman un marcado como su último
argumento.
</p>
<a name="index-_005cmarkup"></a>
<a name="index-_005cmarkup-1"></a>
<a name="index-markup-macro"></a>
<a name="index-interpret_002dmarkup"></a>
<a name="index-interpret_002dmarkup-1"></a>
<p>Las instrucciones de marcado tienen un ciclo de vida más bien
complejo.  El cuerpo de la definición de una instrucción de
marcado es responsable de la conversión de los argumentos de la
instrucción de marcado en una expresión de sello que se devuelve.
Muy a menudo esto se lleva a cabo llamando a la función
<code>interpret-markup</code> sobre una expresión de marcado, pasándole
los argumentos <var>layout</var> y <var>props</var>.  Por lo general, estos
argumentos se conocen solamente en una fase muy tardía de la
composición tipográfica.  Las expresiones de marcado ya tienen
sus componentes ensamblados dentro de expresiones de marcado
cuando se expanden las instrucciones <code>\markup</code> (dentro de
una expresión de LilyPond) o la macro <code>markup</code> (dentro de
Scheme).  La evaluación y la comprobación de tipos de los
argumentos de la instrucción de marcado tiene lugar en el momento
en que se interpretan <code>\markup</code> o <code>markup</code>.
</p>
<p>Pero la conversión real de expresiones de marcado en expresiones
de sello mediante la ejecución de los cuerpos de función de
marcado solo tienen lugar cuando se llama a
<code>interpret-markup</code> sobre una expresión de marcado.
</p>
<hr size="6">
<a name="Acerca-de-las-propiedades"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#interfaces-for-programmers" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Interfaces para programadores&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#lilypond-scheme-interfaces" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces de Scheme de LilyPond &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#markup-command-definition-syntax" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Sintaxis de la definición de instrucciones de marcado&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#new-markup-command-definition" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Definición de una instrucción de marcado nueva&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#a-complete-example" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Un ejemplo completo &gt; </a>]</td></tr></table>
<a name="on-properties"></a>
<h4 class="unnumberedsubsubsec">Acerca de las propiedades</h4>

<p>Los argumentos <code>layout</code> y <code>props</code> de las instrucciones
de marcado traen a escena un contexto para la interpretación del
marcado: tamaño de la tipografía, grueso de línea, etc.
</p>
<p>El argumento <code>layout</code> permite el acceso a las propiedades
definidas en los bloques <code>paper</code>, usando la función
<code>ly:output-def-lookup</code>.  Por ejemplo, el grueso de línea (el
mismo que el que se usa en las partituras) se lee usando:
</p>
<blockquote><pre class="example">(ly:output-def-lookup layout 'line-width)
</pre></blockquote>

<p>El argumento <code>props</code> hace accesibles algunas propiedades a
las instrucciones de marcado.  Por ejemplo, cuando se interpreta
el marcado del título de un libro, todas las variables definidas
dentro del bloque <code>\header</code> se añaden automáticamente a
<code>props</code>, de manera que el marcado del título del libro puede
acceder al título del libro, el autor, etc.  También es una forma
de configurar el comportamiento de una instrucción de marcado:
por ejemplo, cuando una instrucción utiliza tamaños de tipografía
durante el procesado, el tamaño se lee de <code>props</code> en vez de
tener un argumento <code>font-size</code>.  El que llama a una
instrucción de marcado puede cambiar el valor de la propiedad del
tamaño de la tipografía con el objeto de modificar el
comportamiento.  Utilice la palabra clave <code>#:properties</code> de
<code>define-markup-command</code> para especificar qué propiedades se
deben leer a partir de los argumentos de <code>props</code>.
</p>
<p>El ejemplo de la sección siguiente ilustra cómo acceder y
sobreescribir las propiedades de una instrucción de marcado.
</p>

<hr size="6">
<a name="Un-ejemplo-completo"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#interfaces-for-programmers" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Interfaces para programadores&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#lilypond-scheme-interfaces" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces de Scheme de LilyPond &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#on-properties" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Acerca de las propiedades&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#new-markup-command-definition" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Definición de una instrucción de marcado nueva&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#adapting-builtin-commands" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Adaptación de instrucciones incorporadas &gt; </a>]</td></tr></table>
<a name="a-complete-example"></a>
<h4 class="unnumberedsubsubsec">Un ejemplo completo</h4>

<p>El ejemplo siguiente define una instrucción de marcado para
trazar un rectángulo doble alrededor de un fragmento de texto.
</p>
<p>En primer lugar, necesitamos construir un resultado aproximado
utilizando marcados.  Una consulta a <a name="index-Instrucciones-de"></a>
marcado de texto
<a href="notation-big-page.es.html#text-markup-commands">Instrucciones de marcado de texto</a> nos muestra que es útil la instrucción
<code>\box</code>:
</p>
<blockquote><pre class="verbatim">\markup \box \box HELLO
</pre><p>
 <a href="75/lily-43f5cbce.ly">
  <img align="middle"
       border="0"
       src="75/lily-43f5cbce.png"
       alt="[image of music]">
 </a>
</p>
</blockquote>



<p>Ahora, consideramos que es preferible tener más separación entre
el texto y los rectángulos.  Según la documentación de
<code>\box</code>, esta instrucción usa una propiedad
<code>box-padding</code>, cuyo valor predeterminado es 0.2.  La
documentación también menciona cómo sobreescribir este valor:
</p>
<blockquote><pre class="verbatim">\markup \box \override #'(box-padding . 0.6) \box A
</pre><p>
 <a href="81/lily-7d9eea09.ly">
  <img align="middle"
       border="0"
       src="81/lily-7d9eea09.png"
       alt="[image of music]">
 </a>
</p>
</blockquote>



<p>Después, el relleno o separación entre los dos rectángulos nos
parece muy pequeño, así que lo vamos a sobreescribir también:
</p>
<blockquote><pre class="verbatim">\markup \override #'(box-padding . 0.4) \box
     \override #'(box-padding . 0.6) \box A
</pre><p>
 <a href="b5/lily-8a9d114e.ly">
  <img align="middle"
       border="0"
       src="b5/lily-8a9d114e.png"
       alt="[image of music]">
 </a>
</p>
</blockquote>



<p>Repetir esta extensa instrucción de marcado una y otra vez sería
un quebradero de cabeza.  Aquí es donde se necesita una
instrucción de marcado.  Así pues, escribimos una instrucción de
marcado <code>double-box</code>, que toma un argumento (el texto).
Dibuja los dos rectángulos y añade una separación.
</p>
<table><tr><td>&nbsp;</td><td><pre class="lisp">#(define-markup-command (double-box layout props text) (markup?)
  &quot;Trazar un rectángulo doble rodeando el texto.&quot;
  (interpret-markup layout props
    #{\markup \override #'(box-padding . 0.4) \box
            \override #'(box-padding . 0.6) \box { #text }#}))
</pre></td></tr></table>

<p>o, de forma equivalente,
</p>
<table><tr><td>&nbsp;</td><td><pre class="lisp">#(define-markup-command (double-box layout props text) (markup?)
  &quot;Trazar un rectángulo doble rodeando el texto.&quot;
  (interpret-markup layout props
    (markup #:override '(box-padding . 0.4) #:box
            #:override '(box-padding . 0.6) #:box text)))
</pre></td></tr></table>

<p><code>text</code> es el nombre del argumento de la instrucción, y
<code>markup?</code> es el tipo: lo identifica como un elemento de
marcado.  La función <code>interpret-markup</code> se usa en casi todas
las instrucciones de marcado: construye un sello, usando
<code>layout</code>, <code>props</code>, y un elemento de marcado.  En el
segundo caso, la marca se construye usando el macro de Scheme
<code>markup</code>, véase <a href="#markup-construction-in-scheme">Construcción de elementos de marcado en Scheme</a>.  La transformación de una expresión <code>\markup</code> en
una expresión de marcado de Scheme es directa.
</p>
<p>La instrucción nueva se puede usar como sigue:
</p>
<blockquote><pre class="example">\markup \double-box A
</pre></blockquote>

<p>Sería bueno hacer que la instrucción <code>double-box</code> fuera
personalizable: aquí, los valores de relleno <code>box-padding</code>
son fijos, y no se pueden cambiar por parte del usuario.  Además,
sería mejor distinguir la separación entre los dos rectángulos,
del relleno entre el rectángulo interno y el texto.  Así pues,
introducimos una nueva propiedad, <code>inter-box-padding</code>, para
el relleno entre los rectángulos.  El <code>box-padding</code> se usará
para el relleno interno.  Ahora el código nuevo es como se ve a
continuación:
</p>
<table><tr><td>&nbsp;</td><td><pre class="lisp">#(define-markup-command (double-box layout props text) (markup?)
  #:properties ((inter-box-padding 0.4)
                (box-padding 0.6))
  &quot;Trazar un rectángulo doble rodeando el texto.&quot;
  (interpret-markup layout props
    #{\markup \override #`(box-padding . ,inter-box-padding) \box
               \override #`(box-padding . ,box-padding) \box
               { #text } #}))
</pre></td></tr></table>

<p>De nuevo, la versión equivalente que utiliza la macro de marcado
sería:
</p>
<table><tr><td>&nbsp;</td><td><pre class="lisp">#(define-markup-command (double-box layout props text) (markup?)
  #:properties ((inter-box-padding 0.4)
                (box-padding 0.6))
  &quot;Trazar un rectángulo doble rodeando el texto.&quot;
  (interpret-markup layout props
    (markup #:override `(box-padding . ,inter-box-padding) #:box
            #:override `(box-padding . ,box-padding) #:box text)))
</pre></td></tr></table>

<p>Aquí, la palabra clave <code>#:properties</code> se usa de manera que
las propiedades <code>inter-box-padding</code> y <code>box-padding</code> se
leen a partir del argumento <code>props</code>, y se les proporcionan
unos valores predeterminados si las propiedades no están
definidas.
</p>
<p>Después estos valores se usan para sobreescribir las propiedades
<code>box-padding</code> usadas por las dos instrucciones <code>\box</code>.
Observe el apóstrofo invertido y la coma en el argumento de
<code>\override</code>: nos permiten introducir un valor de variable
dentro de una expresión literal.
</p>
<p>Ahora, la instrucción se puede usar dentro de un elemento de
marcado, y el relleno de los rectángulos se puede personalizar:
</p>
<blockquote><pre class="verbatim">#(define-markup-command (double-box layout props text) (markup?)
  #:properties ((inter-box-padding 0.4)
                (box-padding 0.6))
  &quot;Draw a double box around text.&quot;
  (interpret-markup layout props
    #{\markup \override #`(box-padding . ,inter-box-padding) \box
              \override #`(box-padding . ,box-padding) \box
              { #text } #}))

\markup \double-box A
\markup \override #'(inter-box-padding . 0.8) \double-box A
\markup \override #'(box-padding . 1.0) \double-box A
</pre><p>
 <a href="94/lily-b1443df4.ly">
  <img align="middle"
       border="0"
       src="94/lily-b1443df4.png"
       alt="[image of music]">
 </a>
</p>
</blockquote>




<hr size="6">
<a name="Adaptaci_00f3n-de-instrucciones-incorporadas"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#interfaces-for-programmers" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Interfaces para programadores&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#lilypond-scheme-interfaces" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces de Scheme de LilyPond &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#a-complete-example" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Un ejemplo completo&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#new-markup-command-definition" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Definición de una instrucción de marcado nueva&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#new-markup-list-command-definition" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Definición de nuevas instrucciones de lista de marcado &gt; </a>]</td></tr></table>
<a name="adapting-builtin-commands"></a>
<h4 class="unnumberedsubsubsec">Adaptación de instrucciones incorporadas</h4>

<p>Una buena manera de comenzar a escribir una instrucción de
marcado nueva, es seguir el ejemplo de otra instrucción ya
incorporada.  Casi todas las instrucciones de marcado que están
incorporadas en LilyPond se pueden encontrar en el archivo
&lsquo;<tt>scm/define-markup-commands.scm</tt>&rsquo;.
</p>
<p>Por ejemplo, querríamos adaptar la instrucción <code>\draw-line</code>,
para que trace una línea doble.  La instrucción <code>\draw-line</code>
está definida como sigue (se han suprimido los comentarios de
documentación):
</p>
<table><tr><td>&nbsp;</td><td><pre class="lisp">(define-markup-command (draw-line layout props dest)
  (number-pair?)
  #:category graphic
  #:properties ((thickness 1))
  &quot;&hellip;documentación&hellip;&quot;
  (let ((th (* (ly:output-def-lookup layout 'line-thickness)
               thickness))
        (x (car dest))
        (y (cdr dest)))
    (make-line-stencil th 0 0 x y)))
</pre></td></tr></table>

<p>Para definir una instrucción nueva basada en otra existente,
copie la definición y cámbiele el nombre.  La palabra clave
<code>#:category</code> se puede eliminar sin miedo, pues sólo se
utiliza para generar documentación de LilyPond, y no tiene
ninguna utilidad para las instrucciones de marcado definidas por
el usuario.
</p>
<table><tr><td>&nbsp;</td><td><pre class="lisp">(define-markup-command (draw-double-line layout props dest)
  (number-pair?)
  #:properties ((thickness 1))
  &quot;&hellip;documentación&hellip;&quot;
  (let ((th (* (ly:output-def-lookup layout 'line-thickness)
               thickness))
        (x (car dest))
        (y (cdr dest)))
    (make-line-stencil th 0 0 x y)))
</pre></td></tr></table>

<p>A continuación se añade una propiedad para establecer la
separación entre las dos líneas, llamada <code>line-gap</code>, con un
valor predeterminado de p.ej. 0.6:
</p>
<table><tr><td>&nbsp;</td><td><pre class="lisp">(define-markup-command (draw-double-line layout props dest)
  (number-pair?)
  #:properties ((thickness 1)
                (line-gap 0.6))
  &quot;&hellip;documentación&hellip;&quot;
  &hellip;
</pre></td></tr></table>

<p>Finalmente, se añade el código para trazar las dos líneas.  Se
usan dos llamadas a <code>make-line-stencil</code> para trazar las
líneas, y los sellos resultantes se combinan usando
<code>ly:stencil-add</code>:
</p>
<blockquote><pre class="verbatim">#(define-markup-command (my-draw-line layout props dest)
  (number-pair?)
  #:properties ((thickness 1)
                (line-gap 0.6))
  &quot;..documentation..&quot;
  (let* ((th (* (ly:output-def-lookup layout 'line-thickness)
                thickness))
         (dx (car dest))
         (dy (cdr dest))
         (w (/ line-gap 2.0))
         (x (cond ((= dx 0) w)
                  ((= dy 0) 0)
                  (else (/ w (sqrt (+ 1 (* (/ dx dy) (/ dx dy))))))))
         (y (* (if (&lt; (* dx dy) 0) 1 -1)
               (cond ((= dy 0) w)
                     ((= dx 0) 0)
                     (else (/ w (sqrt (+ 1 (* (/ dy dx) (/ dy dx))))))))))
     (ly:stencil-add (make-line-stencil th x y (+ dx x) (+ dy y))
                     (make-line-stencil th (- x) (- y) (- dx x) (- dy y)))))

\markup \my-draw-line #'(4 . 3)
\markup \override #'(line-gap . 1.2) \my-draw-line #'(4 . 3)
</pre><p>
 <a href="f2/lily-ee1c28e4.ly">
  <img align="middle"
       border="0"
       src="f2/lily-ee1c28e4.png"
       alt="[image of music]">
 </a>
</p>
</blockquote>




<hr size="6">
<a name="Definici_00f3n-de-nuevas-instrucciones-de-lista-de-marcado"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#interfaces-for-programmers" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Interfaces para programadores&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#lilypond-scheme-interfaces" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces de Scheme de LilyPond &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#adapting-builtin-commands" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Adaptación de instrucciones incorporadas&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#markup-functions" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Funciones de marcado&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#contexts-for-programmers" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Contextos para programadores &gt; </a>]</td></tr></table>
<a name="new-markup-list-command-definition"></a>
<h3 class="subsection">B.5.4 Definición de nuevas instrucciones de lista de marcado</h3>

<a name="index-define_002dmarkup_002dlist_002dcommand"></a>
<a name="index-define_002dmarkup_002dlist_002dcommand-1"></a>
<a name="index-interpret_002dmarkup_002dlist"></a>
<a name="index-interpret_002dmarkup_002dlist-1"></a>

<p>Las instrucciones de listas de marcado se definen con el macro de
Scheme <code>define-markup-list-command</code>, que es similar al macro
<code>define-markup-command</code> descrito en <a href="#new-markup-command-definition">Definición de una instrucción de marcado nueva</a>, excepto que donde éste devuelve un
sello único, aquél devuelve una lista de sellos.
</p>
<p>En el siguiente ejemplo se define una instrucción de lista de
marcado <code>\paragraph</code>, que devuelve una lista de líneas
justificadas, estando la primera de ellas sangrada.  La anchura
del sangrado se toma del argumento <code>props</code>.
</p>
<blockquote><pre class="example">#(define-markup-list-command (paragraph layout props args) (markup-list?)
   #:properties ((par-indent 2))
   (interpret-markup-list layout props
     #{\markuplist \justified-lines { \hspace #par-indent #args } #}))
</pre></blockquote>


<p>La versión que usa solamente Scheme es más compleja:
</p><blockquote><pre class="example">#(define-markup-list-command (paragraph layout props args) (markup-list?)
   #:properties ((par-indent 2))
   (interpret-markup-list layout props
     (make-justified-lines-markup-list (cons (make-hspace-markup par-indent)
                                             args))))
</pre></blockquote>

<p>Aparte de los argumentos usuales <code>layout</code> y <code>props</code>, la
instrucción de lista de marcados <code>paragraph</code> toma un
argumento de lista de marcados, llamado <code>args</code>.  El
predicado para listas de marcados es <code>markup-list?</code>.
</p>
<p>En primer lugar, la función toma el ancho del sangrado, una
propiedad llamada aquí <code>par-indent</code>, de la lista de
propiedades <code>props</code>.  Si no se encuentra la propiedad, el
valor predeterminado es <code>2</code>.  Después, se hace una lista de
líneas justificadas usando la instrucción incorporada de lista de
marcados <code>\justified-lines</code>, que está relacionada con la
función <code>make-justified-lines-markup-list</code>.  Se añade un
espacio horizontal al principio usando <code>\hspace</code> (o la
función <code>make-hspace-markup</code>).  Finalmente, la lista de
marcados se interpreta usando la función
<code>interpret-markup-list</code>.
</p>
<p>Esta nueva instrucción de lista de marcados se puede usar como
sigue:
</p>
<blockquote><pre class="example">\markuplist {
  \paragraph {
    El arte de la tipografía musical se llama  \italic {grabado (en plancha).}
    El término deriva del proceso tradicional de impresión de música.
    hace sólo algunas décadas, las partituras se hacían cortando y estampando
    la música en una plancha de zinc o lata en una imagen invertida.
  }
  \override-lines #'(par-indent . 4) \paragraph {
    La plancha se tenía que entintar, y las depresiones causadas por los cortes
    y estampados retienen la tinta.  Se formaba una imagen presionando el papel
    contra la plancha.  El estampado y cortado se hacía completamente
    a mano.
  }
}
</pre></blockquote>


<hr size="6">
<a name="Contextos-para-programadores"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#interfaces-for-programmers" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Interfaces para programadores&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#lilypond-scheme-interfaces" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces de Scheme de LilyPond &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#new-markup-list-command-definition" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Definición de nuevas instrucciones de lista de marcado&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#interfaces-for-programmers" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Interfaces para programadores&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#context-evaluation" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Evaluación de contextos &gt; </a>]</td></tr></table>
<a name="contexts-for-programmers"></a>
<h2 class="section">B.6 Contextos para programadores</h2>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#context-evaluation" accesskey="1">B.6.1 Evaluación de contextos</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#running-a-function-on-all-layout-objects" accesskey="2">B.6.2 Ejecutar una función sobre todos los objetos de la presentación</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr size="6">
<a name="Evaluaci_00f3n-de-contextos"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#interfaces-for-programmers" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Interfaces para programadores&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#lilypond-scheme-interfaces" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces de Scheme de LilyPond &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#contexts-for-programmers" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Contextos para programadores&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#contexts-for-programmers" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Contextos para programadores&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#running-a-function-on-all-layout-objects" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Ejecutar una función sobre todos los objetos de la presentación &gt; </a>]</td></tr></table>
<a name="context-evaluation"></a>
<h3 class="subsection">B.6.1 Evaluación de contextos</h3>

<a name="index-codigo_002c-llamadas-durante-la-interpretacion"></a>
<a name="index-_005capplyContext"></a>
<a name="index-_005capplyContext-1"></a>
<a name="index-make_002dapply_002dcontext"></a>
<a name="index-make_002dapply_002dcontext-1"></a>
<a name="index-ly_003acontext_002dproperty"></a>
<a name="index-ly_003acontext_002dproperty-1"></a>
<a name="index-ly_003acontext_002dset_002dproperty_0021"></a>
<a name="index-ly_003acontext_002dset_002dproperty_0021-1"></a>
<a name="index-ly_003acontext_002dgrob_002ddefinition"></a>
<a name="index-ly_003acontext_002dgrob_002ddefinition-1"></a>
<a name="index-ly_003aassoc_002dget"></a>
<a name="index-ly_003aassoc_002dget-1"></a>
<a name="index-ly_003acontext_002dpushpop_002dproperty"></a>
<a name="index-ly_003acontext_002dpushpop_002dproperty-1"></a>

<p>Se pueden modificar los contextos durante la interpretación con
código de Scheme.  Dentro de un bloque de código de LilyPond, la
sintaxis para esto es:
</p>
<blockquote><pre class="example">\applyContext <var>función</var>
</pre></blockquote>

<p>En código de Scheme, la sintaxis es:
</p>
<blockquote><pre class="example">(make-apply-context <var>function</var>)
</pre></blockquote>

<p><code><var>función</var></code> debe ser una función de Scheme que toma un
único argumento, que es el contexto al que aplicarla.  La función
puede acceder a, así como sobreescribir u establecer propiedades
de grobs s y propiedades de contextos.  Cualquier acción tomada
por la función que dependa del estado del contexto, está limitada
al estado del contexto <em>en el momento de llamar a la
función</em>.  Asimismo, los cambios efectuados por una llamada a
<code>\applyContext</code> permanecen en efecto hasta que se modifican
de nuevo directamente, o se revierten, incluso si han cambiado las
condiciones iniciales sobre las que dependen.
</p>
<p>Las siguientes funciones de Scheme son útiles cuando se utiliza
<code>\applyContext</code>:
</p>
<dl compact="compact">
<dt> <code>ly:context-property</code></dt>
<dd><p>recuperar el valor de una propiedad de contexto
</p>
</dd>
<dt> <code>ly:context-set-property!</code></dt>
<dd><p>establecer el valor de una propiedad de contexto
</p>
</dd>
<dt> <code>ly:context-grob-definition</code></dt>
<dt> <code>ly:assoc-get</code></dt>
<dd><p>recuperar el valor de una propiedad de un grob
</p>
</dd>
<dt> <code>ly:context-pushpop-property</code></dt>
<dd><p>hacer una sobreescritura temporal
(<code>\temporary&nbsp;\override</code>) o una reversión
(<code>\revert</code>) sobre una propiedad de un grob
</p></dd>
</dl>

<p>El ejemplo siguiente recupera el valor actual de <code>fontSize</code>,
y a continuación lo dobla:
</p>
<blockquote><pre class="verbatim">doubleFontSize =
\applyContext
  #(lambda (context)
     (let ((fontSize (ly:context-property context 'fontSize)))
       (ly:context-set-property! context 'fontSize (+ fontSize 6))))

{
  \set fontSize = -3
  b'4
  \doubleFontSize
  b'
}
</pre><p>
 <a href="d4/lily-b353ab4a.ly">
  <img align="middle"
       border="0"
       src="d4/lily-b353ab4a.png"
       alt="[image of music]">
 </a>
</p>
</blockquote>




<p>El ejemplo siguiente recupera los colores actuales de los grobs
<code>NoteHead</code>, <code>Stem</code> y <code>Beam</code>, y a continuación los
modifica para que tengan un matiz menos saturado.
</p>
<blockquote><pre class="verbatim">desaturate =
\applyContext
  #(lambda (context)
     (define (desaturate-grob grob)
       (let* ((grob-def (ly:context-grob-definition context grob))
              (color (ly:assoc-get 'color grob-def black))
              (new-color (map (lambda (x) (min 1 (/ (1+ x) 2))) color)))
         (ly:context-pushpop-property context grob 'color new-color)))
     (for-each desaturate-grob '(NoteHead Stem Beam)))

\relative {
  \time 3/4
  g'8[ g] \desaturate g[ g] \desaturate g[ g]
  \override NoteHead.color = #darkred
  \override Stem.color = #darkred
  \override Beam.color = #darkred
  g[ g] \desaturate g[ g] \desaturate g[ g]
}
</pre><p>
 <a href="ea/lily-0dfa90ac.ly">
  <img align="middle"
       border="0"
       src="ea/lily-0dfa90ac.png"
       alt="[image of music]">
 </a>
</p>
</blockquote>




<p>Esto puede implementarse también como una función musical, con el
objeto de restringir las modificaciones a un único bloque de
música.  Observe cómo se usa <code>ly:context-pushpop-property</code>
tanto como una sobreescritura temporal
(<code>\temporary&nbsp;\override</code>) como una reversión
(<code>\revert</code>):
</p>
<blockquote><pre class="verbatim">desaturate =
#(define-music-function
   (music) (ly:music?)
   #{
     \applyContext
     #(lambda (context)
        (define (desaturate-grob grob)
          (let* ((grob-def (ly:context-grob-definition context grob))
                 (color (ly:assoc-get 'color grob-def black))
                 (new-color (map (lambda (x) (min 1 (/ (1+ x) 2))) color)))
            (ly:context-pushpop-property context grob 'color new-color)))
        (for-each desaturate-grob '(NoteHead Stem Beam)))
     #music
     \applyContext
     #(lambda (context)
        (define (revert-color grob)
          (ly:context-pushpop-property context grob 'color))
        (for-each revert-color '(NoteHead Stem Beam)))
   #})

\relative {
  \override NoteHead.color = #darkblue
  \override Stem.color = #darkblue
  \override Beam.color = #darkblue
  g'8 a b c
  \desaturate { d c b a }
  g b d b g2
}
</pre><p>
 <a href="03/lily-454b4424.ly">
  <img align="middle"
       border="0"
       src="03/lily-454b4424.png"
       alt="[image of music]">
 </a>
</p>
</blockquote>




<hr size="6">
<a name="Ejecutar-una-funci_00f3n-sobre-todos-los-objetos-de-la-presentaci_00f3n"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#interfaces-for-programmers" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Interfaces para programadores&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#lilypond-scheme-interfaces" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces de Scheme de LilyPond &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#context-evaluation" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Evaluación de contextos&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#contexts-for-programmers" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Contextos para programadores&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#callback-functions" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Funciones de callback &gt; </a>]</td></tr></table>
<a name="running-a-function-on-all-layout-objects"></a>
<h3 class="subsection">B.6.2 Ejecutar una función sobre todos los objetos de la presentación</h3>

<a name="index-codigo_002c-llamar-sobre-objetos-de-presentacion"></a>
<a name="index-_005capplyOutput"></a>
<a name="index-_005capplyOutput-1"></a>

<p>La manera más versátil de realizar el ajuste fino de un objeto es
<code>\applyOutput</code>, que funciona insertando un evento dentro del
contexto especificado (<a name="index-ApplyOutputEvent"></a>
<a href="internals-big-page.html#applyoutputevent">ApplyOutputEvent</a>).  Su
sintaxis es o bien
</p>
<blockquote><pre class="example">\applyOutput <var>Contexto</var> <var>proc</var>
</pre></blockquote>

<p>o bien
</p>
<blockquote><pre class="example">\applyOutput <var>Context</var>.<var>Grob</var> <var>proc</var>
</pre></blockquote>

<p>donde <code><var>proc</var></code> es una función de Scheme que toma tres
argumentos.
</p>
<p>Al interpretarse, la función <code><var>proc</var></code> se llama para cada
objeto de presentación (con el nombre del grob <var>Grob</var> si se
especifica) que se encuentra en el contexto <code><var>Contexto</var></code>
en el tiempo actual, con los siguientes argumentos:
</p>
<ul>
<li> el propio objeto de presentación,
</li><li> el contexto en que se creó el objeto de presentación, y
</li><li> el contexto en que se procesa <code>\applyOutput</code>.
</li></ul>


<p>Además, la causa del objeto de presentación, es decir el objeto o
expresión musical que es responsable de haberlo creado, está en la
propiedad <code>cause</code> del objeto.  Por ejemplo, para la cabeza de
una nota, éste es un evento <a name="index-NoteHead"></a>
<a href="internals-big-page.html#notehead">NoteHead</a>, y para un
objeto plica, éste es un objeto <a name="index-Stem"></a>
<a href="internals-big-page.html#stem">Stem</a>.
</p>
<p>He aquí una función que usar para <code>\applyOutput</code>; borra las
cabezas de las notas que están sobre la línea central y junto a
ella:
</p>
<blockquote><pre class="verbatim">#(define (blanker grob grob-origin context)
   (if (&lt; (abs (ly:grob-property grob 'staff-position)) 2)
       (set! (ly:grob-property grob 'transparent) #t)))

\relative {
  a'4 e8 &lt;&lt;\applyOutput Voice.NoteHead #blanker a c d&gt;&gt; b2
}
</pre><p>
 <a href="e6/lily-eca7384f.ly">
  <img align="middle"
       border="0"
       src="e6/lily-eca7384f.png"
       alt="[image of music]">
 </a>
</p>
</blockquote>



<p>Para que <var>función</var> se interprete en los niveles de
<code>Score</code> o de <code>Staff</code> utilice estas formas:
</p>
<blockquote><pre class="example">\applyOutput Score&hellip;
\applyOutput Staff&hellip;
</pre></blockquote>


<hr size="6">
<a name="Funciones-de-callback"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#interfaces-for-programmers" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Interfaces para programadores&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#lilypond-scheme-interfaces" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces de Scheme de LilyPond &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#running-a-function-on-all-layout-objects" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Ejecutar una función sobre todos los objetos de la presentación&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#interfaces-for-programmers" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Interfaces para programadores&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#difficult-tweaks" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Trucos difíciles &gt; </a>]</td></tr></table>
<a name="callback-functions"></a>
<h2 class="section">B.7 Funciones de callback</h2>

<p>Las propiedades (como <code>thickness</code> (grosor), <code>direction</code>
(dirección), etc.) se pueden establecer a valores fijos con
\override, p. ej.:
</p>
<blockquote><pre class="example">\override Stem.thickness = #2.0
</pre></blockquote>

<p>Las propiedades pueden fijarse también a un procedimiento de
Scheme:
</p>
<blockquote><pre class="verbatim">\override Stem.thickness = #(lambda (grob)
    (if (= UP (ly:grob-property grob 'direction))
        2.0
        7.0))
\relative { c'' b a g b a g b }
</pre><p>
 <a href="b8/lily-edb9a4ad.ly">
  <img align="middle"
       border="0"
       src="b8/lily-edb9a4ad.png"
       alt="[image of music]">
 </a>
</p>
</blockquote>



<p>En este caso, el procedimiento se ejecuta tan pronto como el valor
de la propiedad se reclama durante el proceso de formateo.
</p>
<p>Casi todo el motor de tipografiado está manejado por estos
<em>callbacks</em>.  Entre las propiedades que usan normalmente
<em>callbacks</em> están
</p>
<dl compact="compact">
<dt> <code>stencil</code></dt>
<dd><p>  La rutina de impresión, que construye un dibujo para el símbolo
</p></dd>
<dt> <code>X-offset</code></dt>
<dd><p>  La rutina que establece la posición horizontal
</p></dd>
<dt> <code>X-extent</code></dt>
<dd><p>  La rutina que calcula la anchura de un objeto
</p></dd>
</dl>

<p>El procedimiento siempre toma un argumento único, que es el grob
(el objeto gráfico).
</p>
<p>Dicho procedimiento puede acceder al valor usual de la propiedad,
llamando en primer lugar a la función que es el &lsquo;callback&rsquo; usual
para esa propiedad, y que puede verse en el manual de referencia
interna o en el archivo &rsquo;define-grobs.scm&rsquo;:
</p>
<blockquote><pre class="example">\relative {
  \override Flag.X-offset = #(lambda (flag)
    (let ((default (ly:flag::calc-x-offset flag)))
      (* default 4.0)))
  c''4. d8 a4. g8
}
</pre></blockquote>

<p>Desde dentro de un callback, el método más fácil para evaluar un
elemento de marcado es usar grob-interpret-markup.  Por ejemplo:
</p>
<blockquote><pre class="example">mi-callback = #(lambda (grob)
                 (grob-interpret-markup grob (markup &quot;fulanito&quot;)))
</pre></blockquote>



<hr size="6">
<a name="Trucos-dif_00edciles"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#interfaces-for-programmers" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Interfaces para programadores&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#lilypond-scheme-interfaces" title="Cap&iacute;tulo siguiente">&nbsp;Interfaces de Scheme de LilyPond &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#callback-functions" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Funciones de callback&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#interfaces-for-programmers" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Interfaces para programadores&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#lilypond-scheme-interfaces" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Interfaces de Scheme de LilyPond &gt; </a>]</td></tr></table>
<a name="difficult-tweaks"></a>
<h2 class="section">B.8 Trucos difíciles</h2>

<p>Hay un cierto número de tipos de ajustes difíciles.
</p>
<ul>
<li>
Un tipo de ajuste difícil es la apariencia de los objetos de
extensión, como las ligaduras de expresión y de unión.
Inicialmente, sólo se crea uno de estos objetos, y pueden
ajustarse con el mecanismo normal.  Sin embargo, en ciertos casos
los objetos extensores cruzan los saltos de línea.  Si esto
ocurre, estos objetos se clonan.  Se crea un objeto distinto por
cada sistema en que se encuentra.  Éstos son clones del objeto
original y heredan todas sus propiedades, incluidos los
<code>\override</code>s.

<p>En otras palabras, un <code>\override</code> siempre afecta a todas las
piezas de un objeto de extensión fragmentado.  Para cambiar sólo
una parte de un extensor en el salto de línea, es necesario
inmiscuirse en el proceso de formateado.  El <em>callback</em>
<code>after-line-breaking</code> contiene el procedimiento Scheme que se
llama después de que se han determinado los saltos de línea, y los
objetos de presentación han sido divididos sobre los distintos
sistemas.
</p>
<p>En el ejemplo siguiente, definimos un procedimiento
<code>my-callback</code>.  Este procedimiento
</p>
<ul>
<li>
determina si hemos sido divididos por los saltos de línea
</li><li>
en caso afirmativo, reúne todos los objetos divididos
</li><li>
comprueba si somos el último de los objetos divididos
</li><li>
en caso afirmativo, establece <code>extra-offset</code>.
</li></ul>

<p>Este procedimiento se instala en <a name="index-Tie"></a>
<a href="internals-big-page.html#tie">Tie</a> (ligadura de
unión), de forma que la última parte de la ligadura dividida se
traslada hacia arriba.
</p>
<blockquote><pre class="verbatim">#(define (my-callback grob)
   (let* (
          ;; have we been split?
          (orig (ly:grob-original grob))

          ;; if yes, get the split pieces (our siblings)
          (siblings (if (ly:grob? orig)
                        (ly:spanner-broken-into orig)
                        '())))

     (if (and (&gt;= (length siblings) 2)
              (eq? (car (last-pair siblings)) grob))
         (ly:grob-set-property! grob 'extra-offset '(-2 . 5)))))

\relative {
  \override Tie.after-line-breaking =
  #my-callback
  c''1 ~ \break
  c2 ~ 2
}
</pre><p>
 <a href="31/lily-e8e54061.ly">
  <img align="middle"
       border="0"
       src="31/lily-e8e54061.png"
       alt="[image of music]">
 </a>
</p>
</blockquote>



<p>Al aplicar este truco, la nueva función de callback
<code>after-line-breaking</code> también debe llamar a la antigua, si
existe este valor predeterminado.  Por ejemplo, si se usa con
<code>Hairpin</code>, se debe llamar también a
<code>ly:spanner::kill-zero-spanned-time</code>.
</p>

</li><li> Algunos objetos no se pueden cambiar con <code>\override</code> por
razones técnicas.  Son ejemplos <code>NonMusicalPaperColumn</code> y
<code>PaperColumn</code>.  Se pueden cambiar con la función
<code>\overrideProperty</code> que funciona de forma similar a
<code>\once \override</code>, pero usa una sintaxis distinta.

<blockquote><pre class="example">\overrideProperty
Score.NonMusicalPaperColumn      % Nombre del grob
  . line-break-system-details    % Nombre de la propiedad
  . next-padding                 % Nombre de la subpropiedad, opcional
  #20                            % Valor
</pre></blockquote>

<p>Observe, sin embargo, que <code>\override</code>, aplicado a
<code>NonMusicalPaperColumn</code> y a <code>PaperColumn</code>, aún funciona
como se espera dentro de los bloques <code>\context</code>.
</p>
</li></ul>


<hr size="6">
<a name="Interfaces-de-Scheme-de-LilyPond"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#interfaces-for-programmers" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Interfaces para programadores&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#gnu-free-documentation-license" title="Cap&iacute;tulo siguiente">&nbsp;GNU Free Documentation License &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#difficult-tweaks" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Trucos difíciles&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#index" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Top&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#gnu-free-documentation-license" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;GNU Free Documentation License &gt; </a>]</td></tr></table>
<a name="lilypond-scheme-interfaces"></a>
<h1 class="chapter">C. Interfaces de Scheme de LilyPond</h1>

<p>Este capítulo cubre las diversas herramientas proporcionadas por
LilyPond como ayuda a los programadores de Scheme a extraer e
introducir información de los flujos musicales.
</p>
<p>HACER </p>
<hr size="6">
<a name="GNU-Free-Documentation-License"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#lilypond-scheme-interfaces" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; Interfaces de Scheme de LilyPond&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="#lilypond-index" title="Cap&iacute;tulo siguiente">&nbsp;Índice de LilyPond &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#lilypond-scheme-interfaces" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; Interfaces de Scheme de LilyPond&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#index" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Top&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="#lilypond-index" title="Secci&oacute;n siguiente en orden de lectura" accesskey="n" rel="next">&nbsp;Índice de LilyPond &gt; </a>]</td></tr></table>
<a name="gnu-free-documentation-license"></a>
<h1 class="appendix">D. GNU Free Documentation License</h1>
<p align="center"> Version 1.3, 3 November 2008
</p>

<table><tr><td>&nbsp;</td><td><pre class="display">Copyright &copy; 2000, 2001, 2002, 2007, 2008 Free Software Foundation, Inc.
<a href="http://fsf.org">http://fsf.org/</a>

Everyone is permitted to copy and distribute verbatim copies
of this license document, but changing it is not allowed.
</pre></td></tr></table>

<ol>
<li>
PREAMBLE

<p>The purpose of this License is to make a manual, textbook, or other
functional and useful document <em>free</em> in the sense of freedom: to
assure everyone the effective freedom to copy and redistribute it,
with or without modifying it, either commercially or noncommercially.
Secondarily, this License preserves for the author and publisher a way
to get credit for their work, while not being considered responsible
for modifications made by others.
</p>
<p>This License is a kind of &ldquo;copyleft&rdquo;, which means that derivative
works of the document must themselves be free in the same sense.  It
complements the GNU General Public License, which is a copyleft
license designed for free software.
</p>
<p>We have designed this License in order to use it for manuals for free
software, because free software needs free documentation: a free
program should come with manuals providing the same freedoms that the
software does.  But this License is not limited to software manuals;
it can be used for any textual work, regardless of subject matter or
whether it is published as a printed book.  We recommend this License
principally for works whose purpose is instruction or reference.
</p>
</li><li>
APPLICABILITY AND DEFINITIONS

<p>This License applies to any manual or other work, in any medium, that
contains a notice placed by the copyright holder saying it can be
distributed under the terms of this License.  Such a notice grants a
world-wide, royalty-free license, unlimited in duration, to use that
work under the conditions stated herein.  The &ldquo;Document&rdquo;, below,
refers to any such manual or work.  Any member of the public is a
licensee, and is addressed as &ldquo;you&rdquo;.  You accept the license if you
copy, modify or distribute the work in a way requiring permission
under copyright law.
</p>
<p>A &ldquo;Modified Version&rdquo; of the Document means any work containing the
Document or a portion of it, either copied verbatim, or with
modifications and/or translated into another language.
</p>
<p>A &ldquo;Secondary Section&rdquo; is a named appendix or a front-matter section
of the Document that deals exclusively with the relationship of the
publishers or authors of the Document to the Document&rsquo;s overall
subject (or to related matters) and contains nothing that could fall
directly within that overall subject.  (Thus, if the Document is in
part a textbook of mathematics, a Secondary Section may not explain
any mathematics.)  The relationship could be a matter of historical
connection with the subject or with related matters, or of legal,
commercial, philosophical, ethical or political position regarding
them.
</p>
<p>The &ldquo;Invariant Sections&rdquo; are certain Secondary Sections whose titles
are designated, as being those of Invariant Sections, in the notice
that says that the Document is released under this License.  If a
section does not fit the above definition of Secondary then it is not
allowed to be designated as Invariant.  The Document may contain zero
Invariant Sections.  If the Document does not identify any Invariant
Sections then there are none.
</p>
<p>The &ldquo;Cover Texts&rdquo; are certain short passages of text that are listed,
as Front-Cover Texts or Back-Cover Texts, in the notice that says that
the Document is released under this License.  A Front-Cover Text may
be at most 5 words, and a Back-Cover Text may be at most 25 words.
</p>
<p>A &ldquo;Transparent&rdquo; copy of the Document means a machine-readable copy,
represented in a format whose specification is available to the
general public, that is suitable for revising the document
straightforwardly with generic text editors or (for images composed of
pixels) generic paint programs or (for drawings) some widely available
drawing editor, and that is suitable for input to text formatters or
for automatic translation to a variety of formats suitable for input
to text formatters.  A copy made in an otherwise Transparent file
format whose markup, or absence of markup, has been arranged to thwart
or discourage subsequent modification by readers is not Transparent.
An image format is not Transparent if used for any substantial amount
of text.  A copy that is not &ldquo;Transparent&rdquo; is called &ldquo;Opaque&rdquo;.
</p>
<p>Examples of suitable formats for Transparent copies include plain
<small>ASCII</small> without markup, Texinfo input format, LaTeX input
format, <acronym>SGML</acronym> or <acronym>XML</acronym> using a publicly available
<acronym>DTD</acronym>, and standard-conforming simple <acronym>HTML</acronym>,
PostScript or <acronym>PDF</acronym> designed for human modification.  Examples
of transparent image formats include <acronym>PNG</acronym>, <acronym>XCF</acronym> and
<acronym>JPG</acronym>.  Opaque formats include proprietary formats that can be
read and edited only by proprietary word processors, <acronym>SGML</acronym> or
<acronym>XML</acronym> for which the <acronym>DTD</acronym> and/or processing tools are
not generally available, and the machine-generated <acronym>HTML</acronym>,
PostScript or <acronym>PDF</acronym> produced by some word processors for
output purposes only.
</p>
<p>The &ldquo;Title Page&rdquo; means, for a printed book, the title page itself,
plus such following pages as are needed to hold, legibly, the material
this License requires to appear in the title page.  For works in
formats which do not have any title page as such, &ldquo;Title Page&rdquo; means
the text near the most prominent appearance of the work&rsquo;s title,
preceding the beginning of the body of the text.
</p>
<p>The &ldquo;publisher&rdquo; means any person or entity that distributes copies
of the Document to the public.
</p>
<p>A section &ldquo;Entitled XYZ&rdquo; means a named subunit of the Document whose
title either is precisely XYZ or contains XYZ in parentheses following
text that translates XYZ in another language.  (Here XYZ stands for a
specific section name mentioned below, such as &ldquo;Acknowledgements&rdquo;,
&ldquo;Dedications&rdquo;, &ldquo;Endorsements&rdquo;, or &ldquo;History&rdquo;.)  To &ldquo;Preserve the Title&rdquo;
of such a section when you modify the Document means that it remains a
section &ldquo;Entitled XYZ&rdquo; according to this definition.
</p>
<p>The Document may include Warranty Disclaimers next to the notice which
states that this License applies to the Document.  These Warranty
Disclaimers are considered to be included by reference in this
License, but only as regards disclaiming warranties: any other
implication that these Warranty Disclaimers may have is void and has
no effect on the meaning of this License.
</p>
</li><li>
VERBATIM COPYING

<p>You may copy and distribute the Document in any medium, either
commercially or noncommercially, provided that this License, the
copyright notices, and the license notice saying this License applies
to the Document are reproduced in all copies, and that you add no other
conditions whatsoever to those of this License.  You may not use
technical measures to obstruct or control the reading or further
copying of the copies you make or distribute.  However, you may accept
compensation in exchange for copies.  If you distribute a large enough
number of copies you must also follow the conditions in section 3.
</p>
<p>You may also lend copies, under the same conditions stated above, and
you may publicly display copies.
</p>
</li><li>
COPYING IN QUANTITY

<p>If you publish printed copies (or copies in media that commonly have
printed covers) of the Document, numbering more than 100, and the
Document&rsquo;s license notice requires Cover Texts, you must enclose the
copies in covers that carry, clearly and legibly, all these Cover
Texts: Front-Cover Texts on the front cover, and Back-Cover Texts on
the back cover.  Both covers must also clearly and legibly identify
you as the publisher of these copies.  The front cover must present
the full title with all words of the title equally prominent and
visible.  You may add other material on the covers in addition.
Copying with changes limited to the covers, as long as they preserve
the title of the Document and satisfy these conditions, can be treated
as verbatim copying in other respects.
</p>
<p>If the required texts for either cover are too voluminous to fit
legibly, you should put the first ones listed (as many as fit
reasonably) on the actual cover, and continue the rest onto adjacent
pages.
</p>
<p>If you publish or distribute Opaque copies of the Document numbering
more than 100, you must either include a machine-readable Transparent
copy along with each Opaque copy, or state in or with each Opaque copy
a computer-network location from which the general network-using
public has access to download using public-standard network protocols
a complete Transparent copy of the Document, free of added material.
If you use the latter option, you must take reasonably prudent steps,
when you begin distribution of Opaque copies in quantity, to ensure
that this Transparent copy will remain thus accessible at the stated
location until at least one year after the last time you distribute an
Opaque copy (directly or through your agents or retailers) of that
edition to the public.
</p>
<p>It is requested, but not required, that you contact the authors of the
Document well before redistributing any large number of copies, to give
them a chance to provide you with an updated version of the Document.
</p>
</li><li>
MODIFICATIONS

<p>You may copy and distribute a Modified Version of the Document under
the conditions of sections 2 and 3 above, provided that you release
the Modified Version under precisely this License, with the Modified
Version filling the role of the Document, thus licensing distribution
and modification of the Modified Version to whoever possesses a copy
of it.  In addition, you must do these things in the Modified Version:
</p>
<ol>
<li>
Use in the Title Page (and on the covers, if any) a title distinct
from that of the Document, and from those of previous versions
(which should, if there were any, be listed in the History section
of the Document).  You may use the same title as a previous version
if the original publisher of that version gives permission.

</li><li>
List on the Title Page, as authors, one or more persons or entities
responsible for authorship of the modifications in the Modified
Version, together with at least five of the principal authors of the
Document (all of its principal authors, if it has fewer than five),
unless they release you from this requirement.

</li><li>
State on the Title page the name of the publisher of the
Modified Version, as the publisher.

</li><li>
Preserve all the copyright notices of the Document.

</li><li>
Add an appropriate copyright notice for your modifications
adjacent to the other copyright notices.

</li><li>
Include, immediately after the copyright notices, a license notice
giving the public permission to use the Modified Version under the
terms of this License, in the form shown in the Addendum below.

</li><li>
Preserve in that license notice the full lists of Invariant Sections
and required Cover Texts given in the Document&rsquo;s license notice.

</li><li>
Include an unaltered copy of this License.

</li><li>
Preserve the section Entitled &ldquo;History&rdquo;, Preserve its Title, and add
to it an item stating at least the title, year, new authors, and
publisher of the Modified Version as given on the Title Page.  If
there is no section Entitled &ldquo;History&rdquo; in the Document, create one
stating the title, year, authors, and publisher of the Document as
given on its Title Page, then add an item describing the Modified
Version as stated in the previous sentence.

</li><li>
Preserve the network location, if any, given in the Document for
public access to a Transparent copy of the Document, and likewise
the network locations given in the Document for previous versions
it was based on.  These may be placed in the &ldquo;History&rdquo; section.
You may omit a network location for a work that was published at
least four years before the Document itself, or if the original
publisher of the version it refers to gives permission.

</li><li>
For any section Entitled &ldquo;Acknowledgements&rdquo; or &ldquo;Dedications&rdquo;, Preserve
the Title of the section, and preserve in the section all the
substance and tone of each of the contributor acknowledgements and/or
dedications given therein.

</li><li>
Preserve all the Invariant Sections of the Document,
unaltered in their text and in their titles.  Section numbers
or the equivalent are not considered part of the section titles.

</li><li>
Delete any section Entitled &ldquo;Endorsements&rdquo;.  Such a section
may not be included in the Modified Version.

</li><li>
Do not retitle any existing section to be Entitled &ldquo;Endorsements&rdquo; or
to conflict in title with any Invariant Section.

</li><li>
Preserve any Warranty Disclaimers.
</li></ol>

<p>If the Modified Version includes new front-matter sections or
appendices that qualify as Secondary Sections and contain no material
copied from the Document, you may at your option designate some or all
of these sections as invariant.  To do this, add their titles to the
list of Invariant Sections in the Modified Version&rsquo;s license notice.
These titles must be distinct from any other section titles.
</p>
<p>You may add a section Entitled &ldquo;Endorsements&rdquo;, provided it contains
nothing but endorsements of your Modified Version by various
parties&mdash;for example, statements of peer review or that the text has
been approved by an organization as the authoritative definition of a
standard.
</p>
<p>You may add a passage of up to five words as a Front-Cover Text, and a
passage of up to 25 words as a Back-Cover Text, to the end of the list
of Cover Texts in the Modified Version.  Only one passage of
Front-Cover Text and one of Back-Cover Text may be added by (or
through arrangements made by) any one entity.  If the Document already
includes a cover text for the same cover, previously added by you or
by arrangement made by the same entity you are acting on behalf of,
you may not add another; but you may replace the old one, on explicit
permission from the previous publisher that added the old one.
</p>
<p>The author(s) and publisher(s) of the Document do not by this License
give permission to use their names for publicity for or to assert or
imply endorsement of any Modified Version.
</p>
</li><li>
COMBINING DOCUMENTS

<p>You may combine the Document with other documents released under this
License, under the terms defined in section 4 above for modified
versions, provided that you include in the combination all of the
Invariant Sections of all of the original documents, unmodified, and
list them all as Invariant Sections of your combined work in its
license notice, and that you preserve all their Warranty Disclaimers.
</p>
<p>The combined work need only contain one copy of this License, and
multiple identical Invariant Sections may be replaced with a single
copy.  If there are multiple Invariant Sections with the same name but
different contents, make the title of each such section unique by
adding at the end of it, in parentheses, the name of the original
author or publisher of that section if known, or else a unique number.
Make the same adjustment to the section titles in the list of
Invariant Sections in the license notice of the combined work.
</p>
<p>In the combination, you must combine any sections Entitled &ldquo;History&rdquo;
in the various original documents, forming one section Entitled
&ldquo;History&rdquo;; likewise combine any sections Entitled &ldquo;Acknowledgements&rdquo;,
and any sections Entitled &ldquo;Dedications&rdquo;.  You must delete all
sections Entitled &ldquo;Endorsements.&rdquo;
</p>
</li><li>
COLLECTIONS OF DOCUMENTS

<p>You may make a collection consisting of the Document and other documents
released under this License, and replace the individual copies of this
License in the various documents with a single copy that is included in
the collection, provided that you follow the rules of this License for
verbatim copying of each of the documents in all other respects.
</p>
<p>You may extract a single document from such a collection, and distribute
it individually under this License, provided you insert a copy of this
License into the extracted document, and follow this License in all
other respects regarding verbatim copying of that document.
</p>
</li><li>
AGGREGATION WITH INDEPENDENT WORKS

<p>A compilation of the Document or its derivatives with other separate
and independent documents or works, in or on a volume of a storage or
distribution medium, is called an &ldquo;aggregate&rdquo; if the copyright
resulting from the compilation is not used to limit the legal rights
of the compilation&rsquo;s users beyond what the individual works permit.
When the Document is included in an aggregate, this License does not
apply to the other works in the aggregate which are not themselves
derivative works of the Document.
</p>
<p>If the Cover Text requirement of section 3 is applicable to these
copies of the Document, then if the Document is less than one half of
the entire aggregate, the Document&rsquo;s Cover Texts may be placed on
covers that bracket the Document within the aggregate, or the
electronic equivalent of covers if the Document is in electronic form.
Otherwise they must appear on printed covers that bracket the whole
aggregate.
</p>
</li><li>
TRANSLATION

<p>Translation is considered a kind of modification, so you may
distribute translations of the Document under the terms of section 4.
Replacing Invariant Sections with translations requires special
permission from their copyright holders, but you may include
translations of some or all Invariant Sections in addition to the
original versions of these Invariant Sections.  You may include a
translation of this License, and all the license notices in the
Document, and any Warranty Disclaimers, provided that you also include
the original English version of this License and the original versions
of those notices and disclaimers.  In case of a disagreement between
the translation and the original version of this License or a notice
or disclaimer, the original version will prevail.
</p>
<p>If a section in the Document is Entitled &ldquo;Acknowledgements&rdquo;,
&ldquo;Dedications&rdquo;, or &ldquo;History&rdquo;, the requirement (section 4) to Preserve
its Title (section 1) will typically require changing the actual
title.
</p>
</li><li>
TERMINATION

<p>You may not copy, modify, sublicense, or distribute the Document
except as expressly provided under this License.  Any attempt
otherwise to copy, modify, sublicense, or distribute it is void, and
will automatically terminate your rights under this License.
</p>
<p>However, if you cease all violation of this License, then your license
from a particular copyright holder is reinstated (a) provisionally,
unless and until the copyright holder explicitly and finally
terminates your license, and (b) permanently, if the copyright holder
fails to notify you of the violation by some reasonable means prior to
60 days after the cessation.
</p>
<p>Moreover, your license from a particular copyright holder is
reinstated permanently if the copyright holder notifies you of the
violation by some reasonable means, this is the first time you have
received notice of violation of this License (for any work) from that
copyright holder, and you cure the violation prior to 30 days after
your receipt of the notice.
</p>
<p>Termination of your rights under this section does not terminate the
licenses of parties who have received copies or rights from you under
this License.  If your rights have been terminated and not permanently
reinstated, receipt of a copy of some or all of the same material does
not give you any rights to use it.
</p>
</li><li>
FUTURE REVISIONS OF THIS LICENSE

<p>The Free Software Foundation may publish new, revised versions
of the GNU Free Documentation License from time to time.  Such new
versions will be similar in spirit to the present version, but may
differ in detail to address new problems or concerns.  See
<a href="http://www.gnu.org/copyleft">http://www.gnu.org/copyleft/</a>.
</p>
<p>Each version of the License is given a distinguishing version number.
If the Document specifies that a particular numbered version of this
License &ldquo;or any later version&rdquo; applies to it, you have the option of
following the terms and conditions either of that specified version or
of any later version that has been published (not as a draft) by the
Free Software Foundation.  If the Document does not specify a version
number of this License, you may choose any version ever published (not
as a draft) by the Free Software Foundation.  If the Document
specifies that a proxy can decide which future versions of this
License can be used, that proxy&rsquo;s public statement of acceptance of a
version permanently authorizes you to choose that version for the
Document.
</p>
</li><li>
RELICENSING

<p>&ldquo;Massive Multiauthor Collaboration Site&rdquo; (or &ldquo;MMC Site&rdquo;) means any
World Wide Web server that publishes copyrightable works and also
provides prominent facilities for anybody to edit those works.  A
public wiki that anybody can edit is an example of such a server.  A
&ldquo;Massive Multiauthor Collaboration&rdquo; (or &ldquo;MMC&rdquo;) contained in the
site means any set of copyrightable works thus published on the MMC
site.
</p>
<p>&ldquo;CC-BY-SA&rdquo; means the Creative Commons Attribution-Share Alike 3.0
license published by Creative Commons Corporation, a not-for-profit
corporation with a principal place of business in San Francisco,
California, as well as future copyleft versions of that license
published by that same organization.
</p>
<p>&ldquo;Incorporate&rdquo; means to publish or republish a Document, in whole or
in part, as part of another Document.
</p>
<p>An MMC is &ldquo;eligible for relicensing&rdquo; if it is licensed under this
License, and if all works that were first published under this License
somewhere other than this MMC, and subsequently incorporated in whole
or in part into the MMC, (1) had no cover texts or invariant sections,
and (2) were thus incorporated prior to November 1, 2008.
</p>
<p>The operator of an MMC Site may republish an MMC contained in the site
under CC-BY-SA on the same site at any time before August 1, 2009,
provided the MMC is eligible for relicensing.
</p>
</li></ol>


<a name="ADDENDUM_003a-How-to-use-this-License-for-your-documents"></a>
<h2 class="heading">ADDENDUM: How to use this License for your documents</h2>

<p>To use this License in a document you have written, include a copy of
the License in the document and put the following copyright and
license notices just after the title page:
</p>
<table><tr><td>&nbsp;</td><td><pre class="smallexample">  Copyright (C)  <var>year</var>  <var>your name</var>.
  Permission is granted to copy, distribute and/or modify this document
  under the terms of the GNU Free Documentation License, Version 1.3
  or any later version published by the Free Software Foundation;
  with no Invariant Sections, no Front-Cover Texts, and no Back-Cover
  Texts.  A copy of the license is included in the section entitled ``GNU
  Free Documentation License''.
</pre></td></tr></table>

<p>If you have Invariant Sections, Front-Cover Texts and Back-Cover Texts,
replace the &ldquo;with&hellip;Texts.&rdquo; line with this:
</p>
<table><tr><td>&nbsp;</td><td><pre class="smallexample">    with the Invariant Sections being <var>list their titles</var>, with
    the Front-Cover Texts being <var>list</var>, and with the Back-Cover Texts
    being <var>list</var>.
</pre></td></tr></table>

<p>If you have Invariant Sections without Cover Texts, or some other
combination of the three, merge those two alternatives to suit the
situation.
</p>
<p>If your document contains nontrivial examples of program code, we
recommend releasing these examples in parallel under your choice of
free software license, such as the GNU General Public License,
to permit their use in free software.
</p>


<hr size="6">
<a name="g_t_00cdndice-de-LilyPond"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="#gnu-free-documentation-license" title="Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior"> &lt;&lt; GNU Free Documentation License&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[&nbsp; &gt;&gt; ]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="#gnu-free-documentation-license" title="Secci&oacute;n anterior en orden de lectura" accesskey="p" rel="previous"> &lt; GNU Free Documentation License&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="#index" title="Subir secci&oacute;n" accesskey="u" rel="up">&nbsp; Subir :&nbsp;Top&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[&nbsp; &gt; ]</td></tr></table>
<a name="lilypond-index"></a>
<h1 class="appendix">E. Índice de LilyPond</h1>

<table><tr><th valign="top">Saltar a: &nbsp; </th><td><a href="#lilypond-index_cp_symbol-1" class="summary-letter"><b>#</b></a>
 &nbsp; 
<a href="#lilypond-index_cp_symbol-2" class="summary-letter"><b>$</b></a>
 &nbsp; 
<a href="#lilypond-index_cp_symbol-3" class="summary-letter"><b>\</b></a>
 &nbsp; 
<br>
<a href="#lilypond-index_cp_letter-A" class="summary-letter"><b>A</b></a>
 &nbsp; 
<a href="#lilypond-index_cp_letter-B" class="summary-letter"><b>B</b></a>
 &nbsp; 
<a href="#lilypond-index_cp_letter-C" class="summary-letter"><b>C</b></a>
 &nbsp; 
<a href="#lilypond-index_cp_letter-D" class="summary-letter"><b>D</b></a>
 &nbsp; 
<a href="#lilypond-index_cp_letter-E" class="summary-letter"><b>E</b></a>
 &nbsp; 
<a href="#lilypond-index_cp_letter-F" class="summary-letter"><b>F</b></a>
 &nbsp; 
<a href="#lilypond-index_cp_letter-G" class="summary-letter"><b>G</b></a>
 &nbsp; 
<a href="#lilypond-index_cp_letter-I" class="summary-letter"><b>I</b></a>
 &nbsp; 
<a href="#lilypond-index_cp_letter-L" class="summary-letter"><b>L</b></a>
 &nbsp; 
<a href="#lilypond-index_cp_letter-M" class="summary-letter"><b>M</b></a>
 &nbsp; 
<a href="#lilypond-index_cp_letter-N" class="summary-letter"><b>N</b></a>
 &nbsp; 
<a href="#lilypond-index_cp_letter-O" class="summary-letter"><b>O</b></a>
 &nbsp; 
<a href="#lilypond-index_cp_letter-P" class="summary-letter"><b>P</b></a>
 &nbsp; 
<a href="#lilypond-index_cp_letter-R" class="summary-letter"><b>R</b></a>
 &nbsp; 
<a href="#lilypond-index_cp_letter-S" class="summary-letter"><b>S</b></a>
 &nbsp; 
<a href="#lilypond-index_cp_letter-T" class="summary-letter"><b>T</b></a>
 &nbsp; 
<a href="#lilypond-index_cp_letter-V" class="summary-letter"><b>V</b></a>
 &nbsp; 
</td></tr></table>
<table border="0" class="index-cp">
<tr><td></td><th align="left">Entrada de &iacute;ndice</th><th align="left"> Secci&oacute;n</th></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="lilypond-index_cp_symbol-1">#</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-_0023"><code>#</code></a></td><td valign="top"><a href="#lilypond-scheme-syntax">A.2.1 Sintaxis del Scheme de LilyPond</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_0023-2"><code>#</code></a></td><td valign="top"><a href="#importing-scheme-in-lilypond">A.2.4 Importación de Scheme dentro de LilyPond</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_0023-4"><code>#</code></a></td><td valign="top"><a href="#lilypond-code-blocks">B.1 Bloques de código de LilyPond</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_0023_0023f"><code>##f</code></a></td><td valign="top"><a href="#scheme-simple-data-types">A.1.3 Tipos de datos simples de Scheme</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_0023_0023t"><code>##t</code></a></td><td valign="top"><a href="#scheme-simple-data-types">A.1.3 Tipos de datos simples de Scheme</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_0023_0040"><code>#@</code></a></td><td valign="top"><a href="#lilypond-scheme-syntax">A.2.1 Sintaxis del Scheme de LilyPond</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_0023_0040-2"><code>#@</code></a></td><td valign="top"><a href="#importing-scheme-in-lilypond">A.2.4 Importación de Scheme dentro de LilyPond</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_0023_007b-_2026-_0023_007d"><code>#{ &hellip; #}</code></a></td><td valign="top"><a href="#lilypond-code-blocks">B.1 Bloques de código de LilyPond</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="lilypond-index_cp_symbol-2">$</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-_0024"><code>$</code></a></td><td valign="top"><a href="#lilypond-scheme-syntax">A.2.1 Sintaxis del Scheme de LilyPond</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_0024-2"><code>$</code></a></td><td valign="top"><a href="#importing-scheme-in-lilypond">A.2.4 Importación de Scheme dentro de LilyPond</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_0024-4"><code>$</code></a></td><td valign="top"><a href="#lilypond-code-blocks">B.1 Bloques de código de LilyPond</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_0024_0040"><code>$@</code></a></td><td valign="top"><a href="#lilypond-scheme-syntax">A.2.1 Sintaxis del Scheme de LilyPond</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_0024_0040-2"><code>$@</code></a></td><td valign="top"><a href="#importing-scheme-in-lilypond">A.2.4 Importación de Scheme dentro de LilyPond</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="lilypond-index_cp_symbol-3">\</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-_005capplyContext"><code>\applyContext</code></a></td><td valign="top"><a href="#context-evaluation">B.6.1 Evaluación de contextos</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_005capplyOutput"><code>\applyOutput</code></a></td><td valign="top"><a href="#running-a-function-on-all-layout-objects">B.6.2 Ejecutar una función sobre todos los objetos de la presentación</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_005cdisplayLilyMusic"><code>\displayLilyMusic</code></a></td><td valign="top"><a href="#music-properties">A.3.2 Propiedades musicales</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_005cdisplayMusic"><code>\displayMusic</code></a></td><td valign="top"><a href="#displaying-music-expressions">A.3.1 Presentación de las expresiones musicales</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_005cdisplayScheme"><code>\displayScheme</code></a></td><td valign="top"><a href="#markup-construction-in-scheme">B.5.1 Construcción de elementos de marcado en Scheme</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_005cmarkup"><code>\markup</code></a></td><td valign="top"><a href="#markup-command-definition-syntax">Sintaxis de la definición de instrucciones de marcado</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_005ctemporary"><code>\temporary</code></a></td><td valign="top"><a href="#intermediate-substitution-functions">B.3.4 Funciones de sustitución intermedias</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_005cvoid"><code>\void</code></a></td><td valign="top"><a href="#void-scheme-functions">B.2.3 Funciones de Scheme vacías</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="lilypond-index_cp_letter-A">A</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-acceder-a-Scheme">acceder a Scheme</a></td><td valign="top"><a href="#scheme-tutorial">A. Tutorial de Scheme</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-almacenamiento-interno">almacenamiento interno</a></td><td valign="top"><a href="#displaying-music-expressions">A.3.1 Presentación de las expresiones musicales</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-ApplyOutputEvent"><code>ApplyOutputEvent</code></a></td><td valign="top"><a href="#running-a-function-on-all-layout-objects">B.6.2 Ejecutar una función sobre todos los objetos de la presentación</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="lilypond-index_cp_letter-B">B</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Bloques-de-codigo-de-LilyPond">Bloques de código de LilyPond</a></td><td valign="top"><a href="#lilypond-code-blocks">B.1 Bloques de código de LilyPond</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="lilypond-index_cp_letter-C">C</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-codigo_002c-llamadas-durante-la-interpretacion">código, llamadas durante la interpretación</a></td><td valign="top"><a href="#context-evaluation">B.6.1 Evaluación de contextos</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-codigo_002c-llamar-sobre-objetos-de-presentacion">código, llamar sobre objetos de presentación</a></td><td valign="top"><a href="#running-a-function-on-all-layout-objects">B.6.2 Ejecutar una función sobre todos los objetos de la presentación</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="lilypond-index_cp_letter-D">D</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-define_002devent_002dfunction"><code>define-event-function</code></a></td><td valign="top"><a href="#event-functions">B.4 Funciones de eventos</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-define_002dmarkup_002dlist_002dcommand"><code>define-markup-list-command</code></a></td><td valign="top"><a href="#new-markup-list-command-definition">B.5.4 Definición de nuevas instrucciones de lista de marcado</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-define_002dmusic_002dfunction"><code>define-music-function</code></a></td><td valign="top"><a href="#music-function-definitions">B.3.1 Definiciones de funciones musicales</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-define_002dscheme_002dfunction"><code>define-scheme-function</code></a></td><td valign="top"><a href="#scheme-function-definitions">B.2.1 Definición de funciones de Scheme</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-define_002dvoid_002dfunction"><code>define-void-function</code></a></td><td valign="top"><a href="#void-scheme-functions">B.2.3 Funciones de Scheme vacías</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-definicion-de-funciones-musicales">definición de funciones musicales</a></td><td valign="top"><a href="#music-function-definitions">B.3.1 Definiciones de funciones musicales</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-displayMusic">displayMusic</a></td><td valign="top"><a href="#displaying-music-expressions">A.3.1 Presentación de las expresiones musicales</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="lilypond-index_cp_letter-E">E</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Ejemplos-de-funciones-de-sustitucion"><code>Ejemplos de funciones de sustitución</code></a></td><td valign="top"><a href="#simple-substitution-functions">B.3.3 Funciones de sustitución sencillas</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-evaluar-Scheme">evaluar Scheme</a></td><td valign="top"><a href="#scheme-tutorial">A. Tutorial de Scheme</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-event-functions">event functions</a></td><td valign="top"><a href="#event-functions">B.4 Funciones de eventos</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="lilypond-index_cp_letter-F">F</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-funciones-musicales">funciones musicales</a></td><td valign="top"><a href="#music-functions">B.3 Funciones musicales</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="lilypond-index_cp_letter-G">G</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-GraceMusic"><code>GraceMusic</code></a></td><td valign="top"><a href="#internal-music-representation">A.2.7 Representación interna de la música</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-GUILE">GUILE</a></td><td valign="top"><a href="#scheme-tutorial">A. Tutorial de Scheme</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="lilypond-index_cp_letter-I">I</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-imprimir-expresiones-musicales">imprimir expresiones musicales</a></td><td valign="top"><a href="#displaying-music-expressions">A.3.1 Presentación de las expresiones musicales</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Instrucciones-de"><code>Instrucciones de</code></a></td><td valign="top"><a href="#a-complete-example">Un ejemplo completo</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-interpret_002dmarkup"><code>interpret-markup</code></a></td><td valign="top"><a href="#markup-command-definition-syntax">Sintaxis de la definición de instrucciones de marcado</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-interpret_002dmarkup_002dlist"><code>interpret-markup-list</code></a></td><td valign="top"><a href="#new-markup-list-command-definition">B.5.4 Definición de nuevas instrucciones de lista de marcado</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="lilypond-index_cp_letter-L">L</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-LilyPond-grammar"><code>LilyPond grammar</code></a></td><td valign="top"><a href="#lilypond-scheme-syntax">A.2.1 Sintaxis del Scheme de LilyPond</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-LilyPond_002c-bloques-de-codigo-de">LilyPond, bloques de código de</a></td><td valign="top"><a href="#lilypond-code-blocks">B.1 Bloques de código de LilyPond</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-LISP">LISP</a></td><td valign="top"><a href="#scheme-tutorial">A. Tutorial de Scheme</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-ly_003aassoc_002dget"><code>ly:assoc-get</code></a></td><td valign="top"><a href="#context-evaluation">B.6.1 Evaluación de contextos</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-ly_003acontext_002dgrob_002ddefinition"><code>ly:context-grob-definition</code></a></td><td valign="top"><a href="#context-evaluation">B.6.1 Evaluación de contextos</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-ly_003acontext_002dproperty"><code>ly:context-property</code></a></td><td valign="top"><a href="#context-evaluation">B.6.1 Evaluación de contextos</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-ly_003acontext_002dpushpop_002dproperty"><code>ly:context-pushpop-property</code></a></td><td valign="top"><a href="#context-evaluation">B.6.1 Evaluación de contextos</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-ly_003acontext_002dset_002dproperty_0021"><code>ly:context-set-property!</code></a></td><td valign="top"><a href="#context-evaluation">B.6.1 Evaluación de contextos</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="lilypond-index_cp_letter-M">M</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-make_002dapply_002dcontext"><code>make-apply-context</code></a></td><td valign="top"><a href="#context-evaluation">B.6.1 Evaluación de contextos</a></td></tr>
<tr><td></td><td valign="top"><a href="#index"><code>Manuales</code></a></td><td valign="top"><a href="#index">LilyPond &mdash; Extender</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Manuales"><code>Manuales</code></a></td><td valign="top"><a href="#index">LilyPond &mdash; Extender</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-marcado_002c-definir-instrucciones-de">marcado, definir instrucciones de</a></td><td valign="top"><a href="#markup-construction-in-scheme">B.5.1 Construcción de elementos de marcado en Scheme</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-markup-macro">markup macro</a></td><td valign="top"><a href="#markup-command-definition-syntax">Sintaxis de la definición de instrucciones de marcado</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Music-classes"><code>Music classes</code></a></td><td valign="top"><a href="#internal-music-representation">A.2.7 Representación interna de la música</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Music-expressions"><code>Music expressions</code></a></td><td valign="top"><a href="#internal-music-representation">A.2.7 Representación interna de la música</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Music-properties"><code>Music properties</code></a></td><td valign="top"><a href="#internal-music-representation">A.2.7 Representación interna de la música</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="lilypond-index_cp_letter-N">N</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-NoteEvent"><code>NoteEvent</code></a></td><td valign="top"><a href="#internal-music-representation">A.2.7 Representación interna de la música</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-NoteEvent-1"><code>NoteEvent</code></a></td><td valign="top"><a href="#internal-music-representation">A.2.7 Representación interna de la música</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-NoteHead"><code>NoteHead</code></a></td><td valign="top"><a href="#running-a-function-on-all-layout-objects">B.6.2 Ejecutar una función sobre todos los objetos de la presentación</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="lilypond-index_cp_letter-O">O</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Otras-fuentes-de"><code>Otras fuentes de</code></a></td><td valign="top"><a href="#scheme-sandbox">A.1.1 Cajón de arena de Scheme</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="lilypond-index_cp_letter-P">P</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Predicados-de-tipo-predefinidos"><code>Predicados de tipo predefinidos</code></a></td><td valign="top"><a href="#scheme-function-definitions">B.2.1 Definición de funciones de Scheme</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Predicados-de-tipo-predefinidos-1"><code>Predicados de tipo predefinidos</code></a></td><td valign="top"><a href="#Vease-tambien">Véase también</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Predicados-de-tipo-predefinidos-2"><code>Predicados de tipo predefinidos</code></a></td><td valign="top"><a href="#music-function-definitions">B.3.1 Definiciones de funciones musicales</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Predicados-de-tipo-predefinidos-3"><code>Predicados de tipo predefinidos</code></a></td><td valign="top"><a href="#Vease-tambien-2">Véase también</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-propiedades-frente-a-variables">propiedades frente a variables</a></td><td valign="top"><a href="#object-properties">A.2.5 Propiedades de los objetos</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-propiedades_002c-recuperar-valor-anterior">propiedades, recuperar valor anterior</a></td><td valign="top"><a href="#intermediate-substitution-functions">B.3.4 Funciones de sustitución intermedias</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="lilypond-index_cp_letter-R">R</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-RepeatedMusic"><code>RepeatedMusic</code></a></td><td valign="top"><a href="#internal-music-representation">A.2.7 Representación interna de la música</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-representacion-interna_002c-impresion-de">representación interna, impresión de</a></td><td valign="top"><a href="#displaying-music-expressions">A.3.1 Presentación de las expresiones musicales</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="lilypond-index_cp_letter-S">S</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Scheme">Scheme</a></td><td valign="top"><a href="#scheme-tutorial">A. Tutorial de Scheme</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Scheme_002c-codigo-en-linea">Scheme, código en línea</a></td><td valign="top"><a href="#scheme-tutorial">A. Tutorial de Scheme</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Scheme_002c-funciones-de-_0028sintaxis-de-LilyPond_0029">Scheme, funciones de (sintaxis de LilyPond)</a></td><td valign="top"><a href="#scheme-functions">B.2 Funciones de Scheme</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-SequentialMusic"><code>SequentialMusic</code></a></td><td valign="top"><a href="#internal-music-representation">A.2.7 Representación interna de la música</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-SimultaneousMusic"><code>SimultaneousMusic</code></a></td><td valign="top"><a href="#internal-music-representation">A.2.7 Representación interna de la música</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-sobreescrituras-temporales">sobreescrituras temporales</a></td><td valign="top"><a href="#intermediate-substitution-functions">B.3.4 Funciones de sustitución intermedias</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Stem"><code>Stem</code></a></td><td valign="top"><a href="#running-a-function-on-all-layout-objects">B.6.2 Ejecutar una función sobre todos los objetos de la presentación</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="lilypond-index_cp_letter-T">T</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-temporales_002c-sobreescrituras">temporales, sobreescrituras</a></td><td valign="top"><a href="#intermediate-substitution-functions">B.3.4 Funciones de sustitución intermedias</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Tie"><code>Tie</code></a></td><td valign="top"><a href="#difficult-tweaks">B.8 Trucos difíciles</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="lilypond-index_cp_letter-V">V</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-variables-frente-a-propiedades">variables frente a propiedades</a></td><td valign="top"><a href="#object-properties">A.2.5 Propiedades de los objetos</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-void"><code>void</code></a></td><td valign="top"><a href="#displaying-music-expressions">A.3.1 Presentación de las expresiones musicales</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
</table>
<table><tr><th valign="top">Saltar a: &nbsp; </th><td><a href="#lilypond-index_cp_symbol-1" class="summary-letter"><b>#</b></a>
 &nbsp; 
<a href="#lilypond-index_cp_symbol-2" class="summary-letter"><b>$</b></a>
 &nbsp; 
<a href="#lilypond-index_cp_symbol-3" class="summary-letter"><b>\</b></a>
 &nbsp; 
<br>
<a href="#lilypond-index_cp_letter-A" class="summary-letter"><b>A</b></a>
 &nbsp; 
<a href="#lilypond-index_cp_letter-B" class="summary-letter"><b>B</b></a>
 &nbsp; 
<a href="#lilypond-index_cp_letter-C" class="summary-letter"><b>C</b></a>
 &nbsp; 
<a href="#lilypond-index_cp_letter-D" class="summary-letter"><b>D</b></a>
 &nbsp; 
<a href="#lilypond-index_cp_letter-E" class="summary-letter"><b>E</b></a>
 &nbsp; 
<a href="#lilypond-index_cp_letter-F" class="summary-letter"><b>F</b></a>
 &nbsp; 
<a href="#lilypond-index_cp_letter-G" class="summary-letter"><b>G</b></a>
 &nbsp; 
<a href="#lilypond-index_cp_letter-I" class="summary-letter"><b>I</b></a>
 &nbsp; 
<a href="#lilypond-index_cp_letter-L" class="summary-letter"><b>L</b></a>
 &nbsp; 
<a href="#lilypond-index_cp_letter-M" class="summary-letter"><b>M</b></a>
 &nbsp; 
<a href="#lilypond-index_cp_letter-N" class="summary-letter"><b>N</b></a>
 &nbsp; 
<a href="#lilypond-index_cp_letter-O" class="summary-letter"><b>O</b></a>
 &nbsp; 
<a href="#lilypond-index_cp_letter-P" class="summary-letter"><b>P</b></a>
 &nbsp; 
<a href="#lilypond-index_cp_letter-R" class="summary-letter"><b>R</b></a>
 &nbsp; 
<a href="#lilypond-index_cp_letter-S" class="summary-letter"><b>S</b></a>
 &nbsp; 
<a href="#lilypond-index_cp_letter-T" class="summary-letter"><b>T</b></a>
 &nbsp; 
<a href="#lilypond-index_cp_letter-V" class="summary-letter"><b>V</b></a>
 &nbsp; 
</td></tr></table>

<hr size="6">
<a name="SEC_Contents"></a>
<table class="nav_table">
<tr><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td></tr></table>
<h1>&Iacute;ndice General</h1>
<div class="contents">

<ul class="toc">
  <li><a name="toc-Tutorial-de-Scheme-1" href="#scheme-tutorial">A. Tutorial de Scheme</a>
  <ul class="toc">
    <li><a name="toc-Introduccion-a-Scheme" href="#introduction-to-scheme">A.1 Introducción a Scheme</a>
    <ul class="toc">
      <li><a name="toc-Cajon-de-arena-de-Scheme" href="#scheme-sandbox">A.1.1 Cajón de arena de Scheme</a></li>
      <li><a name="toc-Variables-de-Scheme-1" href="#scheme-variables">A.1.2 Variables de Scheme</a></li>
      <li><a name="toc-Tipos-de-datos-simples-de-Scheme-1" href="#scheme-simple-data-types">A.1.3 Tipos de datos simples de Scheme</a></li>
      <li><a name="toc-Tipos-de-datos-compuestos-de-Scheme-1" href="#scheme-compound-data-types">A.1.4 Tipos de datos compuestos de Scheme</a>
      <ul class="toc">
        <li><a name="toc-Parejas-1" href="#pairs">Parejas</a></li>
        <li><a name="toc-Listas-1" href="#lists">Listas</a></li>
        <li><a name="toc-Listas-asociativas-_0028listas_002dA_0029-1" href="#association-lists-_0028alists_0029">Listas asociativas (listas-A)</a></li>
        <li><a name="toc-Tablas-de-hash-1" href="#hash-tables">Tablas de hash</a></li>
      </ul></li>
      <li><a name="toc-Calculos-en-Scheme" href="#calculations-in-scheme">A.1.5 Cálculos en Scheme</a></li>
      <li><a name="toc-Procedimientos-de-Scheme-1" href="#scheme-procedures">A.1.6 Procedimientos de Scheme</a>
      <ul class="toc">
        <li><a name="toc-Definir-procedimientos-1" href="#defining-procedures">Definir procedimientos</a></li>
        <li><a name="toc-Predicados-1" href="#predicates">Predicados</a></li>
        <li><a name="toc-Valores-de-retorno-1" href="#return-values">Valores de retorno</a></li>
      </ul></li>
      <li><a name="toc-Condicionales-de-Scheme-1" href="#scheme-conditionals">A.1.7 Condicionales de Scheme</a>
      <ul class="toc">
        <li><a name="toc-if-1" href="#if">if</a></li>
        <li><a name="toc-cond-1" href="#cond">cond</a></li>
      </ul>
</li>
    </ul></li>
    <li><a name="toc-Scheme-dentro-de-LilyPond-1" href="#scheme-in-lilypond">A.2 Scheme dentro de LilyPond</a>
    <ul class="toc">
      <li><a name="toc-Sintaxis-del-Scheme-de-LilyPond-1" href="#lilypond-scheme-syntax">A.2.1 Sintaxis del Scheme de LilyPond</a></li>
      <li><a name="toc-Variables-de-LilyPond-1" href="#lilypond-variables">A.2.2 Variables de LilyPond</a></li>
      <li><a name="toc-Variables-de-entrada-y-Scheme-1" href="#input-variables-and-scheme">A.2.3 Variables de entrada y Scheme</a></li>
      <li><a name="toc-Importacion-de-Scheme-dentro-de-LilyPond" href="#importing-scheme-in-lilypond">A.2.4 Importación de Scheme dentro de LilyPond</a></li>
      <li><a name="toc-Propiedades-de-los-objetos-1" href="#object-properties">A.2.5 Propiedades de los objetos</a></li>
      <li><a name="toc-Variables-de-LilyPond-compuestas-1" href="#lilypond-compound-variables">A.2.6 Variables de LilyPond compuestas</a>
      <ul class="toc">
        <li><a name="toc-Desplazamientos-1" href="#offsets">Desplazamientos</a></li>
        <li><a name="toc-Fracciones-1" href="#fracciones">Fracciones</a></li>
        <li><a name="toc-Dimensiones-1" href="#extents">Dimensiones</a></li>
        <li><a name="toc-Listas_002dA-de-propiedades-1" href="#property-alists">Listas-A de propiedades</a></li>
        <li><a name="toc-Cadenas-de-listas_002dA-1" href="#alist-chains">Cadenas de listas-A</a></li>
      </ul></li>
      <li><a name="toc-Representacion-interna-de-la-musica" href="#internal-music-representation">A.2.7 Representación interna de la música</a></li>
    </ul></li>
    <li><a name="toc-Construir-funciones-complicadas-1" href="#building-complicated-functions">A.3 Construir funciones complicadas</a>
    <ul class="toc">
      <li><a name="toc-Presentacion-de-las-expresiones-musicales" href="#displaying-music-expressions">A.3.1 Presentación de las expresiones musicales</a></li>
      <li><a name="toc-Propiedades-musicales-1" href="#music-properties">A.3.2 Propiedades musicales</a></li>
      <li><a name="toc-Duplicar-una-nota-con-ligaduras-_0028ejemplo_0029-1" href="#doubling-a-note-with-slurs-_0028example_0029">A.3.3 Duplicar una nota con ligaduras (ejemplo)</a></li>
      <li><a name="toc-Anadir-articulaciones-a-las-notas-_0028ejemplo_0029" href="#adding-articulation-to-notes-_0028example_0029">A.3.4 Añadir articulaciones a las notas (ejemplo)</a></li>
    </ul>
</li>
  </ul></li>
  <li><a name="toc-Interfaces-para-programadores-1" href="#interfaces-for-programmers">B. Interfaces para programadores</a>
  <ul class="toc">
    <li><a name="toc-Bloques-de-codigo-de-LilyPond" href="#lilypond-code-blocks">B.1 Bloques de código de LilyPond</a></li>
    <li><a name="toc-Funciones-de-Scheme-1" href="#scheme-functions">B.2 Funciones de Scheme</a>
    <ul class="toc">
      <li><a name="toc-Definicion-de-funciones-de-Scheme" href="#scheme-function-definitions">B.2.1 Definición de funciones de Scheme</a></li>
      <li><a name="toc-Uso-de-las-funciones-de-Scheme-1" href="#scheme-function-usage">B.2.2 Uso de las funciones de Scheme</a></li>
      <li><a name="toc-Funciones-de-Scheme-vacias" href="#void-scheme-functions">B.2.3 Funciones de Scheme vacías</a></li>
    </ul></li>
    <li><a name="toc-Funciones-musicales-1" href="#music-functions">B.3 Funciones musicales</a>
    <ul class="toc">
      <li><a name="toc-Definiciones-de-funciones-musicales-1" href="#music-function-definitions">B.3.1 Definiciones de funciones musicales</a></li>
      <li><a name="toc-Uso-de-las-funciones-musicales-1" href="#music-function-usage">B.3.2 Uso de las funciones musicales</a></li>
      <li><a name="toc-Funciones-de-sustitucion-sencillas" href="#simple-substitution-functions">B.3.3 Funciones de sustitución sencillas</a></li>
      <li><a name="toc-Funciones-de-sustitucion-intermedias" href="#intermediate-substitution-functions">B.3.4 Funciones de sustitución intermedias</a></li>
      <li><a name="toc-Matematicas-dentro-de-las-funciones" href="#mathematics-in-functions">B.3.5 Matemáticas dentro de las funciones</a></li>
      <li><a name="toc-Funciones-sin-argumentos-1" href="#functions-without-arguments">B.3.6 Funciones sin argumentos</a></li>
      <li><a name="toc-Funciones-musicales-vacias" href="#void-music-functions">B.3.7 Funciones musicales vacías</a></li>
    </ul></li>
    <li><a name="toc-Funciones-de-eventos-1" href="#event-functions">B.4 Funciones de eventos</a></li>
    <li><a name="toc-Funciones-de-marcado-1" href="#markup-functions">B.5 Funciones de marcado</a>
    <ul class="toc">
      <li><a name="toc-Construccion-de-elementos-de-marcado-en-Scheme" href="#markup-construction-in-scheme">B.5.1 Construcción de elementos de marcado en Scheme</a></li>
      <li><a name="toc-Como-funcionan-internamente-los-elementos-de-marcado" href="#how-markups-work-internally">B.5.2 Cómo funcionan internamente los elementos de marcado</a></li>
      <li><a name="toc-Definicion-de-una-instruccion-de-marcado-nueva" href="#new-markup-command-definition">B.5.3 Definición de una instrucción de marcado nueva</a>
      <ul class="toc">
        <li><a name="toc-Sintaxis-de-la-definicion-de-instrucciones-de-marcado" href="#markup-command-definition-syntax">Sintaxis de la definición de instrucciones de marcado</a></li>
        <li><a name="toc-Acerca-de-las-propiedades-1" href="#on-properties">Acerca de las propiedades</a></li>
        <li><a name="toc-Un-ejemplo-completo-1" href="#a-complete-example">Un ejemplo completo</a></li>
        <li><a name="toc-Adaptacion-de-instrucciones-incorporadas" href="#adapting-builtin-commands">Adaptación de instrucciones incorporadas</a></li>
      </ul></li>
      <li><a name="toc-Definicion-de-nuevas-instrucciones-de-lista-de-marcado" href="#new-markup-list-command-definition">B.5.4 Definición de nuevas instrucciones de lista de marcado</a></li>
    </ul></li>
    <li><a name="toc-Contextos-para-programadores-1" href="#contexts-for-programmers">B.6 Contextos para programadores</a>
    <ul class="toc">
      <li><a name="toc-Evaluacion-de-contextos" href="#context-evaluation">B.6.1 Evaluación de contextos</a></li>
      <li><a name="toc-Ejecutar-una-funcion-sobre-todos-los-objetos-de-la-presentacion" href="#running-a-function-on-all-layout-objects">B.6.2 Ejecutar una función sobre todos los objetos de la presentación</a></li>
    </ul></li>
    <li><a name="toc-Funciones-de-callback-1" href="#callback-functions">B.7 Funciones de callback</a></li>
    <li><a name="toc-Trucos-dificiles" href="#difficult-tweaks">B.8 Trucos difíciles</a></li>
  </ul></li>
  <li><a name="toc-Interfaces-de-Scheme-de-LilyPond-1" href="#lilypond-scheme-interfaces">C. Interfaces de Scheme de LilyPond</a></li>
  <li><a name="toc-GNU-Free-Documentation-License-1" href="#gnu-free-documentation-license">D. GNU Free Documentation License</a></li>
  <li><a name="toc-Indice-de-LilyPond" href="#lilypond-index">E. Índice de LilyPond</a></li>
</ul>
</div>
<hr size="1">
<a name="SEC_About"></a>
<table class="nav_table">
<tr><td valign="middle" align="center" colspan="3">[<a href="#index" title="Portada del documento" rel="start">Arriba</a>][<a href="#SEC_Contents" title="&Iacute;ndice general" rel="contents">&Iacute;ndice general</a>][<a href="#lilypond-index" title="&Iacute;ndice" rel="index">&Iacute;ndice</a>][<a href="#SEC_About" title="Acerca de (p&aacute;gina de ayuda)" rel="help"> ? </a>]</td></tr></table>
<h1>Acerca de este documento</h1>
<p>
  Este documento ha sido generado por <em>GUB</em> el <em>el 6 agosto 2017</em> utilizando <a href="http://www.nongnu.org/texi2html/"><em>texi2html 1.82</em></a>.
</p>
<p>
  Los botones de los paneles de navegaci&oacute;n tienen el significado siguiente:
</p>
<table border="1">
  <tr>
    <th> Bot&oacute;n </th>
    <th> Nombre </th>
    <th> Ir a </th>
    <th> Desde 1.2.3 ir a</th>
  </tr>
  <tr>
    <td align="center"> [] </td>
    <td align="center"></td>
    <td></td>
    <td></td>
  </tr>
  <tr>
    <td align="center"> [ &lt;&lt; ] </td>
    <td align="center">Retroceso r&aacute;pido</td>
    <td>Inicio de este cap&iacute;tulo o cap&iacute;tulo anterior</td>
    <td>1</td>
  </tr>
  <tr>
    <td align="center"> [] </td>
    <td align="center"></td>
    <td></td>
    <td></td>
  </tr>
  <tr>
    <td align="center"> [Arriba] </td>
    <td align="center">Arriba</td>
    <td>Portada del documento</td>
    <td> &nbsp; </td>
  </tr>
  <tr>
    <td align="center"> [&Iacute;ndice general] </td>
    <td align="center">&Iacute;ndice general</td>
    <td>&Iacute;ndice general</td>
    <td> &nbsp; </td>
  </tr>
  <tr>
    <td align="center"> [&Iacute;ndice] </td>
    <td align="center">&Iacute;ndice</td>
    <td>&Iacute;ndice</td>
    <td> &nbsp; </td>
  </tr>
  <tr>
    <td align="center"> [ ? ] </td>
    <td align="center">Acerca de</td>
    <td>Acerca de (p&aacute;gina de ayuda)</td>
    <td> &nbsp; </td>
  </tr>
  <tr>
    <td align="center"> [] </td>
    <td align="center"></td>
    <td></td>
    <td></td>
  </tr>
  <tr>
    <td align="center"> [ &gt;&gt; ] </td>
    <td align="center">Avance r&aacute;pido</td>
    <td>Cap&iacute;tulo siguiente</td>
    <td>2</td>
  </tr>
  <tr>
    <td align="center"> [] </td>
    <td align="center"></td>
    <td></td>
    <td></td>
  </tr>
  <tr>
    <td align="center"> [] </td>
    <td align="center"></td>
    <td></td>
    <td></td>
  </tr>
  <tr>
    <td align="center"> [ &lt; ] </td>
    <td align="center">Atr&aacute;s</td>
    <td>Secci&oacute;n anterior en orden de lectura</td>
    <td>1.2.2</td>
  </tr>
  <tr>
    <td align="center"> [] </td>
    <td align="center"></td>
    <td></td>
    <td></td>
  </tr>
  <tr>
    <td align="center"> [ Subir ] </td>
    <td align="center">Subir</td>
    <td>Subir secci&oacute;n</td>
    <td>1.2</td>
  </tr>
  <tr>
    <td align="center"> [] </td>
    <td align="center"></td>
    <td></td>
    <td></td>
  </tr>
  <tr>
    <td align="center"> [ &gt; ] </td>
    <td align="center">Adelante</td>
    <td>Secci&oacute;n siguiente en orden de lectura</td>
    <td>1.2.4</td>
  </tr>
</table>

<p>
  donde el <strong> Ejemplo </strong> supone que la posiciÃ³n actual estÃ¡ en la <strong> Sub-subsecci&oacute;n uno-dos-tres </strong> de un documento de la estructura siguiente:
</p>

<ul>
  <li> 1. Secci&oacute;n Uno
    <ul>
      <li>1.1 Subsecci&oacute;n uno-uno
        <ul>
          <li>...</li>
        </ul>
      </li>
      <li>1.2 Subsecci&oacute;n uno-dos
        <ul>
          <li>1.2.1 Sub-subsecci&oacute;n uno-dos-uno</li>
          <li>1.2.2 Sub-subsecci&oacute;n uno-dos-dos</li>
          <li>1.2.3 Sub-subsecci&oacute;n uno-dos-tres &nbsp; &nbsp;
            <strong>&lt;== Posici&oacute;n actual </strong></li>
          <li>1.2.4 Sub-subsecci&oacute;n uno-dos-cuatro</li>
        </ul>
      </li>
      <li>1.3 Subsecci&oacute;n uno-tres
        <ul>
          <li>...</li>
        </ul>
      </li>
      <li>1.4 Subsecci&oacute;n uno-cuatro</li>
    </ul>
  </li>
</ul>

<hr size="1">
<!-- footer_tag -->
<div class="footer">
<!-- This footer was autogenerated by /home/gub/NewGub/gub/target/linux-x86/build/lilypond-git.sv.gnu.org--lilypond.git-release-unstable/scripts/build/out/www_post -->
<p class="footer_version">
Esta página corresponde a LilyPond-2.19.65 (rama de desarrollo).
</p>
<p class="footer_report">
Se agradecen las <a href="http://lilypond.org/help-us.html">sugerencias para la documentación</a>. Informe de los fallos a través de la lista en español <a href="http://lists.gnu.org/mailman/listinfo/lilypond-es">lilypond-es</a>, o en inglés a través de <a href="http://post.gmane.org/post.php?group=gmane.comp.gnu.lilypond.bugs">la lista oficial de fallos</a>.
</p>
</div>


<p id="languages">
<!-- These links were autogenerated by /home/gub/NewGub/gub/target/linux-x86/build/lilypond-git.sv.gnu.org--lilypond.git-release-unstable/scripts/build/out/www_post -->
 Otros idiomas: <a href="extending-big-page.html">English</a>, <a href="extending-big-page.de.html">deutsch</a>, <a href="extending-big-page.fr.html">français</a>.
 <br>
 Acerca de la <a href="http://www.lilypond.org/website/misc/browser-language">selección automática del idioma</a>.
</p>

<!-- FOOTER -->

<!-- end div#main here -->
</div>



<div id="tocframe">
<p class="toc_uplink"><a href="../Documentation/web/manuals.es.html"
         title="Documentation Index">&lt;&lt; Volver al índice de la documentación</a></p>
<h4 class="toc_header"> <a href="#index" title="Start of the manual">LilyPond &mdash; Extender  v2.19.65 (rama de desarrollo). </a></h4>
<div class="contents">
<ul class="toc">
  <li class=""><a name="toc-Tutorial-de-Scheme-1" href="extending-big-page.es.html#scheme-tutorial">A. Tutorial de Scheme</a>
  <ul class="toc">
    <li class=""><a name="toc-Introduccion-a-Scheme" href="extending-big-page.es.html#introduction-to-scheme">A.1 Introducción a Scheme</a>    </li>
    <li class=""><a name="toc-Scheme-dentro-de-LilyPond-1" href="extending-big-page.es.html#scheme-in-lilypond">A.2 Scheme dentro de LilyPond</a>    </li>
    <li class=""><a name="toc-Construir-funciones-complicadas-1" href="extending-big-page.es.html#building-complicated-functions">A.3 Construir funciones complicadas</a>    </li>
  </ul>
  </li>
  <li class=""><a name="toc-Interfaces-para-programadores-1" href="extending-big-page.es.html#interfaces-for-programmers">B. Interfaces para programadores</a>
  <ul class="toc">
    <li class=""><a name="toc-Bloques-de-codigo-de-LilyPond" href="extending-big-page.es.html#lilypond-code-blocks">B.1 Bloques de código de LilyPond</a>    </li>
    <li class=""><a name="toc-Funciones-de-Scheme-1" href="extending-big-page.es.html#scheme-functions">B.2 Funciones de Scheme</a>    </li>
    <li class=""><a name="toc-Funciones-musicales-1" href="extending-big-page.es.html#music-functions">B.3 Funciones musicales</a>    </li>
    <li class=""><a name="toc-Funciones-de-eventos-1" href="extending-big-page.es.html#event-functions">B.4 Funciones de eventos</a>    </li>
    <li class=""><a name="toc-Funciones-de-marcado-1" href="extending-big-page.es.html#markup-functions">B.5 Funciones de marcado</a>    </li>
    <li class=""><a name="toc-Contextos-para-programadores-1" href="extending-big-page.es.html#contexts-for-programmers">B.6 Contextos para programadores</a>    </li>
    <li class=""><a name="toc-Funciones-de-callback-1" href="extending-big-page.es.html#callback-functions">B.7 Funciones de callback</a>    </li>
    <li class=""><a name="toc-Trucos-dificiles" href="extending-big-page.es.html#difficult-tweaks">B.8 Trucos difíciles</a>    </li>
  </ul>
  </li>
  <li class=""><a name="toc-Interfaces-de-Scheme-de-LilyPond-1" href="extending-big-page.es.html#lilypond-scheme-interfaces">C. Interfaces de Scheme de LilyPond</a>  </li>
  <li class=""><a name="toc-GNU-Free-Documentation-License-1" href="extending-big-page.es.html#gnu-free-documentation-license">D. GNU Free Documentation License</a>  </li>
  <li class=""><a name="toc-Indice-de-LilyPond" href="extending-big-page.es.html#lilypond-index">E. Índice de LilyPond</a>  </li>
<li>
<!--
    Translation of GIT committish: 1df9fc42197a6b2931f448cfba717527aead5e5a

    When revising a translation, copy the HEAD committish of the
    version that you are working on.  See TRANSLATION for details.

we depend on an external entity here, which we cannot control.  Suppose
we go from 2.15.x to 2.17.x and put the documentation under "v2.17".
For some time, Google won't have the new location in its index, so the
search would get nothing.  It would be better to keep "v2.15" in the
search for a while and have a redirection from "v2.15" to "v2.17".
-->

<form action="http://google.com/search"
      method="get"
      name="search"
      onSubmit="search.q.value='site:lilypond.org/doc/v2.19 '
		+ search.brute_query.value"
      onMouseMove="search.q.value='site:lilypond.org/doc/v2.19 '
		   + search.brute_query.value"
      onKeyUp="search.q.value='site:lilypond.org/doc/v2.19 '
	       + search.brute_query.value">
  <input type="hidden" name="btnG" value="Búsqueda de Google">
  <input type="text" name="brute_query" onfocus="this.value=''" value="Buscar">
  <input type="hidden" name="q" value="">
</form>
</li>
</ul>
</div>
</div>

</body>
</html>
